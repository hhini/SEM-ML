{"title":"SEM + ML å®é™…é¡¹ç›®è®ºæ–‡å¤ç°","markdown":{"yaml":{"title":"SEM + ML å®é™…é¡¹ç›®è®ºæ–‡å¤ç°","authors":[{"name":"JAYZJAYZ","affiliation":"GAN NAN medical university","roles":"writing","corresponding":true}],"bibliography":"references.bib"},"headingText":"SEMåŠ MLåˆ†æ ğŸ«¥","containsRefs":false,"markdown":"\n\n\n------------------------------------------------------------------------\n\n***è¦å…·ä½“çŸ¥é“ä¸ºä»€ä¹ˆè¦ç»“åˆï¼Œå¯ä»¥å‚è€ƒæ–‡çŒ® [æ··åˆäººå·¥ç¥ç»ç½‘ç»œä¸ç»“æ„æ–¹ç¨‹æ¨¡å‹æŠ€æœ¯ï¼šç»¼è¿°](https://link.springer.com/article/10.1007/s40747-021-00503-w)Hybrid artificial neural network and structural equation modelling techniques: a survey***\n\n## ä¸ºä»€ä¹ˆè¦ç»“åˆæœºå™¨å­¦ä¹ ï¼ˆMLï¼‰ä¸ç»“æ„æ–¹ç¨‹æ¨¡å‹ï¼ˆSEMï¼‰\n\n### âœ¨ ç†è®ºä¸å®è·µçš„èåˆï¼šSEM + ML çš„ä¼˜åŠ¿\n\nç»“æ„æ–¹ç¨‹æ¨¡å‹ï¼ˆSEMï¼‰æ˜¯ä¸€ç§å¼ºå¤§çš„å› æœå»ºæ¨¡å·¥å…·ï¼Œèƒ½å¤ŸåŒæ—¶å¤„ç†æµ‹é‡æ¨¡å‹ï¼ˆæ½œå˜é‡ï¼‰å’Œè·¯å¾„æ¨¡å‹ï¼ˆå˜é‡é—´å…³ç³»ï¼‰ã€‚ä½†åœ¨å®é™…ç ”ç©¶ä¸­ï¼Œå°¤å…¶æ˜¯é¢å¯¹é«˜ç»´æ•°æ®(å°±æ˜¯å˜é‡å¤š)ã€å¤æ‚å˜é‡ç»“æ„æˆ–éçº¿æ€§å…³ç³»æ—¶ï¼ŒSEMä¹Ÿé¢ä¸´æŒ‘æˆ˜ï¼š\n\n-   **å˜é‡ç­›é€‰å›°éš¾**ï¼šä¼ ç»ŸSEMä¾èµ–ç†è®ºå‡è®¾ï¼Œå˜é‡é€‰æ‹©ä¸»è§‚æ€§å¼º(ä¸€èˆ¬è¦å‚è€ƒç¤¾ä¼šç§‘å­¦æ–‡çŒ®ï¼Œå¹¶ä¸”è¿›è¡Œå‡è®¾ï¼Œéº»äº†)ï¼›\n\n-   **æ¨¡å‹æ‹Ÿåˆå—é™**ï¼šå½“å˜é‡æ•°é‡å¤šã€å…³ç³»å¤æ‚æ—¶ï¼ŒSEMæ¨¡å‹å®¹æ˜“è¿‡æ‹Ÿåˆæˆ–æ‹Ÿåˆä¸ä½³(è¿‡æ‹Ÿåˆå’Œæ¬ æ‹Ÿåˆ)ï¼›\n\n-   **é¢„æµ‹èƒ½åŠ›æœ‰é™**ï¼šSEMæ›´åå‘è§£é‡Šæ€§è€Œéé¢„æµ‹æ€§ã€‚\n\nè€Œæœºå™¨å­¦ä¹ ï¼ˆMLï¼‰æ­£å¥½å¯ä»¥è¡¥è¶³è¿™äº›çŸ­æ¿ï¼š\n\n| åŠŸèƒ½       | SEM         | ML                |\n|------------|-------------|-------------------|\n| å› æœæ¨ç†   | âœ… å¼º       | âŒ å¼±ï¼ˆä½†å¯è¾…åŠ©ï¼‰ |\n| æ½œå˜é‡å»ºæ¨¡ | âœ… æ”¯æŒ     | âŒ ä¸ç›´æ¥æ”¯æŒ     |\n| ç‰¹å¾ç­›é€‰   | âŒ ä¾èµ–ç†è®º | âœ… æ•°æ®é©±åŠ¨       |\n| éçº¿æ€§å»ºæ¨¡ | âŒ æœ‰é™     | âœ… å¼ºå¤§           |\n| é¢„æµ‹èƒ½åŠ›   | âŒ å¼±       | âœ… å¼º             |\n\nå› æ­¤ï¼Œå°†MLä¸SEMç»“åˆï¼Œå¯ä»¥å®ç°ï¼š\n\n-   **æ•°æ®é©±åŠ¨çš„å˜é‡ç­›é€‰**ï¼ˆå¦‚ç”¨éšæœºæ£®æ—æˆ–SHAPå€¼æ‰¾å‡ºæœ€é‡è¦çš„é¢„æµ‹å› å­(ä¸€èˆ¬æ¥è¯´å¦‚æœå˜é‡è¾ƒå¤šçš„æ—¶å€™ï¼Œä¸€èˆ¬æ˜¯ä¸é™ç»´çš„ï¼Œè€Œæ˜¯ç­›é€‰å˜é‡çš„ï¼‰ï¼›\n\n-   **æå‡æ¨¡å‹è§£é‡ŠåŠ›ä¸é¢„æµ‹åŠ›**ï¼ˆå…ˆç”¨MLæ‰¾å‡º**å…³é”®å˜é‡**ï¼Œå†ç”¨SEMå»ºæ¨¡è·¯å¾„ï¼‰ï¼›\n\n-   **å¢å¼ºæ¨¡å‹ç¨³å¥æ€§**ï¼ˆMLå¯ç”¨äº**éªŒè¯**SEMæ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ï¼‰ï¼›\n\n-   **æé«˜ç ”ç©¶å½±å“åŠ›**ï¼ˆç»“åˆæ–¹æ³•æ›´å‰æ²¿ï¼Œæ˜“å‘è¡¨åœ¨é«˜å½±å“å› å­æœŸåˆŠï¼‰ã€‚\n\n### ğŸ“ˆ æ–‡çŒ®æ”¯æŒï¼šç»“åˆMLä¸SEMçš„ç ”ç©¶è¶Šæ¥è¶Šå¤šï¼Œå½±å“å› å­ä¹Ÿåœ¨ä¸Šå‡\n\nä»¥ä¸‹æ˜¯æä¾›çš„å‡ ç¯‡ä»£è¡¨æ€§æ–‡çŒ®ï¼Œå±•ç¤ºäº†ML+SEMçš„å®é™…åº”ç”¨ä¸å‘è¡¨æ½œåŠ›ï¼š\n\n1.  âœ… **å¤ç°çš„è®ºæ–‡**ï¼š PMC12236327\n\n    -   ç»“åˆéšæœºæ£®æ—ä¸SEMï¼Œè¯†åˆ«å½±å“ç²¾ç¥åˆ†è£‚ç—‡æ‚£è€…ä¸»è§‚å¹¸ç¦æ„Ÿçš„å…³é”®å› ç´ ã€‚\n\n    -   é€šè¿‡MLç­›é€‰å˜é‡ï¼Œå†ç”¨lavaanæ„å»ºè·¯å¾„æ¨¡å‹ï¼Œå®ç°å› æœè§£é‡Šä¸é¢„æµ‹å¹¶é‡ã€‚\n\n    -   å‘è¡¨åœ¨ã€ŠTranslational Psychiatryã€‹ï¼ŒIF â‰ˆ 7.9ã€‚\n\n2.  ğŸ“± **æ™ºèƒ½ç©¿æˆ´è®¾å¤‡é‡‡çº³ç ”ç©¶**ï¼š Bou Nassif et al. (2022)\n\n    -   ä½¿ç”¨PLS-SEMä¸MLå¯¹æ™ºèƒ½æ‰‹è¡¨é‡‡çº³æ„å›¾è¿›è¡Œå»ºæ¨¡ã€‚\n\n    -   MLæ­ç¤ºâ€œç”¨æˆ·æ»¡æ„åº¦â€æ˜¯æœ€å…³é”®é¢„æµ‹å› å­ï¼ŒSEMéªŒè¯å…¶è·¯å¾„å…³ç³»ã€‚\n\n    -   å‘è¡¨åœ¨ã€ŠHeliyonã€‹ï¼ŒIF â‰ˆ 4.0ã€‚\n\n3.  ğŸ§  **æ¶ˆè´¹è€…å¿ƒç†ä¸è¡Œä¸ºç ”ç©¶**ï¼š ScienceDirect 2023è®ºæ–‡\n\n    -   ç”¨MLç­›é€‰å½±å“æ¶ˆè´¹è€…ä¿¡ä»»çš„å˜é‡ï¼Œå†ç”¨SEMå»ºæ¨¡ä¿¡ä»»å½¢æˆæœºåˆ¶ã€‚\n\n    -   å‘è¡¨åœ¨ã€ŠJournal of Business Researchã€‹ï¼ŒIF â‰ˆ 10.0ã€‚\n\n4.  ğŸ§¬ **å¥åº·è¡Œä¸ºé¢„æµ‹ç ”ç©¶**ï¼š ScienceDirect 2024è®ºæ–‡\n\n    -   ç»“åˆMLä¸SEMé¢„æµ‹å¥åº·è¡Œä¸ºé‡‡çº³ï¼Œå¼ºè°ƒæ•°æ®é©±åŠ¨ä¸ç†è®ºå»ºæ¨¡çš„èåˆã€‚\n\n    -   å‘è¡¨åœ¨ã€ŠPreventive Medicine Reportsã€‹ï¼ŒIF â‰ˆ 3.5ã€‚\n\n------------------------------------------------------------------------\n\n## ä»€ä¹ˆæ˜¯æœºå™¨å­¦ä¹ ğŸ«¤\n\nåœ¨æ­£å¼è¿›å…¥æœºå™¨å­¦ä¹ ï¼ˆMachine Learning, MLï¼‰ï¼‹ç»“æ„æ–¹ç¨‹æ¨¡å‹ï¼ˆSEMï¼‰çš„æ•´åˆåº”ç”¨ä¹‹å‰ï¼Œé¦–å…ˆè¦è®©å¤§å®¶å¯¹â€œæœºå™¨å­¦ä¹ â€è¿™ä¸ªæ¦‚å¿µæœ‰ä¸€ä¸ªç›´è§‚çš„ç†è§£ã€‚ä¸å¿…è¿‡åˆ†çº ç»“å¤æ‚çš„æ•°å­¦å…¬å¼ï¼Œè€Œè¦æŠ“ä½å®ƒçš„æ ¸å¿ƒæ€æƒ³å’Œç ”ç©¶æµç¨‹ã€‚\n\n### 2.1 æœºå™¨å­¦ä¹ çš„å®šä¹‰ğŸ¤¤\n\næœºå™¨å­¦ä¹ æ˜¯ä¸€ç§***è®©è®¡ç®—æœºé€šè¿‡â€œæ ·æœ¬æ•°æ®â€è‡ªè¡Œå‘ç°è§„å¾‹***ï¼Œ***å¹¶å°†è¿™äº›è§„å¾‹ç”¨äºâ€œé¢„æµ‹â€æˆ–â€œå†³ç­–â€çš„æŠ€æœ¯ã€‚***\\\n- å®ƒä¸åƒä¼ ç»Ÿç»Ÿè®¡å­¦é‚£æ ·å¼ºè°ƒæ•´ä½“å‡è®¾æ£€éªŒå’Œå‚æ•°ä¼°è®¡ï¼Œæ›´æ³¨é‡â€œä»æ•°æ®ä¸­è‡ªåŠ¨å­¦ä¹ â€ã€‚\\\n- ML æ—¨åœ¨ç”¨å·²æœ‰æ•°æ®è®­ç»ƒä¸€ä¸ªæ¨¡å‹ï¼Œè®©æ¨¡å‹åœ¨æ–°æ•°æ®ä¸Šä¹Ÿèƒ½è¡¨ç°å‡ºè‰¯å¥½çš„é¢„æµ‹æˆ–åˆ†ç±»èƒ½åŠ›ã€‚\n\n***è¿™ä¹Ÿè®©æœºå™¨å­¦ä¹ æ— æ³•ç”¨æ•°å­¦å…¬å¼å’Œå› æœå…³ç³»æ¥çŸ¥é“ç”µè„‘æ˜¯æ€ä¹ˆæƒ³çš„ï¼Œå½¢æˆäº†æ‰€è°“çš„é»‘åŒ£å­ï¼Œè§£é‡Šæ€§å¤ªå·®ï¼Œä½†æ˜¯ç”¨æ¥é¢„æµ‹å°±æ²¡æ¯›ç—…***\n\n### 2.2 ML ä¸ä¼ ç»Ÿç»Ÿè®¡æ–¹æ³•çš„å·®å¼‚ğŸŒ®\n\n-   ç›®æ ‡ä¸åŒ\n    -   ç»Ÿè®¡å­¦ï¼šåé‡è§£é‡Šæ€§ï¼Œè§£æå˜é‡é—´çš„å› æœæˆ–å…³è”ï¼›\\\n    -   æœºå™¨å­¦ä¹ ï¼šåé‡é¢„æµ‹æ€§ï¼Œè¿½æ±‚æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ï¼Œå³ç»™æˆ‘æ•°æ®æˆ‘å¯ä»¥é¢„æµ‹å‡ºå¤§æ¦‚çš„ï¼Œç¬¦åˆä¹‹å‰æ•°æ®çš„ç­”æ¡ˆã€‚\n-   æ¨¡å‹å‡è®¾\n    -   ç»Ÿè®¡æ¨¡å‹ï¼šé€šå¸¸è¦æ±‚æ»¡è¶³æ­£æ€æ€§ã€çº¿æ€§å…³ç³»ç­‰ä¸¥æ ¼å‡è®¾ï¼›\\\n    -   ML æ¨¡å‹ï¼šå¯¹æ•°æ®åˆ†å¸ƒå’Œå…³ç³»çš„å‡è®¾æ›´å¼±ï¼Œ***å¯ä»¥å¤„ç†éçº¿æ€§ã€é«˜ç»´åº¦æ•°æ®***ã€‚\n-   å…³æ³¨ç‚¹\n    -   ç»Ÿè®¡æ–¹æ³•ï¼šä¼°è®¡å‚æ•°ã€æ˜¾è‘—æ€§æ£€éªŒã€ç½®ä¿¡åŒºé—´ï¼›\\\n    -   ML æ–¹æ³•ï¼š***æ¨¡å‹é€‰æ‹©ã€äº¤å‰éªŒè¯ã€è¿‡æ‹Ÿåˆæ§åˆ¶ã€é¢„æµ‹è¯¯å·®***ã€‚\n\n### 2.3 æœºå™¨å­¦ä¹ çš„ä¸»è¦ç±»å‹ğŸ¤–\n\n1.  **ç›‘ç£å­¦ä¹ ï¼ˆSupervised Learningï¼‰**\n    -   æœ‰â€œæ ‡ç­¾â€çš„æ•°æ®ï¼ˆä¾‹å¦‚ï¼šæ‚£è€…æœ‰/æ— å‹åŠ›æ€§æŸä¼¤ï¼‰ã€‚\\\n    -   å¸¸è§ç®—æ³•ï¼šé€»è¾‘å›å½’ã€å†³ç­–æ ‘ã€éšæœºæ£®æ—ã€æ”¯æŒå‘é‡æœºã€ç¥ç»ç½‘ç»œç­‰ã€‚\\\n    -   æ ¸å¿ƒä»»åŠ¡ï¼šåˆ†ç±»ï¼ˆClassificationï¼‰å’Œå›å½’ï¼ˆRegressionï¼‰ã€‚\n2.  **æ— ç›‘ç£å­¦ä¹ ï¼ˆUnsupervised Learningï¼‰**\n    -   æ— æ ‡ç­¾æ•°æ®ã€‚\\\n    -   å¸¸è§ç®—æ³•ï¼šèšç±»ï¼ˆK-meansã€å±‚æ¬¡èšç±»ï¼‰ã€é™ç»´ï¼ˆPCAã€t-SNEï¼‰ã€‚\\\n    -   æ ¸å¿ƒä»»åŠ¡ï¼šå‘ç°æ•°æ®çš„å†…åœ¨ç»“æ„ã€åˆ†ç¾¤ã€ç‰¹å¾é™ç»´ã€‚\n3.  **å¼ºåŒ–å­¦ä¹ ï¼ˆReinforcement Learningï¼‰**\n    -   é€šè¿‡â€œè¯•é”™â€ä¸ç¯å¢ƒäº’åŠ¨æ¥å­¦ä¹ æœ€ä¼˜ç­–ç•¥ã€‚\\\n    -   åœ¨æŠ¤ç†ç ”ç©¶ä¸­åº”ç”¨ç›¸å¯¹å°‘ï¼Œå¯ç”¨äºä¼˜åŒ–æŠ¤ç†è·¯å¾„æˆ–èµ„æºè°ƒåº¦ã€‚\n\n### 2.4 æœºå™¨å­¦ä¹ ç ”ç©¶æµç¨‹ğŸ›«\n\n1.  **æ•°æ®å‡†å¤‡ä¸æ¸…æ´—**\n    -   æ±‡æ€»ä¸´åºŠæŒ‡æ ‡ã€é—®å·é‡è¡¨ã€ç”µå­å¥åº·è®°å½•ç­‰ï¼›\\\n    -   å¤„ç†ç¼ºå¤±å€¼ã€å¼‚å¸¸å€¼ã€åˆ†ç±»å˜é‡ç¼–ç ã€‚\n2.  **ç‰¹å¾å·¥ç¨‹**\n    -   é€‰æ‹©æˆ–æ„é€ ä¸ç ”ç©¶ç›®æ ‡æœ€ç›¸å…³çš„å˜é‡ï¼ˆç‰¹å¾ï¼‰å³æŒ‘é€‰é‡è¦çš„ç‰¹å¾å˜é‡ï¼Œè¿‡æ»¤ä¸éœ€è¦çš„å˜é‡ï¼›\\\n    -   å½’ä¸€åŒ–ã€æ ‡å‡†åŒ–ã€one-hot ç¼–ç (ç‹¬çƒ­ç¼–ç )ç­‰ã€‚\n3.  **æ¨¡å‹è®­ç»ƒä¸ä¼˜åŒ–**\n    -   åœ¨â€œè®­ç»ƒé›†â€ä¸Šè®­ç»ƒæ¨¡å‹ï¼›\\\n    -   é€šè¿‡äº¤å‰éªŒè¯ï¼ˆCross-Validationï¼‰é€‰æ‹©è¶…å‚æ•°ï¼Œ**é˜²æ­¢è¿‡æ‹Ÿåˆ**(è¿‡æ‹Ÿåˆå³æ˜¯å¯¹æ¨¡å‹æ¥è¯´ï¼Œå­¦ä¹ å¤ªå¤šä¸é‡è¦çš„ç‰¹å¾ï¼Œæ¯”å¦‚æˆ‘è®­ç»ƒäº†ä¸€ä¸ªè¯†åˆ«å­¦é•¿è¿˜æ˜¯å­¦å§çš„æ¨¡å‹ï¼Œä½†æ˜¯æ¨¡å‹å­¦ä¹ åˆ°äº†å‡ ä¸ªå¥³è£…çš„å­¦é•¿ï¼Œæœ¬æ¥å¥³è£…è¿™æ˜¯å‡ ä¸ªäººçš„ç‰¹æ®Šç™–å¥½ï¼Œä½†æ˜¯æ¨¡å‹è®¤ä¸ºå¥³è£…çš„éƒ½æ˜¯å­¦é•¿ï¼Œè¿™æ‰¯ä¸æ‰¯ï¼‰ã€‚\n4.  **æ¨¡å‹è¯„ä¼°**\n    -   ***åœ¨â€œæµ‹è¯•é›†â€æˆ–â€œç•™å‡ºæ•°æ®â€ä¸Šè¯„ä¼°é¢„æµ‹æ€§èƒ½***ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæœºå™¨å­¦ä¹ éƒ½è¦åˆ†æˆè®­ç»ƒé›†å’ŒéªŒè¯é›†ï¼Œè¦ä¹ˆ7/3,è¦ä¹ˆ8/2ç­‰ç­‰ï¼ˆåƒä¸‡åˆ«è€å°èªæ˜ï¼Œè§‰å¾—æ•°æ®ä¸å¤Ÿå¤šï¼Œè¿˜è¦æ‹†åˆ†ï¼Œè€æ»‘å¤´æŠŠæ‰€æœ‰æ•°æ®éƒ½æ‹¿å»è®­ç»ƒï¼Œç„¶åå†æ‹¿å…¶ä¸­ä¸€éƒ¨åˆ†æ¥é¢„æµ‹ï¼Œå› ä¸ºæ¨¡å‹æœ‰è®°å¿†çš„ï¼Œä½ é¢„æµ‹è®­ç»ƒè¿‡çš„æ•°æ®ï¼Œè‚¯å®šå‡†ç¡®ç‡æ˜¯ç™¾åˆ†ç™¾ï¼Œå°±å¥½åƒä½ æ˜æ˜çŸ¥é“æ˜å¤©çš„å¤©æ°”ï¼Œé‚£ä¸ºä»€ä¹ˆè¦æ ¹æ®ä¹‹å‰çš„æ•°æ®æ¨æµ‹å‘¢ï¼‰ï¼ˆå¦‚ AUCã€å‡†ç¡®ç‡ã€RMSEï¼‰ï¼›\\\n    -   æ¯”è¾ƒä¸åŒç®—æ³•çš„ä¼˜åŠ£ã€‚\n5.  **æ¨¡å‹è§£é‡Šä¸åº”ç”¨**\n    -   ä½¿ç”¨ SHAPã€LIME ç­‰æ–¹æ³•**è§£é‡Šæ¨¡å‹**\n\n        å®ƒä»¬æ˜¯ä¸¤ç§å¸¸ç”¨çš„â€œæ¨¡å‹è§£é‡Šå·¥å…·â€ï¼Œå¯ä»¥å‘Šè¯‰æˆ‘ä»¬ï¼š**å“ªäº›å˜é‡å¯¹æ¨¡å‹é¢„æµ‹æœ€é‡è¦ï¼Œä»¥åŠå®ƒä»¬çš„å½±å“æ–¹å‘**\n\n------------------------------------------------------------------------\n\n# å¤ç°ä¸€ç¯‡è®ºæ–‡ğŸ¤–\n\n**`æœ€å¥½å­¦ä¹ çš„æ–¹æ³•å°±æ˜¯çœ‹ç›¸å…³è®ºæ–‡ï¼Œç„¶åå­¦ä¹ è®ºæ–‡çŸ¥è¯†ï¼Œç„¶åå¤ç°å­¦ä¹ ï¼Œæ‰€ä»¥å•¥ä¹Ÿä¸è¯´äº†ï¼Œç›´æ¥çœŸåˆ€çœŸæªå¼€å¹²å°±å®Œäº†`**\n\n#### Replicating Research on Subjective Well-Being in Schizophrenia: A Guide to Generating Synthetic Data for SEM and Machine Learning ç²¾ç¥åˆ†è£‚ç—‡æ‚£è€…ä¸»è§‚å¹¸ç¦æ„Ÿç ”ç©¶ï¼šSEM å’Œæœºå™¨å­¦ä¹ åˆæˆæ•°æ®ç”ŸæˆæŒ‡å—\n\n#### [è®ºæ–‡é“¾æ¥](https://pmc.ncbi.nlm.nih.gov/articles/PMC12236327/#s5) 2024 Sep 7 ; 51(4):1118â€“1133. doi: 10.1093/schbul/sbae156 - IF=7.9(æˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆè¿™ç§æ–‡ç« æœ‰7åˆ†ï¼Œåšç”Ÿä¿¡ç´¯æ­»ç´¯æ´»è¿˜æ‹¿ä¸åˆ°5åˆ†ï¼Œåæ§½ä¸€ä¸‹ï¼Œéº»äº†ğŸ¥¶ï¼‰\n\n***ï¼ç°åœ¨æˆ‘ä¸ä»¥ç¤¾ä¼šç§‘å­¦çš„è§’åº¦è§£æè¿™ç¯‡æ–‡ç« ï¼Œåªç”¨ç»Ÿè®¡å­¦å’Œä»£ç æ¥è§£æå¦‚ä½•å¤„ç†***\n\nå› ä¸ºæˆ‘ç°åœ¨æ²¡æœ‰ç›¸å…³çš„æ•°æ®ï¼Œæ‰€ä»¥æˆ‘åªèƒ½ç”¨ä»£ç æ¨¡æ‹Ÿå’Œæ–‡ç« å·®ä¸å¤šçš„æ•°æ®\n\n-   **è¡¨ 1ï¼šæœºå™¨å­¦ä¹ æ¨¡å‹ä¸­åŒ…å«çš„ç‹¬ç«‹å˜é‡åˆ—è¡¨ï¼š** è¯¥è¡¨æ¦‚è¿°äº†åˆ†æä¸­ä½¿ç”¨çš„æ‰€æœ‰å˜é‡ï¼ŒåŒ…æ‹¬ç¤¾ä¼šäººå£å› ç´ ï¼ˆå¹´é¾„ã€æ€§åˆ«ã€æ•™è‚²ã€èŒä¸šï¼‰ã€ç–¾ç—…ç›¸å…³å› ç´ ï¼ˆç–¾ç—…æŒç»­æ—¶é—´ï¼‰å’Œå„ç§ä¸´åºŠæµ‹é‡ã€‚\n\n-   **è¡¨ 2ï¼šæ ·æœ¬ç‰¹å¾ï¼š**æä¾›äº† 637 åæ‚£è€…åŸå§‹æ•°æ®é›†ä¸­å˜é‡çš„æè¿°æ€§ç»Ÿè®¡æ•°æ®ã€‚å®ƒåŒ…æ‹¬è¿ç»­å˜é‡çš„å¹³å‡å€¼ã€æ ‡å‡†å·®å’ŒèŒƒå›´ï¼Œä»¥åŠåˆ†ç±»å˜é‡çš„é¢‘ç‡ã€‚\n\n-   **å›¾ 3ï¼šç½‘ç»œæ¨¡å‹å’Œä¸­å¿ƒæ€§æŒ‡æ ‡ï¼š**å±•ç¤ºäº†ä¸åŒå˜é‡ä¹‹é—´çš„ç›¸å…³æ€§ã€‚è¿æ¥åŠå…¶ç²—ç»†è¡¨ç¤ºå…³ç³»çš„å¼ºåº¦ï¼Œè¿™åº”è¯¥åæ˜ åœ¨åˆæˆæ•°æ®çš„ç›¸å…³çŸ©é˜µä¸­ã€‚\n\n-   **å›¾ 4ï¼šç»“æ„æ–¹ç¨‹æ¨¡å‹ï¼ˆSEMï¼‰åˆ†æï¼š** è¯¥å›¾æ¯”ç½‘ç»œåˆ†ææ›´è¿›ä¸€æ­¥ï¼Œæ­ç¤ºäº†å˜é‡ä¹‹é—´çš„å› æœè·¯å¾„å’Œæ•ˆåº”æ–¹å‘ã€‚è·¯å¾„ç³»æ•°é‡åŒ–äº†è¿™äº›å…³ç³»çš„å¼ºåº¦å’Œæ–¹å‘ã€‚\n\n#### ä½¿ç”¨ Python ç”Ÿæˆåˆæˆæ•°æ®\n\nä»¥ä¸‹ Python ä»£ç æ¼”ç¤ºäº†å¦‚ä½•ç”Ÿæˆä¸€ä¸ªä¸è®ºæ–‡ä¸­æè¿°çš„ç‰¹å¾è¿‘ä¼¼çš„åˆæˆæ•°æ®é›†ã€‚æ­¤ä»£ç ä½¿ç”¨ numpy å’Œ pandas åº“åˆ›å»ºä¸€ä¸ªæ•°æ®æ¡†ï¼Œå…¶ä¸­åŒ…å«ä¸åŸå§‹ç ”ç©¶ä¸­çš„å˜é‡å…·æœ‰ç›¸ä¼¼ç»Ÿè®¡ç‰¹æ€§å’Œç›¸å…³æ€§çš„å˜é‡ã€‚å˜é‡ä¸ç”¨Chinese\n\n```{python}\n#| echo: true\n# å¯¼å…¥æ‰€éœ€çš„åº“\n# å¯¼å…¥æ‰€éœ€çš„åº“\nimport numpy as np\nimport pandas as pd\nfrom scipy.stats import truncnorm\n\n# --- 1. å®šä¹‰æ ·æœ¬é‡ ---\nn_patients = 637\n\n# --- 2. åŸºäºSEMå’Œç½‘ç»œåˆ†æç”Ÿæˆæ ¸å¿ƒç›¸å…³æ•°æ® ---\ncorrelation_matrix = np.array([\n    # SWB,   OCS,   Som,   Cog,   Dep,   Neg,   Pos,   PSP\n    [1.00, -0.59, -0.40, -0.20, -0.35, -0.25, -0.15,  0.30],\n    [-0.59,  1.00,  0.70,  0.30,  0.40,  0.20,  0.18, -0.25],\n    [-0.40,  0.70,  1.00,  0.25,  0.35,  0.15,  0.10, -0.20],\n    [-0.20,  0.30,  0.25,  1.00,  0.26,  0.48,  0.36, -0.40],\n    [-0.35,  0.40,  0.35,  0.26,  1.00,  0.35,  0.24, -0.50],\n    [-0.25,  0.20,  0.15,  0.48,  0.35,  1.00,  0.22, -0.60],\n    [-0.15,  0.18,  0.10,  0.36,  0.24,  0.22,  1.00, -0.30],\n    [ 0.30, -0.25, -0.20, -0.40, -0.50, -0.60, -0.30,  1.00]\n])\n\nmean = np.zeros(correlation_matrix.shape[0])\nnp.random.seed(42)\ncorrelated_data = np.random.multivariate_normal(mean, correlation_matrix, size=n_patients)\n\n# --- 3. ç¼©æ”¾å’Œè½¬æ¢æ•°æ®ä»¥åŒ¹é…è®ºæ–‡è¡¨2ä¸­çš„ç»Ÿè®¡ç‰¹å¾ ---\n\ndef scale_variable(data_column, mean, std, min_val, max_val):\n    scaled = data_column * std + mean\n    return np.clip(scaled, min_val, max_val)\n\ncgi_pos = scale_variable(correlated_data[:, 6], 3.7, 1.4, 1, 7)\ncgi_neg = scale_variable(correlated_data[:, 5], 3.3, 1.2, 1, 7)\ncgi_dep = scale_variable(correlated_data[:, 4], 2.6, 1.2, 1, 6)\ncgi_cog = scale_variable(correlated_data[:, 3], 3.1, 1.1, 1, 6)\nscl_som = scale_variable(correlated_data[:, 2], 21.3, 8.7, 12, 58)\nscl_ocs = scale_variable(correlated_data[:, 1], 22.4, 8.3, 10, 50)\nswn_total = scale_variable(correlated_data[:, 0], 73.5, 17.6, 24, 120)\npsp_total = scale_variable(correlated_data[:, 7], 55.9, 14.8, 10, 90)\ndiepss_severity = np.random.uniform(0, 4, n_patients)\ndiepss_severity = np.clip(diepss_severity, 0, 4)\ndiepss_severity_mean = np.mean(diepss_severity)\ndiepss_severity = (diepss_severity - diepss_severity_mean) * (0.8 / np.std(diepss_severity)) + 0.6\ndiepss_severity = np.clip(diepss_severity, 0, 4)\n\n# --- 4. ç”Ÿæˆç¤¾ä¼šäººå£ç»Ÿè®¡å­¦åŠå…¶ä»–å˜é‡ ---\n\nage_mean, age_std, age_min, age_max = 35.7, 10.5, 18, 64\nage = truncnorm.rvs((age_min - age_mean) / age_std, (age_max - age_mean) / age_std, loc=age_mean, scale=age_std, size=n_patients)\nsex = np.random.choice([1, 0], size=n_patients, p=[0.529, 0.471])\neducation = np.random.choice(['Less than 12 years', 'High school', 'College or graduate'], size=n_patients, p=[0.171, 0.413, 0.416])\noccupation = np.random.choice([1, 0], size=n_patients, p=[0.174, 0.826])\nillness_duration_mean, illness_duration_std, illness_duration_min, illness_duration_max = 9.1, 8.1, 0, 44\nillness_duration = truncnorm.rvs((illness_duration_min - illness_duration_mean) / illness_duration_std, (illness_duration_max - illness_duration_mean) / illness_duration_std, loc=illness_duration_mean, scale=illness_duration_std, size=n_patients)\nobesity = np.random.choice([1, 0], size=n_patients, p=[0.468, 0.532])\nhypertension = np.random.choice([1, 0], size=n_patients, p=[0.273, 0.727])\ndiabetes = np.random.choice([1, 0], size=n_patients, p=[0.154, 0.846])\n\n# --- 5. ç»„åˆæˆ Pandas DataFrame ---\nsynthetic_df = pd.DataFrame({\n    'Age': age.round(1),\n    'Sex_Female': sex,\n    'Education': education,\n    'Occupation_Employed': occupation,\n    'Duration_of_Illness': illness_duration.round(1),\n    'Obesity': obesity,\n    'Hypertension': hypertension,\n    'Diabetes': diabetes,\n    'CGI_Positive': cgi_pos.round(1),\n    'CGI_Negative': cgi_neg.round(1),\n    'CGI_Depressive': cgi_dep.round(1),\n    'CGI_Cognitive': cgi_cog.round(1),\n    'SCL90R_Somatization': scl_som.round(1),\n    'SCL90R_OCS': scl_ocs.round(1),\n    'SWN_Total_Score': swn_total.round(1),\n    'DIEPSS_Overall_Severity': diepss_severity.round(1),\n    'PSP_Total_Score': psp_total.round(1)\n})\n\n# --- 6. å°†æ•°æ®æ¡† (DataFrame) ä¿å­˜ä¸º CSV æ–‡ä»¶ ---\n# !!! é‡è¦æç¤º: è¯·å°†ä¸‹é¢çš„è·¯å¾„ä¿®æ”¹ä¸ºæ‚¨å¸Œæœ›ä¿å­˜æ–‡ä»¶çš„å®é™…ä½ç½® !!!\n# ä¾‹å¦‚ Windows: \"C:/Users/ç”¨æˆ·å/Documents/synthetic_data.csv\"\n# ä¾‹å¦‚ macOS: \"/Users/ç”¨æˆ·å/Documents/synthetic_data.csv\"\nfile_path = \"./synthetic_schizophrenia_data.csv\"\n\n# ä½¿ç”¨ to_csv() å‡½æ•°æ¥ä¿å­˜æ•°æ®\n# å‚æ•° index=False çš„æ„æ€æ˜¯ï¼Œæ•°æ®æ¡†çš„è¡Œç´¢å¼• (0, 1, 2, ...) ä¸ä¼šè¢«å†™å…¥åˆ° CSV æ–‡ä»¶ä¸­\nsynthetic_df.to_csv(file_path, index=False)\n\nprint(synthetic_df.head(10))\n\n```\n\n### ğŸ§® æ•°æ®ç»´åº¦\n\n-   **æ ·æœ¬æ•°ï¼ˆè¡Œæ•°ï¼‰**ï¼š`637` ç”± `n_patients = 637` æŒ‡å®šï¼Œæ¨¡æ‹Ÿçš„æ˜¯637ä½ç²¾ç¥åˆ†è£‚ç—‡æ‚£è€…çš„ä¸´åºŠä¸äººå£å­¦æ•°æ®ã€‚\n\n-   **å˜é‡æ•°ï¼ˆåˆ—æ•°ï¼‰**ï¼š`17` åŒ…æ‹¬ä¸´åºŠç—‡çŠ¶ã€äººå£å­¦ç‰¹å¾ã€åŠŸèƒ½çŠ¶æ€å’Œä»£è°¢æŒ‡æ ‡ç­‰å˜é‡ã€‚\n\n### ğŸ“Š å˜é‡åˆ—è¡¨ä¸ç±»å‹\n\n| å˜é‡å                    | ç±»å‹     | æè¿°                        |\n|---------------------------|----------|-----------------------------|\n| `Age`                     | è¿ç»­å˜é‡ | å¹´é¾„ï¼ˆ18â€“64å²ï¼‰             |\n| `Sex_Female`              | äºŒå…ƒå˜é‡ | æ€§åˆ«ï¼ˆ1=å¥³æ€§ï¼Œ0=ç”·æ€§ï¼‰      |\n| `Education`               | åˆ†ç±»å˜é‡ | æ•™è‚²æ°´å¹³ï¼ˆ3ç±»ï¼‰             |\n| `Occupation_Employed`     | äºŒå…ƒå˜é‡ | æ˜¯å¦å°±ä¸šï¼ˆ1=åœ¨èŒï¼‰          |\n| `Duration_of_Illness`     | è¿ç»­å˜é‡ | ç—…ç¨‹ï¼ˆ0â€“44å¹´ï¼‰              |\n| `Obesity`                 | äºŒå…ƒå˜é‡ | æ˜¯å¦è‚¥èƒ–                    |\n| `Hypertension`            | äºŒå…ƒå˜é‡ | æ˜¯å¦é«˜è¡€å‹                  |\n| `Diabetes`                | äºŒå…ƒå˜é‡ | æ˜¯å¦ç³–å°¿ç—…                  |\n| `CGI_Positive`            | è¿ç»­å˜é‡ | é˜³æ€§ç—‡çŠ¶è¯„åˆ†ï¼ˆ1â€“7ï¼‰         |\n| `CGI_Negative`            | è¿ç»­å˜é‡ | é˜´æ€§ç—‡çŠ¶è¯„åˆ†ï¼ˆ1â€“7ï¼‰         |\n| `CGI_Depressive`          | è¿ç»­å˜é‡ | æŠ‘éƒç—‡çŠ¶è¯„åˆ†ï¼ˆ1â€“6ï¼‰         |\n| `CGI_Cognitive`           | è¿ç»­å˜é‡ | è®¤çŸ¥ç¼ºé™·è¯„åˆ†ï¼ˆ1â€“6ï¼‰         |\n| `SCL90R_Somatization`     | è¿ç»­å˜é‡ | èº¯ä½“åŒ–è¯„åˆ†ï¼ˆ12â€“58ï¼‰         |\n| `SCL90R_OCS`              | è¿ç»­å˜é‡ | å¼ºè¿«ç—‡çŠ¶è¯„åˆ†ï¼ˆ10â€“50ï¼‰       |\n| `SWN_Total_Score`         | è¿ç»­å˜é‡ | ä¸»è§‚å¹¸ç¦æ„Ÿè¯„åˆ†ï¼ˆ24â€“120ï¼‰    |\n| `DIEPSS_Overall_Severity` | è¿ç»­å˜é‡ | é”¥ä½“å¤–ç³»ä¸è‰¯ååº”è¯„åˆ†ï¼ˆ0â€“4ï¼‰ |\n| `PSP_Total_Score`         | è¿ç»­å˜é‡ | ç¤¾ä¼šåŠŸèƒ½è¯„åˆ†ï¼ˆ10â€“90ï¼‰       |\n\n### ğŸ“Š å˜é‡æ¢ç´¢(æœºå™¨å­¦ä¹ è¿›è¡Œå˜é‡çš„æ¢ç´¢ï¼Œå³ç‰¹å¾å·¥ç¨‹)\n\n------------------------------------------------------------------------\n\n**è®ºæ–‡çš„é¦–è¦åˆ†ææ­¥éª¤æ˜¯åˆ©ç”¨æœºå™¨å­¦ä¹  (ML) æ¥è¯†åˆ«å†³å®šé«˜æ°´å¹³ä¸»è§‚å¹¸ç¦æ„Ÿ (SWB) çš„æœ€é‡è¦å› ç´ ã€‚è®ºæ–‡ä½œè€…è®­ç»ƒäº†å¤šä¸ªæ¨¡å‹ï¼Œå‘ç°éšæœºæ£®æ— (RF) æ¨¡å‹è¡¨ç°æœ€ä½³**\n\n1.  å‡†å¤‡æœºå™¨å­¦ä¹ çš„æ•°æ® ã€‚\n\n2.  è®­ç»ƒéšæœºæ£®æ—æ¨¡å‹æ¥é¢„æµ‹å“ªäº›æ‚£è€…å…·æœ‰â€œé«˜æ°´å¹³çš„ SWBâ€ã€‚\n\n3.  ä½¿ç”¨ AUC æŒ‡æ ‡è¯„ä¼°æ¨¡å‹çš„æ€§èƒ½ ï¼Œå°±åƒè®ºæ–‡ä¸­æ‰€åšçš„é‚£æ ·ã€‚\n\n4.  ä½¿ç”¨ SHAP å€¼åˆ†æ**ç‰¹å¾é‡è¦æ€§**ï¼Œ ä»¥äº†è§£å“ªäº›å˜é‡æ˜¯æœ€å¼ºå¤§çš„é¢„æµ‹å› å­ï¼Œé‡ç°è®ºæ–‡ä¸­å›¾ 1B ä¸­çš„å‘ç°ã€‚\n\n#### ç¬¬ä¸€æ­¥å¯¼å…¥éœ€è¦çš„åŒ…ğŸ§‰\n\n-   åŒ…æ˜¯å¯ä»¥è®¤ä¸ºæ˜¯æ¸¸æˆçš„mod,éƒ½æ˜¯å¤§ä½¬æ”¶é›†çš„ç®—æ³•æˆ–è€…å…¶ä»–çš„ä»£ç æ¥å®ç°ä½ éœ€è¦çš„åŠŸèƒ½ï¼Œè¿™äº›éƒ½æ˜¯åœ°åŸº\n\n```{python}\n#| echo: true\n# å¯¼å…¥æ‰€éœ€çš„åº“\nimport pandas as pd                 # å¯¼å…¥ pandas ç”¨äºè¯»å–å’Œå¤„ç†æ•°æ®\nimport numpy as np                  # å¯¼å…¥ numpy ç”¨äºæ•°å€¼è®¡ç®—\nfrom sklearn.model_selection import train_test_split # å¯¼å…¥ train_test_split ç”¨äºåˆ’åˆ†è®­ç»ƒé›†å’Œæµ‹è¯•é›†\nfrom sklearn.ensemble import RandomForestClassifier  # å¯¼å…¥éšæœºæ£®æ—åˆ†ç±»å™¨\nfrom sklearn.metrics import roc_auc_score, roc_curve # å¯¼å…¥è¯„ä¼°æŒ‡æ ‡è®¡ç®—å‡½æ•°\nimport matplotlib.pyplot as plt     # å¯¼å…¥ matplotlib ç”¨äºç»˜å›¾\nimport shap                         # å¯¼å…¥ SHAP åº“ç”¨äºæ¨¡å‹è§£é‡Š\n```\n\n#### ç¬¬äºŒæ­¥å¯¼å…¥æ•°æ®ğŸ¤¤\n\nå°±æ˜¯æˆ‘ä»¬è¦çš„æ•°æ®ï¼Œå³è°ƒæŸ¥çš„æ•°æ®ï¼Œä¸€èˆ¬æ˜¯XLSX(excelè¡¨æ ¼)ï¼Œcsv(æ•°æ®æ ¼å¼ä¸‡é‡‘æ²¹)ï¼Œæˆ–è€…å…¶ä»–æ ¼å¼\n\n```{python}\n#| echo: true\n\n# --- 1. åŠ è½½å¹¶å‡†å¤‡æ•°æ® ---\n# Load and Prepare the Data\n\n# !!! é‡è¦æç¤º: è¯·å°†ä¸‹é¢çš„è·¯å¾„ä¿®æ”¹ä¸ºæ‚¨ä¿å­˜ CSV æ–‡ä»¶çš„å®é™…ä½ç½® !!!\n# For example: \"C:/Users/YourUsername/Documents/synthetic_schizophrenia_data.csv\"\nfile_path = \"./synthetic_schizophrenia_data.csv\"\n\n# è¯»å–æˆ‘ä»¬ä¹‹å‰ç”Ÿæˆçš„åˆæˆæ•°æ®\ndf = pd.read_csv(file_path)\n```\n\n#### ç¬¬ä¸‰æ­¥ å®šä¹‰ç›®æ ‡å˜é‡å’Œç‰¹å¾å˜é‡ğŸ¥¶\n\næˆ‘ä»¬å¿…é¡»è¦çŸ¥é“what the fuck is our ç›®æ ‡å˜é‡ï¼Œå³æˆ‘ä»¬è¦ç ”ç©¶çš„ç›®æ ‡ï¼Œè¿™ç¯‡æ–‡ç« ç ”ç©¶çš„æ˜¯ **é«˜æ°´å¹³ä¸»è§‚å¹¸ç¦æ„Ÿ (SWB)**ï¼Œä»–ä»¬æƒ³è¦çŸ¥é“ä»€ä¹ˆå› ç´ å½±å“è¿™ä¸ªé¬¼ä¸œè¥¿ï¼Œè€Œè¿™äº›å› ç´ ï¼Œæ¯”å¦‚å¹´é¾„ï¼Œèº«é«˜ï¼Œä½“é‡å°±æ˜¯ç‰¹å¾å˜é‡\n\n-   **å®šä¹‰ç›®æ ‡**ï¼š æœ¬æ–‡æœºå™¨å­¦ä¹ æ¨¡å‹çš„ä¸»è¦ç›®æ ‡å¹¶éé¢„æµ‹å‡†ç¡®çš„ä¸»è§‚å¹¸ç¦æ„Ÿ (SWB) è¯„åˆ†ï¼Œè€Œæ˜¯å°†æ‚£è€…åˆ†ä¸ºä¸¤ç»„ï¼šå…·æœ‰â€œé«˜æ°´å¹³ SWBâ€çš„æ‚£è€…å’Œä¸å…·æœ‰â€œé«˜æ°´å¹³ SWBâ€çš„æ‚£è€…ã€‚æˆ‘ä»¬éµå¾ªæœ¬æ–‡çš„æ€è·¯ï¼Œåˆ›å»ºäº†ä¸€ä¸ªäºŒå…ƒç›®æ ‡å˜é‡ ( High_SWB )ï¼Œå…¶ä¸­ 80 åˆ†åŠä»¥ä¸Šè¢«è§†ä¸ºâ€œé«˜â€ï¼ˆç¼–ç ä¸º 1ï¼‰ï¼Œä½äº 80 åˆ†åˆ™è¢«è§†ä¸ºâ€œä½â€ï¼ˆç¼–ç ä¸º 0ï¼‰ã€‚\n\n```{python}\n#| echo: true\n\n# å®šä¹‰ç›®æ ‡å˜é‡ (Y)\n# æ ¹æ®è®ºæ–‡ï¼Œ\"é«˜æ°´å¹³SWB\" å®šä¹‰ä¸º SWN æ€»åˆ†è¾¾åˆ°æˆ–è¶…è¿‡ 80\n# æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªåä¸º 'High_SWB' çš„æ–°åˆ—ï¼Œ1 è¡¨ç¤ºé«˜SWBï¼Œ0 è¡¨ç¤ºéé«˜SWB\ndf['High_SWB'] = (df['SWN_Total_Score'] >= 80).astype(int)\n\n# å®šä¹‰ç‰¹å¾å˜é‡ (X)\n# X æ˜¯é™¤äº†ç›®æ ‡å˜é‡å’ŒåŸå§‹SWNåˆ†æ•°ä¹‹å¤–çš„æ‰€æœ‰åˆ—\n# We drop the original score and the target variable to create our feature set\nX = df.drop(['SWN_Total_Score', 'High_SWB'], axis=1)\ny = df['High_SWB']\n```\n\n#### ç‰¹å¾å·¥ç¨‹\n\nç‰¹å¾å·¥ç¨‹æ˜¯æŒ‡ä»åŸå§‹æ•°æ®ä¸­æå–æœ‰ç”¨çš„ç‰¹å¾ï¼Œä»¥ä¾¿äºæœºå™¨å­¦ä¹ æ¨¡å‹çš„è®­ç»ƒå’Œé¢„æµ‹ã€‚\n\nç‰¹å¾å·¥ç¨‹åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š\n\n1.  ç‰¹å¾é€‰æ‹©ï¼šé€‰æ‹©æœ€ç›¸å…³çš„ç‰¹å¾ï¼Œä»¥å‡å°‘æ¨¡å‹çš„å¤æ‚åº¦ï¼Œæé«˜æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ã€‚å³æœ‰çš„æ—¶å€™ç‰¹å¾å¤ªå¤šï¼Œä¸”å…¶ä¸­æœ‰æ— æ„ä¹‰æˆ–è€…ä¸é‡è¦çš„ç‰¹å¾ï¼Œè¿™æ—¶å€™å°±éœ€è¦é€‰æ‹©æœ€ç›¸å…³çš„ç‰¹å¾ï¼Œä»¥å‡å°‘æ¨¡å‹çš„å¤æ‚åº¦ï¼Œæé«˜æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ã€‚\n2.  ç‰¹å¾æå–ï¼šä»åŸå§‹æ•°æ®ä¸­æå–æœ‰ç”¨çš„ç‰¹å¾ï¼Œä»¥ä¾¿äºæœºå™¨å­¦ä¹ æ¨¡å‹çš„è®­ç»ƒå’Œé¢„æµ‹ã€‚\n3.  ç‰¹å¾å˜æ¢ï¼šå¯¹ç‰¹å¾è¿›è¡Œå˜æ¢ï¼Œä»¥ä¾¿äºæœºå™¨å­¦ä¹ æ¨¡å‹çš„è®­ç»ƒå’Œé¢„æµ‹ã€‚æ¯”å¦‚æ ‡å‡†åŒ–ï¼Œå½’ä¸€åŒ–ï¼Œç‹¬çƒ­ç¼–ç ï¼Œç­‰ç­‰ã€‚ å¯¹äºä¸€äº›å…¶ä»–æ•°æ®ç±»å‹ï¼Œæ¯”å¦‚å­—ç¬¦å‹ï¼Œå¦‚æ˜¯å¦ä¸ºç”·æˆ–è€…å¥³æ€§ï¼Œä¸€èˆ¬å¯ä»¥ç”¨1ä»£è¡¨ç”·ï¼Œ0ä»£è¡¨å¥³ï¼Œå› ä¸ºæ¨¡å‹ä¸€èˆ¬æ— æ³•äº†è§£å­—çš„çœŸå®å«ä¹‰ï¼Œä½†æ˜¯æ•°å­—å¯ä»¥ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œå¯¹äºç‰¹å¾å·¥ç¨‹è¿™ä¸ªæ­¥éª¤éœ€è¦èŠ±è´¹å¾ˆå¤šæ—¶é—´ã€‚æˆ‘ä»¬è¿™ä¸ªä¾‹å­çš„æ•°æ®æ¯”è¾ƒç¬¦åˆæœºå™¨å­¦ä¹ çš„ç±»å‹ï¼Œä¸éœ€è¦å¤ªå¤šæ›´æ”¹\n\nç‹¬çƒ­ç¼–ç æ˜¯å°†åˆ†ç±»å˜é‡è½¬æ¢ä¸ºäºŒè¿›åˆ¶å˜é‡ï¼Œå³å°†æ¯ä¸ªåˆ†ç±»å˜é‡è½¬æ¢ä¸ºå¤šä¸ªäºŒè¿›åˆ¶å˜é‡ï¼Œæ¯ä¸ªäºŒè¿›åˆ¶å˜é‡è¡¨ç¤ºä¸€ä¸ªåˆ†ç±»ã€‚æ¯”å¦‚è¿™ä¸ªä¾‹å­æ•™è‚²æ˜¯åˆ†ä¸ºä¸‰ç±»ï¼Œä¸”éƒ½ä¸ºå­—ç¬¦å‹ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæ•™è‚²åˆ†ä¸ºä¸‰ä¸ªäºŒè¿›åˆ¶ï¼ˆ0/1ï¼‰å˜é‡ï¼Œæ¯ä¸ªäºŒè¿›åˆ¶å˜é‡è¡¨ç¤ºä¸€ä¸ªåˆ†ç±»ã€‚\n\n```{python}\n#| echo: true\n\n# å¤„ç†åˆ†ç±»å˜é‡\n# 'Education' åˆ—æ˜¯æ–‡æœ¬ç±»å‹ï¼Œæœºå™¨å­¦ä¹ æ¨¡å‹éœ€è¦æ•°å€¼è¾“å…¥ã€‚\n# æˆ‘ä»¬ä½¿ç”¨ \"ç‹¬çƒ­ç¼–ç \" (One-Hot Encoding) å°†å…¶è½¬æ¢ä¸ºæ•°å€¼åˆ—ã€‚\n# This converts the 'Education' column into multiple binary (0/1) columns.\nX = pd.get_dummies(X, columns=['Education'], drop_first=True)\n\n```\n\næ¥ä¸‹æ¥æˆ‘ä»¬è¦è¿›è¡Œæ•°æ®æ ‡å‡†åŒ–ï¼Œä»–çš„ç»Ÿè®¡å­¦æ„ä¹‰æˆ‘å°±ä¸è¯´äº†ï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆè¦è¿›è¡Œæ ‡å‡†åŒ–ï¼Œæ ‡å‡†åŒ–å¯ä»¥ä¼šå°†æ‰€æœ‰ç‰¹å¾ç¼©æ”¾åˆ°å‡å€¼ä¸º0ï¼Œæ ‡å‡†å·®ä¸º1çš„èŒƒå›´ï¼Œå¯¹äºé€»è¾‘å›å½’ç­‰çº¿æ€§æ¨¡å‹å¾ˆé‡è¦ï¼Œè€Œå¯¹äºä¸€äº›éšæœºæ£®æ—ï¼Œç¥ç»ç½‘ç»œç­‰ç­‰çš„é»‘ç®±æ¨¡å‹ä¸å¤ªé‡è¦ï¼Œä½†æ˜¯æˆ‘è¿˜æ˜¯è¿›è¡Œæ ‡å‡†åŒ–ã€‚\n\n```{python}\n#| echo: true\n# æ•°æ®æ ‡å‡†åŒ– (å¯¹äºé€»è¾‘å›å½’ç­‰çº¿æ€§æ¨¡å‹å¾ˆé‡è¦)\n# StandardScaler ä¼šå°†æ‰€æœ‰ç‰¹å¾ç¼©æ”¾åˆ°å‡å€¼ä¸º0ï¼Œæ ‡å‡†å·®ä¸º1çš„èŒƒå›´\n#å…ˆå¯¼å…¥æˆ‘ä»¬éœ€è¦çš„åŒ…\nfrom sklearn.preprocessing import StandardScaler\n\nscaler = StandardScaler()\nX_scaled = scaler.fit_transform(X)\n```\n\n\\#### æœºå™¨å­¦ä¹  æˆ‘ä»¬å…ˆå®šä¹‰ä¸€å †æˆ‘ä»¬è¦ç”¨çš„æœºæ¢°å­¦ä¹ çš„æ¨¡å‹ï¼Œè®ºæ–‡é‡Œé¢ç”¨çš„æ˜¯éšæœºæ£®æ—ï¼Œé€»è¾‘å›å½’ï¼Œæ”¯æŒå‘é‡æœºï¼Œç­‰ç­‰\n\næˆ‘ä»¬å°†ä½¿ç”¨äº”ç§æœºå™¨å­¦ä¹ æ¨¡å‹æ¥é¢„æµ‹æ‚£è€…æ˜¯å¦å…·æœ‰é«˜æ°´å¹³çš„ä¸»è§‚å¹¸ç¦æ„Ÿï¼ˆSWBï¼‰ã€‚æ¯ç§æ¨¡å‹éƒ½æœ‰ä¸åŒçš„ç‰¹ç‚¹å’Œé€‚ç”¨åœºæ™¯ã€‚\n\n##### 1ï¸âƒ£ Logistic Regression (LR)\n\n. é€»è¾‘å›å½’æ˜¯ä¸€ç§ç»å…¸çš„çº¿æ€§æ¨¡å‹ï¼Œé€‚ç”¨äºäºŒåˆ†ç±»é—®é¢˜ï¼ˆå¦‚ï¼šé«˜SWB vs ä½SWBï¼‰ã€‚\n\n. ä¼˜ç‚¹ï¼šç®€å•ã€æ˜“è§£é‡Šã€è®¡ç®—å¿«ã€‚\n\n. åŸç†ï¼šæ ¹æ®æ¯ä¸ªå˜é‡çš„æƒé‡ï¼Œè®¡ç®—ä¸€ä¸ªæ¦‚ç‡å€¼ï¼ˆ0åˆ°1ä¹‹é—´ï¼‰ï¼Œåˆ¤æ–­å±äºå“ªä¸ªç±»åˆ«ã€‚\n\n. é€‚ç”¨åœºæ™¯ï¼šå˜é‡ä¹‹é—´å…³ç³»è¾ƒç®€å•ã€çº¿æ€§æ—¶æ•ˆæœå¥½ã€‚\n\n2ï¸âƒ£ Random Forest (RF) . éšæœºæ£®æ—æ˜¯ä¸€ç§é›†æˆå­¦ä¹ æ–¹æ³•ï¼Œç”±å¤šä¸ªå†³ç­–æ ‘ç»„æˆã€‚\n\n. ä¼˜ç‚¹ï¼šæŠ—è¿‡æ‹Ÿåˆã€èƒ½å¤„ç†éçº¿æ€§å…³ç³»ã€å¯¹ç¼ºå¤±å€¼å’Œå¼‚å¸¸å€¼é²æ£’ã€‚\n\n. åŸç†ï¼šæ¯æ£µæ ‘éƒ½åœ¨ä¸åŒçš„æ•°æ®å­é›†ä¸Šè®­ç»ƒï¼Œæœ€ç»ˆé€šè¿‡â€œæŠ•ç¥¨â€å†³å®šé¢„æµ‹ç»“æœã€‚\n\n. é€‚ç”¨åœºæ™¯ï¼šå˜é‡å¤šã€å…³ç³»å¤æ‚æ—¶è¡¨ç°ä¼˜å¼‚ã€‚\n\n. 3ï¸âƒ£ Gradient Boosting Machine (GBM) æ¢¯åº¦æå‡æœºæ˜¯ä¸€ç§é€æ­¥ä¼˜åŒ–çš„é›†æˆæ–¹æ³•ã€‚\n\n. ä¼˜ç‚¹ï¼šé¢„æµ‹ç²¾åº¦é«˜ï¼Œé€‚åˆå¤æ‚æ•°æ®ç»“æ„ã€‚\n\n. åŸç†ï¼šæ¯æ£µæ–°æ ‘éƒ½ä¸“æ³¨äºçº æ­£å‰ä¸€æ£µæ ‘çš„é”™è¯¯ï¼Œé€æ­¥æå‡æ•´ä½“æ€§èƒ½ã€‚\n\n. é€‚ç”¨åœºæ™¯ï¼šéœ€è¦é«˜ç²¾åº¦é¢„æµ‹æ—¶ï¼ŒGBMæ˜¯å¸¸ç”¨é€‰æ‹©ã€‚\n\n.\n\n4ï¸âƒ£ XGBoost (XGB) . æç«¯æ¢¯åº¦æå‡æ˜¯GBMçš„é«˜æ•ˆç‰ˆæœ¬ï¼Œåœ¨æ•°æ®ç§‘å­¦ç«èµ›ä¸­éå¸¸æµè¡Œã€‚\n\n. ä¼˜ç‚¹ï¼šé€Ÿåº¦å¿«ã€æ€§èƒ½å¼ºã€æ”¯æŒç¼ºå¤±å€¼å¤„ç†å’Œæ­£åˆ™åŒ–ã€‚\n\n. åŸç†ï¼šåœ¨GBMåŸºç¡€ä¸ŠåŠ å…¥æ›´å¤šä¼˜åŒ–ç­–ç•¥ï¼Œå¦‚å‰ªæã€å¹¶è¡Œè®¡ç®—ã€‚\n\n. é€‚ç”¨åœºæ™¯ï¼šå¤§æ•°æ®ã€é«˜ç»´åº¦ã€éœ€è¦å¿«é€Ÿè®­ç»ƒæ—¶ã€‚\n\n5ï¸âƒ£ LightGBM (LGBM) . è½»é‡çº§æ¢¯åº¦æå‡æœºæ˜¯å¦ä¸€ç§é«˜æ•ˆçš„GBMå˜ä½“ï¼Œä¸“ä¸ºå¤§è§„æ¨¡æ•°æ®è®¾è®¡ã€‚\n\n. ä¼˜ç‚¹ï¼šè®­ç»ƒé€Ÿåº¦å¿«ã€å†…å­˜å ç”¨ä½ã€é€‚åˆé«˜ç»´ç¨€ç–æ•°æ®ã€‚\n\n. åŸç†ï¼šä½¿ç”¨â€œå¶å­ä¼˜å…ˆâ€ç­–ç•¥æ„å»ºæ ‘ï¼Œæå‡æ•ˆç‡ã€‚\n\n. é€‚ç”¨åœºæ™¯ï¼šæ•°æ®é‡å¤§ã€å˜é‡å¤šæ—¶éå¸¸é€‚åˆã€‚\n\n**å½“ç„¶ï¼Œéšç€ç°åœ¨ç®—æ³•çš„å‡çº§ï¼Œè¿˜æœ‰å¾ˆå¤šç®—æ³•åœ¨ä»–ä»¬ä¹‹ä¸Šæœ‰æ›´å¥½çš„è¡¨ç°ï¼Œä¹Ÿè¦æ ¹æ®æ•°æ®å’Œæ¨¡å‹çš„ç”¨é€”è¿›è¡ŒåŒ¹é…**\n\nğŸ“Š ä¸ºä»€ä¹ˆè¦æ¯”è¾ƒå¤šä¸ªæ¨¡å‹ï¼Ÿ ä¸åŒæ¨¡å‹å¯¹æ•°æ®çš„æ•æ„Ÿæ€§ä¸åŒï¼Œé€‚åˆçš„åœºæ™¯ä¹Ÿä¸åŒã€‚\n\næ¯”è¾ƒå¤šä¸ªæ¨¡å‹å¯ä»¥æ‰¾åˆ°æœ€ç¨³å®šã€æœ€å‡†ç¡®çš„é¢„æµ‹æ–¹æ³•ã€‚\n\n```{python}\n#| echo: true\n\n#  å®šä¹‰è¦æ¯”è¾ƒçš„æ¨¡å‹ ---\n# ä¾æ—§å¯¼å…¥éœ€è¦çš„åŒ…\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.ensemble import RandomForestClassifier, GradientBoostingClassifier\nimport xgboost as xgb\nimport lightgbm as lgb\n\n# æˆ‘ä»¬å°†æ‰€æœ‰æ¨¡å‹å‚¨å­˜åœ¨ä¸€ä¸ªå­—å…¸ä¸­ï¼Œæ–¹ä¾¿å¾ªç¯è°ƒç”¨\nmodels = {\n    \"Logistic Regression (LR)\": LogisticRegression(max_iter=1000, random_state=42),\n    \"Random Forest (RF)\": RandomForestClassifier(n_estimators=500, max_depth=5, random_state=42),\n    \"Gradient Boosting (GBM)\": GradientBoostingClassifier(n_estimators=200, max_depth=3, random_state=42),\n    \"XGBoost (XGB)\": xgb.XGBClassifier(n_estimators=200, max_depth=3, use_label_encoder=False, eval_metric='logloss', random_state=42),\n    \"LightGBM (LGBM)\": lgb.LGBMClassifier(n_estimators=200, max_depth=3, random_state=42, verbosity=-1)\n\n}\n```\n\n##### ğŸ§ª ä½¿ç”¨ 5 æŠ˜äº¤å‰éªŒè¯è¯„ä¼°æ‰€æœ‰æ¨¡å‹\n\nåœ¨è¿™ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†å¯¹äº”ç§æœºå™¨å­¦ä¹ æ¨¡å‹è¿›è¡Œæ€§èƒ½è¯„ä¼°ï¼Œä½¿ç”¨çš„æ˜¯ä¸€ç§éå¸¸ç¨³å¥çš„æ–¹æ³•ï¼š5 æŠ˜äº¤å‰éªŒè¯ï¼ˆ5-fold cross-validationï¼‰ã€‚\n\n. âœ… ä»€ä¹ˆæ˜¯äº¤å‰éªŒè¯ï¼Ÿ äº¤å‰éªŒè¯æ˜¯ä¸€ç§å°†æ•°æ®é›†åˆ†æˆå¤šä¸ªâ€œå­é›†â€æ¥è®­ç»ƒå’Œæµ‹è¯•æ¨¡å‹çš„æ–¹æ³•ã€‚\n\n. åœ¨ 5 æŠ˜äº¤å‰éªŒè¯ä¸­ï¼Œæˆ‘ä»¬å°†æ•°æ®åˆ†æˆ 5 ä»½ï¼š\n\n. æ¯æ¬¡ç”¨å…¶ä¸­ 4 ä»½è®­ç»ƒæ¨¡å‹ï¼Œå‰©ä¸‹ 1 ä»½æµ‹è¯•æ¨¡å‹ã€‚\n\n. è¿™ä¸ªè¿‡ç¨‹é‡å¤ 5 æ¬¡ï¼Œæ¯æ¬¡æµ‹è¯•é›†éƒ½ä¸åŒã€‚\n\n. æœ€åæˆ‘ä»¬è®¡ç®— 5 æ¬¡çš„å¹³å‡æ€§èƒ½æŒ‡æ ‡ï¼ˆå¦‚ AUCï¼‰ï¼Œå¾—åˆ°ä¸€ä¸ªæ›´ç¨³å®šçš„è¯„ä¼°ç»“æœã€‚\n\n. è¿™ç§æ–¹æ³•æ¯”å•æ¬¡è®­ç»ƒ/æµ‹è¯•åˆ’åˆ†æ›´å¯é ï¼Œèƒ½å‡å°‘â€œè¿æ°”å¥½/åâ€å¸¦æ¥çš„è¯¯å·®ã€‚\n\n. ğŸ“Š ä¸ºä»€ä¹ˆé€‰æ‹© AUCï¼Ÿ . AUC æ˜¯è¡¡é‡æ¨¡å‹åŒºåˆ†èƒ½åŠ›çš„æŒ‡æ ‡ï¼Œå€¼è¶Šæ¥è¿‘ 1ï¼Œæ¨¡å‹è¶Šå¥½ã€‚\n\n```{python}\n#| echo: true\nfrom sklearn.model_selection import cross_val_score\n\nresults = {} # åˆ›å»ºä¸€ä¸ªç©ºå­—å…¸æ¥å‚¨å­˜ç»“æœ\n\nprint(\"æ­£åœ¨ä½¿ç”¨5æŠ˜äº¤å‰éªŒè¯è¯„ä¼°æ¯ä¸ªæ¨¡å‹...\")\n\n# å¾ªç¯éå†æˆ‘ä»¬å®šä¹‰çš„æ¯ä¸ªæ¨¡å‹\nfor model_name, model in models.items():\n    # å¯¹çº¿æ€§æ¨¡å‹ï¼ˆé€»è¾‘å›å½’ï¼‰ä½¿ç”¨æ ‡å‡†åŒ–åçš„æ•°æ®\n    if model_name == \"Logistic Regression (LR)\":\n        X_input = X_scaled\n    else: # å¯¹æ ‘æ¨¡å‹ä½¿ç”¨åŸå§‹ç¼–ç åçš„æ•°æ®\n        X_input = X\n\n    # ä½¿ç”¨ cross_val_score å‡½æ•°è¿›è¡Œ5æŠ˜äº¤å‰éªŒè¯\n    # cv=5: æŒ‡å®šäº†æŠ˜æ•°\n    # scoring='roc_auc': æŒ‡å®šè¯„ä¼°æŒ‡æ ‡ä¸º AUC\n\n    cv_scores = cross_val_score(model, X_input, y, cv=5, scoring='roc_auc')\n\n    # å°†æ¯ä¸ªæ¨¡å‹çš„åç§°å’Œå…¶5æ¬¡äº¤å‰éªŒè¯çš„å¹³å‡åˆ†åŠæ ‡å‡†å·®å­˜å…¥ç»“æœå­—å…¸\n    results[model_name] = {\n        'mean_auc': np.mean(cv_scores),\n        'std_auc': np.std(cv_scores)\n    }\n    \n    # æ‰“å°æ¯ä¸ªæ¨¡å‹çš„è¯„ä¼°ç»“æœ\n    print(f\"  {model_name}: å¹³å‡ AUC = {results[model_name]['mean_auc']:.4f} (æ ‡å‡†å·® = {results[model_name]['std_auc']:.4f})\")\n```\n\nè¿™äº› LightGBM çš„æ—¥å¿—ä¿¡æ¯å’Œè­¦å‘Šæ˜¯æ¨¡å‹è®­ç»ƒè¿‡ç¨‹ä¸­çš„æ­£å¸¸è¾“å‡ºï¼Œå°¤å…¶æ˜¯è¿™å¥ï¼š\n\n> **\\[Warning\\] No further splits with positive gain, best gain: -inf**\n\nå®ƒçš„æ„æ€æ˜¯ï¼šåœ¨æŸä¸€è½®è®­ç»ƒä¸­ï¼ŒLightGBM æ²¡æœ‰æ‰¾åˆ°ä»»ä½•å¯ä»¥ç»§ç»­åˆ†è£‚çš„èŠ‚ç‚¹ï¼ˆå³æ²¡æœ‰â€œæ­£å¢ç›Šâ€çš„åˆ†è£‚ç‚¹ï¼‰ï¼Œæ‰€ä»¥è¯¥è½®çš„æ ‘æ„å»ºå°±æå‰ç»ˆæ­¢äº†ã€‚è¿™é€šå¸¸æ˜¯å› ä¸ºï¼š\n\n-   æ•°æ®å·²ç»è¢«å¾ˆå¥½åœ°æ‹Ÿåˆï¼›\n\n-   å½“å‰å‚æ•°é™åˆ¶äº†æ ‘çš„å¤æ‚åº¦ï¼ˆå¦‚ `max_depth`ã€`min_data_in_leaf` ç­‰ï¼‰ï¼›\n\n-   æˆ–è€…æ•°æ®æœ¬èº«ä¸æ”¯æŒè¿›ä¸€æ­¥åˆ†è£‚ï¼ˆä¾‹å¦‚æ ·æœ¬å¤ªå°‘æˆ–ç‰¹å¾å¤ªå¼±ï¼‰ã€‚\n\nè¿™ä¸æ˜¯é”™è¯¯ï¼Œä¹Ÿä¸ä¼šå½±å“æ¨¡å‹çš„æ­£å¸¸è®­ç»ƒå’Œé¢„æµ‹æ€§èƒ½ã€‚\n\n#### å¯è§†åŒ–ç»“æœğŸ¤¨\n\n. æ¯”è¾ƒå¹³å‡ AUC åˆ†æ•°ï¼š æŸ¥çœ‹æ‰“å°çš„è¾“å‡ºå’Œæ¡å½¢å›¾ã€‚æ‚¨å°†çœ‹åˆ°äº”ä¸ªæ¨¡å‹çš„å¹³å‡ AUC åˆ†æ•°ã€‚ ä¸åŸå§‹è®ºæ–‡ä¸€è‡´ï¼Œæ‚¨å¯èƒ½ä¼šå‘ç°æ‰€æœ‰é«˜çº§æ¨¡å‹ï¼ˆRFï¼ŒGBMï¼ŒXGBï¼ŒLGBMï¼‰çš„è¡¨ç°éå¸¸ç›¸ä¼¼ï¼Œå¹¶ä¸”æ˜æ˜¾ä¼˜äºåŸºçº¿ Logistic å›å½’æ¨¡å‹ ã€‚\n\néšæœºæ£®æ—æ¨¡å‹å¯èƒ½ä»ç„¶ç•¥å ä¼˜åŠ¿ï¼Œå°±åƒè®ºæ–‡ä¸­æåˆ°çš„é‚£æ ·ï¼ŒAUC å¾—åˆ†åœ¨ 0.79-0.80 å·¦å³ ã€‚è¿™è¯å®äº†æˆ‘ä»¬ä¹‹å‰çš„å‘ç°ï¼Œä½†ç°åœ¨çš„ç½®ä¿¡åº¦æ›´é«˜äº†ã€‚é¡¶çº§æ¨¡å‹ä¹‹é—´æ€§èƒ½æ¥è¿‘ï¼Œè¿™æ˜¯æœºå™¨å­¦ä¹ ä¸­ä¸€ä¸ªéå¸¸å¸¸è§ä¸”é‡è¦çš„å‘ç°ã€‚\n\næ ‡å‡†å·®ï¼ˆè¯¯å·®çº¿ï¼‰çš„é‡è¦æ€§ï¼š æ ‡å‡†å·®ï¼ˆç”±æ¡å½¢å›¾ä¸Šçš„é»‘è‰²â€œè¯¯å·®çº¿â€è¡¨ç¤ºï¼‰å‘Šè¯‰æ‚¨æ¨¡å‹çš„æ€§èƒ½åœ¨ 5 ä¸ªä¸åŒæŠ˜å ä¹‹é—´çš„å·®å¼‚æœ‰å¤šå¤§ã€‚ æ ‡å‡†å·®è¶Šå°ï¼ˆè¯¯å·®çº¿è¶ŠçŸ­ï¼‰ï¼Œæ•ˆæœè¶Šå¥½ã€‚ è¿™æ„å‘³ç€æ¨¡å‹ç¨³å®šï¼Œå…¶æ€§èƒ½ä¸ä¼šä¸¥é‡ä¾èµ–äºè®­ç»ƒæ—¶æ‰€ç”¨çš„ç‰¹å®šæ•°æ®å­é›†ã€‚\n\næ‚¨å¯èƒ½ä¼šæ³¨æ„åˆ°åŸºäºæ ‘çš„æ¨¡å‹å…·æœ‰ç›¸å¯¹è¾ƒä½çš„æ–¹å·®ï¼Œè¿™è¡¨æ˜å®ƒä»¬å¾ˆç¨³å®šã€‚\n\n```{python}\n#| echo: true\n\n# å°†ç»“æœå­—å…¸è½¬æ¢ä¸º DataFrameï¼Œæ–¹ä¾¿ç»˜å›¾\nresults_df = pd.DataFrame(results).T.sort_values(by='mean_auc', ascending=False)\n\nplt.figure(figsize=(12, 7))\nbars = plt.bar(results_df.index, results_df['mean_auc'], yerr=results_df['std_auc'], capsize=5, color='skyblue')\n\n# åœ¨æ¯ä¸ªæŸ±çŠ¶å›¾ä¸Šæ˜¾ç¤ºæ•°å€¼\nfor bar in bars:\n    yval = bar.get_height()\n    plt.text(bar.get_x() + bar.get_width()/2.0, yval + 0.01, f'{yval:.3f}', ha='center', va='bottom')\n\nplt.ylabel('Mean AUC Score ')\nplt.xlabel('Machine Learning Models ')\nplt.title('Comparison of ML Models using 5-Fold Cross-Validation ')\nplt.ylim(0, 1.0) # è®¾ç½®yè½´èŒƒå›´ä¸º0åˆ°1\nplt.xticks(rotation=15) # æ—‹è½¬xè½´æ ‡ç­¾ï¼Œé˜²æ­¢é‡å \nplt.grid(axis='y', linestyle='--', alpha=0.7)\nplt.show()\n```\n\n**ğŸ¯ æ¨¡å‹è¡¨ç°æ’åï¼ˆæŒ‰ AUCï¼‰**\n\n| æ¨¡å‹åç§°                    | å¹³å‡ AUC åˆ†æ•° |\n|-----------------------------|---------------|\n| ğŸ¥‡ **Random Forest (RF)**   | **0.798**     |\n| ğŸ¥ˆ Logistic Regression (LR) | 0.792         |\n| ğŸ¥‰ LightGBM (LGBM)          | 0.760         |\n| XGBoost (XGB)               | 0.758         |\n| Gradient Boosting (GBM)     | 0.757         |\n\n**ğŸ“Œ è¯„ä¼°**\n\n> åœ¨è¿™æ¬¡è¯„ä¼°ä¸­ï¼Œ**Random Forest** ä¸ä»…åœ¨å¹³å‡ AUC ä¸Šé¢†å…ˆï¼Œè€Œä¸”å…¶ç¨³å®šæ€§ä¹Ÿå¾ˆé«˜ï¼ˆæ ‡å‡†å·®è¾ƒå°ï¼‰ã€‚è¿™è¯´æ˜å®ƒåœ¨ä¸åŒæ•°æ®åˆ’åˆ†ä¸‹éƒ½èƒ½ä¿æŒè‰¯å¥½çš„é¢„æµ‹èƒ½åŠ›ï¼Œæ˜¯ä¸€ä¸ªéå¸¸å¯é çš„æ¨¡å‹é€‰æ‹©ã€‚\n\n-   è™½ç„¶é€»è¾‘å›å½’æ˜“äºè§£é‡Šï¼Œä½†åœ¨å¤æ‚æ•°æ®ä¸­ï¼Œé›†æˆæ ‘æ¨¡å‹ï¼ˆå¦‚ RFï¼‰å¾€å¾€èƒ½æ•æ‰æ›´ä¸°å¯Œçš„éçº¿æ€§å…³ç³»ï¼›\n\n-   RF çš„ä¼˜åŠ¿åœ¨äºâ€œç¨³å¥æ€§â€å’Œâ€œæ³›åŒ–èƒ½åŠ›â€ï¼Œå°¤å…¶é€‚åˆä¸´åºŠæ•°æ®è¿™ç§å˜é‡å¤šã€ç»“æ„å¤æ‚çš„åœºæ™¯ï¼›\n\n-   è¿™ä¹ŸéªŒè¯äº†åŸå§‹è®ºæ–‡çš„ç»“è®ºï¼šRF æ˜¯é¢„æµ‹ä¸»è§‚å¹¸ç¦æ„Ÿçš„é¦–é€‰æ¨¡å‹ä¹‹ä¸€ã€‚\n\n------------------------------------------------------------------------\n\n## æ”¹è¿›æ¨¡å‹ğŸ¤–ğŸ¤–\n\nè™½ç„¶æˆ‘ä»¬çš„æ¨¡å‹AUCæœ‰0.8å·¦å³ï¼Œè¿™æ ·çš„æ•°æ®å·²ç»ä¸é”™äº†ï¼Œå¦‚æœæ¯”è¾ƒåŸæ¥çš„è®ºæ–‡[åŸè®ºæ–‡é“¾æ¥](https://pmc.ncbi.nlm.nih.gov/articles/PMC12236327/#s5)\n\n`The random forest (RF) model had the highest area under the curve (AUC) of 0.794 at baseline. Obsessive-compulsive symptoms (OCS) had the most significant impact on high levels of SWB, followed by somatization, cognitive deficits, and depression. The network analysis demonstrated robust connections among the SWB, OCS, and somatization. SEM analysis revealed that OCS exerted the strongest direct effect on SWB, and also an indirect effect via the mediation of depression. Furthermore, the contribution of OCS at baseline to SWB was maintained 6 months later.éšæœºæ£®æ— (RF) æ¨¡å‹çš„åŸºçº¿æ›²çº¿ä¸‹é¢ç§¯ (AUC) æœ€é«˜ï¼Œä¸º 0.794ã€‚å¼ºè¿«ç—‡çŠ¶ (OCS) å¯¹é«˜æ°´å¹³ä¸»è§‚å¹¸ç¦æ„Ÿ (SWB) çš„å½±å“æœ€ä¸ºæ˜¾è‘—ï¼Œå…¶æ¬¡æ˜¯èº¯ä½“åŒ–ã€è®¤çŸ¥ç¼ºé™·å’ŒæŠ‘éƒç—‡ã€‚ç½‘ç»œåˆ†æè¡¨æ˜ï¼ŒSWBã€OCS å’Œèº¯ä½“åŒ–ä¹‹é—´å­˜åœ¨ç¨³æ€è”ç³»ã€‚ç»“æ„æ–¹ç¨‹æ¨¡å‹ (SEM) åˆ†ææ˜¾ç¤ºï¼ŒOCS å¯¹ SWB çš„ç›´æ¥å½±å“æœ€ä¸ºæ˜¾è‘—ï¼Œå¹¶ä¸”ä¹Ÿé€šè¿‡æŠ‘éƒç—‡çš„ä¸­ä»‹äº§ç”Ÿé—´æ¥å½±å“ã€‚æ­¤å¤–ï¼ŒåŸºçº¿ OCS å¯¹ SWB çš„è´¡çŒ®åœ¨ 6 ä¸ªæœˆåå¾—ä»¥ç»´æŒã€‚`\n\nçœ‹èµ·æ¥ç¡®å®å·²ç»ä¸é”™äº†ï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜æ˜¯å¯ä»¥å¯¹åŸæ¥çš„æ¨¡å‹è¿›è¡Œæ”¹å–„ï¼Œè¿™æ˜¯åŸè®ºæ–‡æ²¡æœ‰è¿›è¡Œçš„æ“ä½œï¼Œå…·ä½“æœ‰ä¸¤ç§æ–¹æ³•ï¼Œåœ¨æ¨¡å‹ä¸æ”¹å˜çš„æƒ…å†µä¸‹\n\n**ç‰¹å¾é€‰æ‹©ï¼ˆFeature Selectionï¼‰** å’Œ **è¶…å‚æ•°è°ƒæ•´ï¼ˆHyperparameter Tuningï¼‰**\n\n#### ğŸ§  ä¸ºä»€ä¹ˆè¦è¿›è¡Œç‰¹å¾é€‰æ‹©ï¼Ÿ\n\n> **ç†å¿µï¼šå°‘å³æ˜¯å¤šï¼ˆLess is Moreï¼‰**\n\nåœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œä½¿ç”¨æ‰€æœ‰å˜é‡å¹¶ä¸æ€»æ˜¯æœ€å¥½çš„é€‰æ‹©ã€‚æœ‰äº›å˜é‡å¯èƒ½ï¼š\n\n-   ä¸ç›®æ ‡æ— å…³ï¼ˆå™ªå£°ï¼‰ï¼›\n\n-   ä¸å…¶ä»–å˜é‡é«˜åº¦å†—ä½™ï¼ˆé‡å¤ä¿¡æ¯ï¼‰ï¼›\n\n-   å¢åŠ æ¨¡å‹å¤æ‚åº¦ï¼Œå¯¼è‡´è¿‡æ‹Ÿåˆï¼›\n\n-   é™ä½æ¨¡å‹è§£é‡Šæ€§ï¼Œè®©ä¸´åºŠäººå‘˜éš¾ä»¥ç†è§£ã€‚\n\n### âœ… ç‰¹å¾é€‰æ‹©çš„å¥½å¤„ï¼š\n\n-   **æå‡æ¨¡å‹æ€§èƒ½**ï¼šå»é™¤æ— å…³å˜é‡åï¼Œæ¨¡å‹æ›´ä¸“æ³¨äºæœ‰æ•ˆä¿¡æ¯ï¼›\n\n-   **æé«˜è®­ç»ƒé€Ÿåº¦**ï¼šå˜é‡å°‘ï¼Œè®¡ç®—æ›´å¿«ï¼›\n\n-   **å¢å¼ºè§£é‡Šæ€§**ï¼šæ›´å®¹æ˜“å‘ä¸´åºŠäººå‘˜è§£é‡Šæ¨¡å‹å†³ç­–ï¼›\n\n-   **å‡å°‘è¿‡æ‹Ÿåˆé£é™©**ï¼šæ¨¡å‹æ›´ç¨³å¥ï¼Œæ³›åŒ–èƒ½åŠ›æ›´å¼ºã€‚\n\n#### ğŸ”§ ä¸ºä»€ä¹ˆè¦è¿›è¡Œè¶…å‚æ•°è°ƒæ•´ï¼Ÿ\n\n> **ç†å¿µï¼šæ¨¡å‹çš„â€œä¸ªæ€§åŒ–è®¾ç½®â€å†³å®šå®ƒçš„è¡¨ç°**\n\næ¯ä¸ªæœºå™¨å­¦ä¹ æ¨¡å‹éƒ½æœ‰ä¸€äº›â€œå†…éƒ¨è®¾ç½®â€ï¼Œç§°ä¸º**è¶…å‚æ•°**ï¼ˆhyperparametersï¼‰ï¼Œå®ƒä»¬ä¸æ˜¯ä»æ•°æ®ä¸­å­¦å‡ºæ¥çš„ï¼Œè€Œæ˜¯ä½ æå‰è®¾å®šçš„ã€‚\n\nä¾‹å¦‚ï¼š\n\n-   éšæœºæ£®æ—çš„ `n_estimators`ï¼ˆæ ‘çš„æ•°é‡ï¼‰ã€`max_depth`ï¼ˆæ ‘çš„æœ€å¤§æ·±åº¦ï¼‰ï¼›\n\n-   XGBoost çš„ `learning_rate`ï¼ˆå­¦ä¹ ç‡ï¼‰ã€`subsample`ï¼ˆæ ·æœ¬é‡‡æ ·æ¯”ä¾‹ï¼‰ï¼›\n\n-   LightGBM çš„ `num_leaves`ï¼ˆå¶å­æ•°ï¼‰ã€`min_data_in_leaf`ï¼ˆæ¯ä¸ªå¶å­æœ€å°‘æ ·æœ¬æ•°ï¼‰ã€‚\n\n### âœ… è¶…å‚æ•°è°ƒæ•´çš„å¥½å¤„ï¼š\n\n-   **æå‡æ¨¡å‹æ€§èƒ½**ï¼šæ‰¾åˆ°æœ€é€‚åˆå½“å‰æ•°æ®çš„å‚æ•°ç»„åˆï¼›\n\n-   **æ§åˆ¶æ¨¡å‹å¤æ‚åº¦**ï¼šé˜²æ­¢è¿‡æ‹Ÿåˆæˆ–æ¬ æ‹Ÿåˆï¼›\n\n-   **å¢å¼ºæ¨¡å‹ç¨³å®šæ€§**ï¼šæé«˜åœ¨ä¸åŒæ•°æ®åˆ’åˆ†ä¸‹çš„è¡¨ç°ä¸€è‡´æ€§ã€‚\n\n### ç‰¹å¾é€‰æ‹©ğŸ¤©\n\n```{python}\n#| echo: true\n\n# å¯¼å…¥æ‰€éœ€çš„åº“\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom sklearn.model_selection import cross_val_score\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.preprocessing import StandardScaler\n# --- 2. è¯†åˆ«æœ€é‡è¦çš„ç‰¹å¾ ---\n# Identify the most important features\n\n#å’Œä»¥å‰ä¸€æ ·å¯¼å…¥æ•°æ®\n# --- 1. åŠ è½½å¹¶å‡†å¤‡æ•°æ® (ä¸ä¹‹å‰ç›¸åŒ) ---\n# Load and Prepare the Data\n\n# !!! é‡è¦æç¤º: è¯·å°†ä¸‹é¢çš„è·¯å¾„ä¿®æ”¹ä¸ºæ‚¨ä¿å­˜ CSV æ–‡ä»¶çš„å®é™…ä½ç½® !!!\nfile_path = \"./synthetic_schizophrenia_data.csv\"\ndf = pd.read_csv(file_path)\n\ndf['High_SWB'] = (df['SWN_Total_Score'] >= 80).astype(int)\nX = df.drop(['SWN_Total_Score', 'High_SWB'], axis=1)\ny = df['High_SWB']\nX = pd.get_dummies(X, columns=['Education'], drop_first=True)\n\n\n\n\nprint(\"--- æ–¹æ³•ä¸€: ç‰¹å¾é€‰æ‹© ---\")\nprint(\"é¦–å…ˆï¼Œæˆ‘ä»¬è®­ç»ƒä¸€ä¸ªåŸºç¡€æ¨¡å‹æ¥è·å–ç‰¹å¾é‡è¦æ€§...\")\n\n# è®­ç»ƒä¸€ä¸ªä¸´æ—¶çš„éšæœºæ£®æ—æ¨¡å‹æ¥è·å–ç‰¹å¾é‡è¦æ€§æ’åº\ntemp_rf = RandomForestClassifier(n_estimators=500, max_depth=5, random_state=42)\ntemp_rf.fit(X, y)\n\n# åˆ›å»ºä¸€ä¸ªåŒ…å«ç‰¹å¾åç§°å’Œå…¶é‡è¦æ€§åˆ†æ•°çš„ DataFrame\nfeature_importances = pd.DataFrame({\n    'feature': X.columns,\n    'importance': temp_rf.feature_importances_\n}).sort_values('importance', ascending=False)\n\n# æ‰“å°æœ€é‡è¦çš„ç‰¹å¾\nprint(\"\\næ ¹æ®åŸºç¡€æ¨¡å‹å¾—å‡ºçš„ç‰¹å¾é‡è¦æ€§æ’åº:\")\nprint(feature_importances)\n```\n\n#### ğŸ“Š åˆ é™¤å»ºè®®ï¼ˆæŒ‰é‡è¦æ€§æ–­å±‚ï¼‰\n\næˆ‘æ‰“ç®—åˆ é™¤çš„å˜é‡ï¼Œå…¶é‡è¦æ€§å¦‚ä¸‹ï¼š\n\n| ç‰¹å¾åç§°                     | é‡è¦æ€§ |\n|------------------------------|--------|\n| DIEPSS_Overall_Severity      | 0.0267 |\n| Obesity                      | 0.0096 |\n| Diabetes                     | 0.0076 |\n| Occupation_Employed          | 0.0063 |\n| Education_High school        | 0.0061 |\n| Hypertension                 | 0.0049 |\n| Sex_Female                   | 0.0047 |\n| Education_Less than 12 years | 0.0043 |\n\nè¿™äº›å˜é‡éƒ½å’Œ `Age` çš„é‡è¦æ€§ï¼ˆ0.0408ï¼‰æ–­å±‚ï¼Œè¯´æ˜å®ƒä»¬å¯èƒ½å¯¹æ¨¡å‹é¢„æµ‹è´¡çŒ®éå¸¸æœ‰é™ã€‚\n\nä½†æ˜¯è€ƒè™‘åˆ°`DIEPSS_Oerall_Severity`å¯¹äºå®é™…æ„ä¹‰çš„ç¡®æœ‰å½±å“ï¼Œä¸”å’Œå…¶åé¢çš„ä¹Ÿæ–­å±‚äº†ï¼Œæ‰€ä»¥æˆ‘æ‰“ç®—ä¿ç•™\n\n***ç‰¹å¾é€‰æ‹©ä¸ä»…æ˜¯â€œæ•°å­¦é—®é¢˜â€ï¼Œä¹Ÿæ˜¯â€œé¢†åŸŸçŸ¥è¯†é—®é¢˜â€ã€‚***\n\næ‰€ä»¥æˆ‘ä»¬å·²ç»é€‰å‡ºäº†***10ä¸ªè´¡çŒ®æ¯”è¾ƒå¤§çš„ç‰¹å¾***\n\n```{python}\n#| echo: true\n# é€‰æ‹©æœ€é‡è¦çš„å‰ 10 ä¸ªç‰¹å¾\nN_TOP_FEATURES = 10\ntop_features = feature_importances['feature'].head(N_TOP_FEATURES).tolist()\nprint(f\"\\næˆ‘ä»¬å°†é€‰æ‹©æœ€é‡è¦çš„ {N_TOP_FEATURES} ä¸ªç‰¹å¾è¿›è¡Œå»ºæ¨¡: {top_features}\")\n\n# åˆ›å»ºåªåŒ…å«æœ€é‡è¦ç‰¹å¾çš„æ–°æ•°æ®é›†\nX_selected = X[top_features]\n\n# --- 3. åœ¨ç­›é€‰åçš„ç‰¹å¾ä¸Šé‡æ–°è¯„ä¼°æ¨¡å‹ ---\n# Re-evaluate the model on selected features\n\nprint(\"\\nä½¿ç”¨ç­›é€‰å‡ºçš„ç‰¹å¾è¿›è¡Œ5æŠ˜äº¤å‰éªŒè¯...\")\n# ä½¿ç”¨ä¸ä¹‹å‰ç›¸åŒçš„æ¨¡å‹é…ç½®\nmodel_on_selected_features = RandomForestClassifier(n_estimators=500, max_depth=5, random_state=42)\ncv_scores_selected = cross_val_score(model_on_selected_features, X_selected, y, cv=5, scoring='roc_auc')\n\n# æ‰“å°ç»“æœ\nmean_auc_selected = np.mean(cv_scores_selected)\nprint(f\"\\nä½¿ç”¨æœ€é‡è¦çš„ {N_TOP_FEATURES} ä¸ªç‰¹å¾, æ¨¡å‹çš„å¹³å‡ AUC åˆ†æ•°æ˜¯: {mean_auc_selected:.4f}\")\nprint(f\"åŸå§‹æ¨¡å‹çš„å¹³å‡ AUC åˆ†æ•°æ˜¯: 0.7980 (ä½œä¸ºå¯¹æ¯”)\")\n```\n\nä¸ºäº†åŠ ä»¥åŒºåˆ«ï¼Œæˆ‘ä»¬åˆ†åˆ«å¤åˆ¶ä»£ç ï¼Œé€‰å–9ä¸ªå’Œ11ä¸ªç‰¹å¾è¿›è¡Œè®­ç»ƒçœ‹çœ‹æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œå³å‰”é™¤`DIEPSS_Overall_Severity 0.026666` å’ŒåŠ ä¸Šä¸å¤ªé‡è¦çš„`Obesity 0.009579`çš„å˜é‡\n\n```{python}\n#| echo: true\n# é€‰æ‹©æœ€é‡è¦çš„å‰ 9 ä¸ªç‰¹å¾\n#å‰”é™¤DIEPSS_Overall_Severity 0.026666\nN_TOP_FEATURES = 9\ntop_features = feature_importances['feature'].head(N_TOP_FEATURES).tolist()\nprint(f\"\\næˆ‘ä»¬å°†é€‰æ‹©æœ€é‡è¦çš„ {N_TOP_FEATURES} ä¸ªç‰¹å¾è¿›è¡Œå»ºæ¨¡: {top_features}\")\n\n# åˆ›å»ºåªåŒ…å«æœ€é‡è¦ç‰¹å¾çš„æ–°æ•°æ®é›†\nX_selected = X[top_features]\n\n# --- 3. åœ¨ç­›é€‰åçš„ç‰¹å¾ä¸Šé‡æ–°è¯„ä¼°æ¨¡å‹ ---\n# Re-evaluate the model on selected features\n\nprint(\"\\nä½¿ç”¨ç­›é€‰å‡ºçš„ç‰¹å¾è¿›è¡Œ5æŠ˜äº¤å‰éªŒè¯...\")\n# ä½¿ç”¨ä¸ä¹‹å‰ç›¸åŒçš„æ¨¡å‹é…ç½®\nmodel_on_selected_features = RandomForestClassifier(n_estimators=500, max_depth=5, random_state=42)\ncv_scores_selected = cross_val_score(model_on_selected_features, X_selected, y, cv=5, scoring='roc_auc' )\n\n# æ‰“å°ç»“æœ\nmean_auc_selected = np.mean(cv_scores_selected)\nprint(f\"\\nä½¿ç”¨æœ€é‡è¦çš„ {N_TOP_FEATURES} ä¸ªç‰¹å¾, æ¨¡å‹çš„å¹³å‡ AUC åˆ†æ•°æ˜¯: {mean_auc_selected:.4f}\")\nprint(f\"åŸå§‹æ¨¡å‹çš„å¹³å‡ AUC åˆ†æ•°æ˜¯: 0.7980 (ä½œä¸ºå¯¹æ¯”)\")\n\n```\n\n```{python}\n#| echo: true\n# é€‰æ‹©æœ€é‡è¦çš„å‰ 11 ä¸ªç‰¹å¾\n# åŠ ä¸Šä¸å¤ªé‡è¦çš„Obesity 0.009579çš„å˜é‡\nN_TOP_FEATURES = 11\ntop_features = feature_importances['feature'].head(N_TOP_FEATURES).tolist()\nprint(f\"\\næˆ‘ä»¬å°†é€‰æ‹©æœ€é‡è¦çš„ {N_TOP_FEATURES} ä¸ªç‰¹å¾è¿›è¡Œå»ºæ¨¡: {top_features}\")\n\n# åˆ›å»ºåªåŒ…å«æœ€é‡è¦ç‰¹å¾çš„æ–°æ•°æ®é›†\nX_selected = X[top_features]\n\n# --- 3. åœ¨ç­›é€‰åçš„ç‰¹å¾ä¸Šé‡æ–°è¯„ä¼°æ¨¡å‹ ---\n# Re-evaluate the model on selected features\n\nprint(\"\\nä½¿ç”¨ç­›é€‰å‡ºçš„ç‰¹å¾è¿›è¡Œ5æŠ˜äº¤å‰éªŒè¯...\")\n# ä½¿ç”¨ä¸ä¹‹å‰ç›¸åŒçš„æ¨¡å‹é…ç½®\nmodel_on_selected_features = RandomForestClassifier(n_estimators=500, max_depth=5, random_state=42)\ncv_scores_selected = cross_val_score(model_on_selected_features, X_selected, y, cv=5, scoring='roc_auc')\n\n# æ‰“å°ç»“æœ\nmean_auc_selected = np.mean(cv_scores_selected)\nprint(f\"\\nä½¿ç”¨æœ€é‡è¦çš„ {N_TOP_FEATURES} ä¸ªç‰¹å¾, æ¨¡å‹çš„å¹³å‡ AUC åˆ†æ•°æ˜¯: {mean_auc_selected:.4f}\")\nprint(f\"åŸå§‹æ¨¡å‹çš„å¹³å‡ AUC åˆ†æ•°æ˜¯: 0.7980 (ä½œä¸ºå¯¹æ¯”)\")\n\n```\n\n#### ğŸ¯ æ•™å­¦æ€»ç»“ï¼šç‰¹å¾é€‰æ‹©çš„å®è¯ä»·å€¼\n\n| ç‰¹å¾æ•°é‡                           | å¹³å‡ AUC åˆ†æ•° | ç›¸å¯¹è¡¨ç°    |\n|------------------------------------|---------------|-------------|\n| åŸå§‹æ¨¡å‹ï¼ˆå…¨éƒ¨ç‰¹å¾ï¼‰               | 0.7980        | åŸºå‡†        |\n| æœ€é‡è¦çš„ 10 ä¸ªç‰¹å¾                 | **0.7991**    | âœ… æœ€ä½³è¡¨ç° |\n| æœ€é‡è¦çš„ 9 ä¸ªç‰¹å¾ï¼ˆå‰”é™¤ DIEPSSï¼‰   | 0.7975        | ç•¥ä½        |\n| æœ€é‡è¦çš„ 11 ä¸ªç‰¹å¾ï¼ˆåŠ å…¥ Obesityï¼‰ | 0.7974        | ç•¥ä½        |\n\n#### ğŸ§  è¦ç‚¹ä¸€ï¼šä¸æ˜¯ç‰¹å¾è¶Šå¤šè¶Šå¥½\n\n> å¢åŠ å˜é‡å¹¶ä¸ä¸€å®šæå‡æ¨¡å‹æ€§èƒ½ï¼Œåè€Œå¯èƒ½å¼•å…¥å™ªå£°æˆ–å†—ä½™ä¿¡æ¯ã€‚\n\n-   åŠ å…¥ **Obesityï¼ˆ0.009579ï¼‰** åï¼Œæ¨¡å‹æ€§èƒ½ç•¥å¾®ä¸‹é™ï¼›\n\n-   åˆ é™¤ **DIEPSSï¼ˆ0.026666ï¼‰** åï¼Œæ¨¡å‹ä¹Ÿç•¥å¾®ä¸‹é™ï¼›\n\n-   è¯´æ˜è¿™ä¸¤ä¸ªå˜é‡è™½ç„¶è´¡çŒ®ä¸å¤§ï¼Œä½†ä¹Ÿä¸æ˜¯å®Œå…¨æ— æ•ˆï¼Œå°¤å…¶ DIEPSS å¯èƒ½æœ‰ä¸€å®šä¸´åºŠè§£é‡Šä»·å€¼ã€‚\n\n#### ğŸ§  è¦ç‚¹äºŒï¼šæ‰¾åˆ°â€œæœ€ä½³å˜é‡ç»„åˆâ€æ‰æ˜¯å…³é”®\n\n> 10ä¸ªå˜é‡ç»„åˆçš„æ¨¡å‹è¡¨ç°æœ€å¥½ï¼Œè¯´æ˜å®ƒåœ¨ä¿¡æ¯é‡ä¸ç®€æ´æ€§ä¹‹é—´è¾¾åˆ°äº†å¹³è¡¡ã€‚\n\n-   è¿™ä¸ªç»„åˆæ—¢ä¿ç•™äº†é«˜è´¡çŒ®å˜é‡ï¼Œåˆé¿å…äº†ä½è´¡çŒ®å˜é‡çš„å¹²æ‰°ï¼›\n\n-   æ¨¡å‹æ›´å¿«ã€æ›´ç¨³å®šã€æ›´æ˜“è§£é‡Šï¼›ã€‚\n\n#### ğŸ§  è¦ç‚¹ä¸‰ï¼šè¿›è¡Œâ€œå˜é‡æ•æ„Ÿæ€§åˆ†æâ€\n\n-   é€ä¸ªæ·»åŠ æˆ–å‰”é™¤å˜é‡ï¼Œè§‚å¯Ÿæ¨¡å‹æ€§èƒ½å˜åŒ–ï¼›\n\n-   ç»“åˆé¢†åŸŸçŸ¥è¯†åˆ¤æ–­æ˜¯å¦ä¿ç•™æŸäº›ä¸´åºŠé‡è¦ä½†æ¨¡å‹è´¡çŒ®è¾ƒä½çš„å˜é‡ï¼›\n\n-   ç”¨å›¾è¡¨å±•ç¤º AUC éšå˜é‡æ•°é‡å˜åŒ–çš„è¶‹åŠ¿ï¼Œå¼ºåŒ–â€œå˜é‡é€‰æ‹©æ˜¯ç­–ç•¥æ€§å†³ç­–â€çš„ç†å¿µã€‚\n\n### è¶…å‚æ•°è°ƒä¼˜ğŸƒ\n\nä¾‹å¦‚ï¼Œå‡è®¾ n_estimators=500ï¼Œmax_depth=5ï¼Œä½†è¿™äº›è®¾ç½®å¯èƒ½å¹¶éæˆ‘ä»¬ç‰¹å®šâ€œèµ›é“â€ï¼ˆæ•°æ®é›†ï¼‰çš„æœ€ä½³è®¾ç½®ã€‚é€šè¿‡ç³»ç»Ÿåœ°å°è¯•è¿™äº›è®¾ç½®çš„ä¸åŒç»„åˆï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°èƒ½å¤Ÿå®ç°æœ€ä½³æ€§èƒ½çš„é…ç½® \\#### å…ˆæ˜¯ç½‘æ ¼æœç´¢\n\næ‰‹åŠ¨å®šä¹‰ä¸€ä¸ªå›ºå®šçš„ param_grid ç„¶åè¿›è¡Œâ€œæš´åŠ›â€æœç´¢ï¼ˆBrute-force Searchï¼‰ï¼Œæ˜¯è¶…å‚æ•°è°ƒä¼˜æœ€åŸºç¡€çš„æ–¹æ³•\n\n```{python}\n#| echo: true\n# å¯¼å…¥ GridSearchCV\nfrom sklearn.model_selection import GridSearchCV\n\nprint(\"\\n\\n--- æ–¹æ³•äºŒ: è¶…å‚æ•°è°ƒä¼˜ (è¿™å¯èƒ½éœ€è¦å‡ åˆ†é’Ÿ) ---\")\n\n# --- 1. å®šä¹‰è¦æœç´¢çš„è¶…å‚æ•°ç½‘æ ¼ ---\n# Define the parameter grid to search\n\n# è¿™æ˜¯ä¸€ä¸ªæˆ‘ä»¬è¦æµ‹è¯•çš„è¶…å‚æ•°ç»„åˆçš„ \"èœå•\"\nparam_grid = {\n    'n_estimators': [200, 400, 600],       # æ ‘çš„æ•°é‡\n    'max_depth': [4, 5, 6, 7],             # æ ‘çš„æœ€å¤§æ·±åº¦\n    'min_samples_leaf': [1, 3, 5],         # ä¸€ä¸ªå¶èŠ‚ç‚¹ä¸Šæœ€å°‘çš„æ ·æœ¬æ•°\n    'max_features': ['sqrt', 'log2']       # æ¯æ¬¡åˆ†è£‚æ—¶è€ƒè™‘çš„æœ€å¤§ç‰¹å¾æ•°\n}\n\n# --- 2. è®¾ç½®å¹¶è¿è¡Œ GridSearchCV ---\n# Setup and run GridSearchCV\n\n# åˆå§‹åŒ–æˆ‘ä»¬çš„åŸºç¡€æ¨¡å‹\nrf_base = RandomForestClassifier(random_state=42)\n\n# è®¾ç½® GridSearchCV\n# estimator: æˆ‘ä»¬è¦è°ƒä¼˜çš„æ¨¡å‹\n# param_grid: æˆ‘ä»¬å®šä¹‰çš„å‚æ•°ç½‘æ ¼\n# cv=5: ä½¿ç”¨5æŠ˜äº¤å‰éªŒè¯æ¥è¯„ä¼°æ¯ä¸€ç§å‚æ•°ç»„åˆ\n# scoring='roc_auc': æˆ‘ä»¬çš„è¯„ä¼°æŒ‡æ ‡\n\ngrid_search = GridSearchCV(estimator=rf_base, param_grid=param_grid, cv=5, scoring='roc_auc' , verbose=1)\n\n# åœ¨å®Œæ•´æ•°æ®é›†ä¸Šè¿è¡Œç½‘æ ¼æœç´¢\ngrid_search.fit(X, y)\n\n# --- 3. æ‰“å°æœ€ä½³ç»“æœ ---\n# Print the best results\n\nprint(\"\\nè¶…å‚æ•°è°ƒä¼˜å®Œæˆ!\")\n\n# æ‰“å°æ‰¾åˆ°çš„æœ€ä½³å‚æ•°ç»„åˆ\nprint(f\"æ‰¾åˆ°çš„æœ€ä½³è¶…å‚æ•°ç»„åˆ (Best Parameters): \\n{grid_search.best_params_}\")\n\n# æ‰“å°ä½¿ç”¨æœ€ä½³å‚æ•°æ—¶ï¼Œäº¤å‰éªŒè¯å¾—åˆ°çš„æœ€ä½³AUCåˆ†æ•°\nprint(f\"\\nä½¿ç”¨æœ€ä½³å‚æ•°æ—¶ï¼Œæ¨¡å‹çš„æœ€ä½³å¹³å‡ AUC åˆ†æ•°æ˜¯: {grid_search.best_score_:.4f}\")\n\n```\n\nä½¿ç”¨æœ€ä½³å‚æ•°æ—¶ï¼Œæ¨¡å‹çš„æœ€ä½³å¹³å‡ AUC åˆ†æ•°æ˜¯: 0.7997 æ­£å¦‚æˆ‘è¯´ï¼Œç½‘æ ¼æœç´¢æ˜¯è¶…å‚æ•°æœ€åŸºç¡€çš„æ–¹æ³•ï¼Œä½†å®ƒæœ‰ä¸¤ä¸ªä¸»è¦ç¼ºç‚¹ï¼š\n\n1.  **ç»´åº¦è¯…å’’ (Curse of Dimensionality):** å½“å‚æ•°å’Œä½ æƒ³å°è¯•çš„å€¼å˜å¤šæ—¶ï¼Œç»„åˆçš„æ•°é‡ä¼šå‘ˆæŒ‡æ•°çº§å¢é•¿ï¼Œå¯¼è‡´è®¡ç®—æˆæœ¬æé«˜ï¼Œéå¸¸è€—æ—¶ã€‚\n\n2.  **æ•ˆç‡ä½ä¸‹:** å®ƒä¼šèŠ±è´¹å¤§é‡æ—¶é—´å»å°è¯•é‚£äº›æ˜æ˜¾ä¸ä½³çš„å‚æ•°ç»„åˆã€‚\n\næ¥ä¸‹æ¥æˆ‘ä¼šç”¨ä¸€ä¸ªæ›´åŠ çˆ½çš„æ–¹æ³•ï¼Œ***å³è´å¶æ–¯ä¼˜åŒ–***\n\nè¿™æ˜¯ç›®å‰æœ€å…ˆè¿›å’Œæœ€é«˜æ•ˆçš„è°ƒä¼˜æ–¹æ³•ä¹‹ä¸€ï¼Œå®ƒå®Œç¾åœ°ä½“ç°äº†â€œè¿­ä»£é€‰æ‹©æœ€å¥½â€çš„æ€æƒ³ã€‚\n\n**æ ¸å¿ƒæ€æƒ³ï¼š**\\\nè´å¶æ–¯ä¼˜åŒ–ä¼šå»ºç«‹ä¸€ä¸ªå…³äºâ€œå“ªä¸ªå‚æ•°ç»„åˆå¯èƒ½å¾—åˆ°æ›´é«˜åˆ†æ•°â€çš„æ¦‚ç‡æ¨¡å‹ã€‚\n\n1.  å®ƒé¦–å…ˆå°è¯•å‡ ä¸ªéšæœºçš„å‚æ•°ç»„åˆã€‚\n\n2.  ç„¶åï¼Œå®ƒæ ¹æ®å·²æœ‰çš„ç»“æœï¼Œæ›´æ–°å†…éƒ¨çš„æ¦‚ç‡æ¨¡å‹ï¼Œé¢„æµ‹å‡ºâ€œæœ€æœ‰å¸Œæœ›â€æå‡åˆ†æ•°çš„ä¸‹ä¸€ä¸ªå‚æ•°ç»„åˆã€‚\n\n3.  å®ƒä¼šå»å°è¯•è¿™ä¸ªâ€œæœ€æœ‰å¸Œæœ›â€çš„ç»„åˆï¼Œç„¶åå†æ¬¡æ›´æ–°æ¨¡å‹ã€‚\n\n4.  è¿™ä¸ªè¿‡ç¨‹ä¼šä¸æ–­è¿­ä»£ï¼Œæ™ºèƒ½åœ°å°†æœç´¢èµ„æºé›†ä¸­åœ¨å‚æ•°ç©ºé—´ä¸­æœ€æœ‰æ½œåŠ›çš„åŒºåŸŸã€‚\n\n**æ‰“ä¸ªæ¯”æ–¹ï¼š** è¿™å°±åƒåœ¨ä¸€ä¸ªå¤§é›¾å¼¥æ¼«çš„å±±åŒºé‡Œæ‰¾æœ€é«˜å³°ã€‚ä½ ä¸ä¼šåœ¨åœ°æ¯¯å¼æœç´¢æ¯ä¸€å¯¸åœŸåœ°ï¼ˆç½‘æ ¼æœç´¢ï¼‰ï¼Œè€Œæ˜¯æ ¹æ®ä½ å½“å‰æ‰€åœ¨ä½ç½®çš„é«˜åº¦å’Œå¡åº¦ï¼Œæ¥åˆ¤æ–­ä¸‹ä¸€æ­¥å¾€å“ªä¸ªæ–¹å‘èµ°æœ€æœ‰å¯èƒ½ç™»å¾—æ›´é«˜ã€‚\n\n**ğŸ¥¸ä¸è¿‡éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºæ˜¯éšæœºç»„åˆï¼Œæ¯æ¬¡è¿œè¡Œä»£ç å¾—åˆ°çš„æœ€å¥½çš„ç»“æœéƒ½ä¸ä¸€æ ·ï¼Œå°±å¥½åƒåœ¨ä¹Œæ³±æ³±çš„å¤§æµ·æ‰¾æœ€å¤§çš„èˆ¹ï¼Œæœ‰çš„æ—¶å€™ä½ ä¸ä¸€å®šèƒ½æ‰¾åˆ°å±±ä¸œèˆ°èˆªæ¯ï¼Œå¯èƒ½åªä¼šæ‰¾åˆ°æŠ¤å«èˆ°**\n\n```{python}\n#| echo: true\n# å¯¼å…¥ optuna åº“\nimport optuna\nfrom sklearn.model_selection import cross_val_score\n\nprint(\"\\n\\n--- æœ€æ™ºèƒ½çš„è°ƒä¼˜æ–¹æ³•äºŒ: è´å¶æ–¯ä¼˜åŒ– (Bayesian Optimization with Optuna) ---\")\nprint(\"Optuna ä¼šæ ¹æ®å†å²ç»“æœï¼Œæ™ºèƒ½åœ°é€‰æ‹©ä¸‹ä¸€æ¬¡è¦å°è¯•çš„è¶…å‚æ•°...\")\n\n# --- 1. å®šä¹‰ä¸€ä¸ª \"ç›®æ ‡å‡½æ•°\" (Objective Function) ---\n# è¿™ä¸ªå‡½æ•°å‘Šè¯‰ Optuna å¦‚ä½•è¯„ä¼°ä¸€ç»„è¶…å‚æ•°çš„å¥½å\ndef objective(trial):\n    # 'trial' å¯¹è±¡ç”¨äºå»ºè®®è¶…å‚æ•°çš„å€¼\n    # Optuna ä¼šæ™ºèƒ½åœ°å†³å®šå»ºè®®å€¼çš„èŒƒå›´å’Œå…·ä½“å€¼\n    params = {\n        'n_estimators': trial.suggest_int('n_estimators', 200, 800), # å»ºè®®ä¸€ä¸ªåœ¨ [200, 800] èŒƒå›´å†…çš„æ•´æ•°\n        'max_depth': trial.suggest_int('max_depth', 3, 10),\n        'min_samples_leaf': trial.suggest_int('min_samples_leaf', 1, 10),\n        'max_features': trial.suggest_categorical('max_features', ['sqrt', 'log2']),\n    }\n    \n    # ä½¿ç”¨è¿™ç»„å‚æ•°åˆ›å»ºå¹¶è¯„ä¼°æ¨¡å‹\n    model = RandomForestClassifier(random_state=42, **params)\n    \n    # ä½¿ç”¨äº¤å‰éªŒè¯æ¥è·å¾—ç¨³å¥çš„åˆ†æ•°\n    score = cross_val_score(model, X, y, cv=5, scoring='roc_auc', ).mean()\n    \n    # Optuna çš„ç›®æ ‡æ˜¯æœ€å¤§åŒ–è¿™ä¸ªè¿”å›å€¼\n    return score\n\n# --- 2. åˆ›å»ºä¸€ä¸ª \"ç ”ç©¶\" (Study) å¹¶å¼€å§‹ä¼˜åŒ– ---\n# direction='maximize': å‘Šè¯‰ Optuna æˆ‘ä»¬çš„ç›®æ ‡æ˜¯æœ€å¤§åŒ– objective å‡½æ•°çš„è¿”å›å€¼\nstudy = optuna.create_study(direction='maximize', study_name='RF_Optimization')\n\n# n_trials=100: è¿è¡Œ100æ¬¡è¿­ä»£ã€‚Optuna ä¼šåœ¨è¿™100æ¬¡ä¸­æ™ºèƒ½åœ°å¯»æ‰¾æœ€ä¼˜è§£ã€‚\nstudy.optimize(objective, n_trials=100)\n\n# --- 3. æ‰“å°æœ€ä½³ç»“æœ ---\nprint(\"\\nè´å¶æ–¯ä¼˜åŒ–å®Œæˆ!\")\nprint(f\"è¿­ä»£æ¬¡æ•° (Number of finished trials): {len(study.trials)}\")\nprint(f\"æ‰¾åˆ°çš„æœ€ä½³è¶…å‚æ•°ç»„åˆ (Best Parameters): \\n{study.best_params}\")\nprint(f\"\\nä½¿ç”¨æœ€ä½³å‚æ•°æ—¶ï¼Œæ¨¡å‹çš„æœ€ä½³å¹³å‡ AUC åˆ†æ•°æ˜¯: {study.best_value:.4f}\")\n\n```\n\nä½¿ç”¨æœ€ä½³å‚æ•°æ—¶ï¼Œæ¨¡å‹çš„æœ€ä½³å¹³å‡ AUC åˆ†æ•°æ˜¯: 0.8042(å·®ä¸å¤šè¿œè¡Œäº†å¥½å‡ æ¬¡çš„æœ€å¥½æ•°æ®),è¿™æ˜¯è¿­ä»£åªæœ‰100æ¬¡ï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥å¤šè¿­ä»£ï¼Œè®¾ç½®åˆ°200ï¼Œ500ç­‰ç­‰ï¼Œåªè¦ä½ çš„è®¡ç®—æœºèƒ½æŠ—ä½ã€‚\n\n### æœ€ç»ˆä¼˜åŒ–ï¼šç»“åˆç‰¹å¾é€‰æ‹©ä¸è´å¶æ–¯è°ƒä¼˜ğŸ¤¤\n\n**ç›®æ ‡**ï¼š åœ¨æˆ‘ä»¬å·²ç»éªŒè¯è¿‡çš„â€œæœ€ä½³ç‰¹å¾é›†â€ï¼ˆæœ€é‡è¦çš„10ä¸ªç‰¹å¾ï¼‰ä¸Šï¼Œä½¿ç”¨è´å¶æ–¯ä¼˜åŒ–ï¼ˆOptunaï¼‰æ¥å¯»æ‰¾æœ€ä¼˜çš„è¶…å‚æ•°ç»„åˆï¼Œä»è€Œè·å¾—ç†è®ºä¸Šæ€§èƒ½æœ€å¥½çš„æ¨¡å‹\n\n```{python}\n#| echo: true\n# å¯¼å…¥æ‰€æœ‰éœ€è¦çš„åº“\nimport pandas as pd\nimport numpy as np\nimport optuna\nfrom sklearn.model_selection import cross_val_score\nfrom sklearn.ensemble import RandomForestClassifier\n\n# --- 1. æœ€ç»ˆæ­¥éª¤ä¸€ï¼šç¡®å®šå¹¶ç­›é€‰å‡ºæœ€ä½³ç‰¹å¾é›† (Top 10) ---\n# The first step of our final process: identify and select the best feature set.\n\n# !!! é‡è¦æç¤º: è¯·å°†ä¸‹é¢çš„è·¯å¾„ä¿®æ”¹ä¸ºæ‚¨ä¿å­˜ CSV æ–‡ä»¶çš„å®é™…ä½ç½® !!!\nfile_path = \"./synthetic_schizophrenia_data.csv\"\ndf = pd.read_csv(file_path)\n\ndf['High_SWB'] = (df['SWN_Total_Score'] >= 80).astype(int)\nX = df.drop(['SWN_Total_Score', 'High_SWB'], axis=1)\ny = df['High_SWB']\nX = pd.get_dummies(X, columns=['Education'], drop_first=True)\n\n\n# è®­ç»ƒä¸€ä¸ªä¸´æ—¶æ¨¡å‹æ¥è·å–ç‰¹å¾é‡è¦æ€§\ntemp_rf = RandomForestClassifier(n_estimators=500, max_depth=5, random_state=42, )\ntemp_rf.fit(X, y)\n\n# è·å–æœ€é‡è¦çš„10ä¸ªç‰¹å¾çš„åç§°\nN_TOP_FEATURES = 10\nfeature_importances = pd.DataFrame({\n    'feature': X.columns,\n    'importance': temp_rf.feature_importances_\n}).sort_values('importance', ascending=False)\ntop_10_features = feature_importances['feature'].head(N_TOP_FEATURES).tolist()\n\n# åˆ›å»ºåªåŒ…å«è¿™10ä¸ªç‰¹å¾çš„æ–°æ•°æ®é›†\nX_top10 = X[top_10_features]\n\nprint(\"--- æœ€ç»ˆä¼˜åŒ–æµç¨‹ ---\")\nprint(f\"å·²æˆåŠŸç­›é€‰å‡ºæœ€é‡è¦çš„ {N_TOP_FEATURES} ä¸ªç‰¹å¾ç”¨äºæœ€ç»ˆè°ƒä¼˜:\")\nprint(top_10_features)\n\n\n# --- 2. æœ€ç»ˆæ­¥éª¤äºŒï¼šåœ¨æœ€ä½³ç‰¹å¾é›†ä¸Šè¿›è¡Œè´å¶æ–¯ä¼˜åŒ– ---\n# The second step: run Bayesian Optimization on this optimal feature set.\n\nprint(\"\\nç°åœ¨ï¼Œæˆ‘ä»¬åªåœ¨è¿™10ä¸ªç‰¹å¾ä¸Šè¿›è¡Œè´å¶æ–¯ä¼˜åŒ– (Optuna)...\")\n\n# å®šä¹‰ç›®æ ‡å‡½æ•°ï¼Œä¸ä¹‹å‰ç±»ä¼¼ï¼Œä½†è¿™æ¬¡ä½¿ç”¨çš„æ˜¯ç­›é€‰åçš„æ•°æ®\ndef objective_top10(trial):\n    # å®šä¹‰è¶…å‚æ•°æœç´¢ç©ºé—´\n    params = {\n        'n_estimators': trial.suggest_int('n_estimators', 200, 800),\n        'max_depth': trial.suggest_int('max_depth', 3, 10),\n        'min_samples_leaf': trial.suggest_int('min_samples_leaf', 1, 10),\n        'max_features': trial.suggest_categorical('max_features', ['sqrt', 'log2']),\n    }\n    \n    model = RandomForestClassifier(random_state=42, **params)\n    \n    # ï¼ï¼ï¼ å…³é”®ä¸åŒç‚¹ ï¼ï¼ï¼\n    # æ³¨æ„ï¼šæˆ‘ä»¬åœ¨è¿™é‡Œä½¿ç”¨ X_top10ï¼Œè€Œä¸æ˜¯å®Œæ•´çš„ X\n    # CRITICAL DIFFERENCE: We are using X_top10 here, not the full X.\n    score = cross_val_score(model, X_top10, y, cv=5, scoring='roc_auc').mean()\n    \n    return score\n\n# åˆ›å»ºä¸€ä¸ªæ–°çš„ \"ç ”ç©¶\" (Study)\nstudy_top10 = optuna.create_study(direction='maximize', study_name='RF_Top10_Optimization')\n\n# è¿è¡Œä¼˜åŒ–ï¼Œn_trials å¯ä»¥æ ¹æ®éœ€è¦è°ƒæ•´\nstudy_top10.optimize(objective_top10, n_trials=100)\n\n# --- 3. æ‰“å°æœ€ç»ˆä¼˜åŒ–ç»“æœ ---\n# Print the final optimization results\n\nbest_params_top10 = study_top10.best_params\nbest_score_top10 = study_top10.best_value\n\nprint(\"\\nåœ¨Top 10ç‰¹å¾é›†ä¸Šçš„è´å¶æ–¯ä¼˜åŒ–å®Œæˆ!\")\nprint(f\"æ‰¾åˆ°çš„æœ€ä½³è¶…å‚æ•°ç»„åˆ (Best Parameters): \\n{best_params_top10}\")\nprint(f\"\\næœ€ç»ˆæ¨¡å‹çš„æœ€ä½³å¹³å‡ AUC åˆ†æ•°æ˜¯: {best_score_top10:.4f}\")\n\n# --- 4. è®­ç»ƒæœ€ç»ˆçš„ã€æœ€ä¼˜åŒ–çš„æ¨¡å‹ ---\n# Train the final, most optimized model\n\nprint(\"\\næ­£åœ¨ä½¿ç”¨æ‰¾åˆ°çš„æœ€ä½³ç‰¹å¾å’Œæœ€ä½³è¶…å‚æ•°æ¥è®­ç»ƒæœ€ç»ˆæ¨¡å‹...\")\nfinal_model = RandomForestClassifier(random_state=42,  **best_params_top10)\nfinal_model.fit(X_top10, y)\n\nprint(\"æœ€ç»ˆæ¨¡å‹è®­ç»ƒå®Œæˆï¼è¿™ä¸ªæ¨¡å‹æ˜¯æˆ‘ä»¬æ•´ä¸ªåˆ†æè¿‡ç¨‹çš„æœ€ç»ˆæˆæœã€‚\")\n\n```\n\nåŒæ ·è¿è¡Œäº†å¥½å‡ æ¬¡ï¼Œå¾—åˆ°äº†è¾ƒå¥½çš„æ•°æ®ï¼Œ***æ˜¯æœ€ç»ˆæ¨¡å‹çš„æœ€ä½³å¹³å‡ AUC åˆ†æ•°æ˜¯: 0.8044***\n\n***AUC æ¥è¿‘ 0.805 é€šå¸¸æ„å‘³ç€æ¨¡å‹å·²ç»æ•æ‰åˆ°äº†æ•°æ®ä¸­å¤§éƒ¨åˆ†çš„å¯é¢„æµ‹ç»“æ„ã€‚è¿™å°±æ˜¯æˆ‘ä»¬åœ¨æœºå™¨å­¦ä¹ ä¸­å¸¸è¯´çš„â€œæ€§èƒ½ç“¶é¢ˆâ€ï¼šå†æ€ä¹ˆè°ƒå‚ã€é€‰ç‰¹å¾ï¼Œæå‡ç©ºé—´å·²ç»éå¸¸æœ‰é™ï¼Œè¿™æ˜¯æˆ‘ä»¬éšæœºæ£®æ—çš„æé™äº†ï¼Œé™¤éæ¢ä¸€ä¸ªæ›´åŠ é€‚é…è¿™ä¸ªæ•°æ®çš„æœºå™¨å­¦ä¹ æ¨¡å‹ã€‚***\n\n***æ¨¡å‹çš„æ€§èƒ½ä¸Šé™ï¼Œå¾€å¾€ä¸æ˜¯ç”±ç®—æ³•å†³å®šçš„ï¼Œè€Œæ˜¯ç”±æ•°æ®æœ¬èº«çš„å¯é¢„æµ‹æ€§å†³å®šçš„ã€‚ å¦‚æœæ•°æ®ä¸­æ²¡æœ‰æ›´å¤šâ€œå¯è§£é‡Šçš„ä¿¡å·â€ï¼Œå†å¤æ‚çš„æ¨¡å‹ä¹Ÿæ— æ³•å‡­ç©ºåˆ›é€ é¢„æµ‹èƒ½åŠ›ã€‚***\n\n#### 1. æ¦‚å¿µå¼•å…¥ï¼šæ€§èƒ½å¤©èŠ±æ¿ä¸ä¸å¯çº¦å‡è¯¯å·® (Irreducible Error)ğŸ§‰\n\næ€§èƒ½å¤©èŠ±æ¿ï¼ˆPerformance Ceilingï¼‰ã€‚â€\n\n**æ ¸å¿ƒçŸ¥è¯†ç‚¹ï¼š**\\\nåœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œä¸€ä¸ªæ¨¡å‹çš„æ€»è¯¯å·®å¯ä»¥è¢«åˆ†è§£ä¸ºä¸¤éƒ¨åˆ†ï¼š\n\n**æ€»è¯¯å·® = å¯çº¦å‡è¯¯å·® (Reducible Error) + ä¸å¯çº¦å‡è¯¯å·® (Irreducible Error)**\n\n-   **å¯çº¦å‡è¯¯å·®ï¼š** è¿™æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡é€‰æ‹©æ›´å¥½çš„æ¨¡å‹ã€åšç‰¹å¾å·¥ç¨‹ã€è°ƒä¼˜è¶…å‚æ•°æ¥å‡å°‘çš„éƒ¨åˆ†ã€‚æˆ‘ä»¬ä¹‹å‰åšçš„æ‰€æœ‰å·¥ä½œï¼Œéƒ½æ˜¯åœ¨åŠªåŠ›**å°†è¿™éƒ¨åˆ†è¯¯å·®é™åˆ°æœ€ä½**ã€‚\n\n-   **ä¸å¯çº¦å‡è¯¯å·®ï¼š** è¿™æ˜¯æ•°æ®æœ¬èº«å›ºæœ‰çš„ã€æ— æ³•è¢«ä»»ä½•æ¨¡å‹æ¶ˆé™¤çš„â€œå™ªå£°â€æˆ–ä¸ç¡®å®šæ€§ã€‚**è¿™ä¸ªè¯¯å·®å†³å®šäº†æˆ‘ä»¬æ€§èƒ½å¤©èŠ±æ¿çš„é«˜åº¦ã€‚**\n\n-   **æ‰“ä¸ªæ¯”æ–¹ (Analogy):**\\\n    è¿™å°±åƒç”¨éº¦å…‹é£å½•éŸ³ã€‚æˆ‘ä»¬å¯ä»¥ä¹°æ›´å¥½çš„éº¦å…‹é£ã€è°ƒæ•´å½•éŸ³æ£šçš„ç¯å¢ƒæ¥å‡å°‘èƒŒæ™¯å™ªéŸ³ï¼ˆé™ä½**å¯çº¦å‡è¯¯å·®**ï¼‰ã€‚ä½†æ˜¯ï¼Œå£°éŸ³æœ¬èº«çš„ä¸€äº›å¾®å°é¢¤åŠ¨ã€ç©ºæ°”ä¸­çš„éšæœºåˆ†å­è¿åŠ¨æ˜¯æ— æ³•è¢«æ¶ˆé™¤çš„ï¼ˆ**ä¸å¯çº¦å‡è¯¯å·®**ï¼‰ã€‚æˆ‘ä»¬èƒ½åšçš„ï¼Œå°±æ˜¯å°½å¯èƒ½æ¸…æ™°åœ°æ•æ‰åˆ°â€œä¿¡å·â€ï¼Œä½†æˆ‘ä»¬æ— æ³•æ¶ˆé™¤æ‰€æœ‰çš„â€œå™ªå£°â€ã€‚\n\n#### æ•™å­¦æ€»ç»“ï¼šå½“æˆ‘ä»¬è§¦åŠå¤©èŠ±æ¿æ—¶ï¼Œè¯¥åšä»€ä¹ˆğŸ¤–ï¼Ÿ\n\nè¿™æ˜¯æœ€å…³é”®çš„æ•™å­¦éƒ¨åˆ†ã€‚å½“æ¨¡å‹è°ƒä¼˜ä¸å†æœ‰æ•ˆæ—¶ï¼ŒçœŸæ­£çš„æ•°æ®ç§‘å­¦å®¶ä¼šä»ä»¥ä¸‹å‡ ä¸ªæ–¹é¢æ€è€ƒï¼Œè¿™ä¹Ÿæ˜¯æœªæ¥çš„å·¥ä½œæ–¹å‘ï¼š\n\n**è·¯å¾„ Aï¼šè·å–æ›´å¥½çš„æ•°æ® (æ•°æ®ä¸ºä¸­å¿ƒ - The Data-Centric Approach)**\\\nè¿™æ˜¯**æœ€é‡è¦ã€æœ€æœ‰æ•ˆ**çš„è·¯å¾„ã€‚\n\n-   **è¡ŒåŠ¨ï¼š** ä¸é¢†åŸŸä¸“å®¶ï¼ˆç²¾ç¥ç§‘åŒ»ç”Ÿã€å¿ƒç†å­¦å®¶ï¼‰åˆä½œï¼Œè®¨è®ºæ˜¯å¦å¯ä»¥æ”¶é›†æ–°çš„ã€å¯èƒ½ä¸ä¸»è§‚å¹¸ç¦æ„Ÿç›¸å…³çš„æ•°æ®ã€‚æ¯”å¦‚ï¼Œåœ¨ä¸‹ä¸€æ¬¡ç ”ç©¶ä¸­åŠ å…¥â€œç¤¾ä¼šæ”¯æŒé‡è¡¨â€ã€â€œç”Ÿæ´»äº‹ä»¶è®°å½•â€ç­‰ã€‚\n\n-   **ç»“è®ºï¼š** **æå‡æ€§èƒ½å¤©èŠ±æ¿çš„æœ€å¥½æ–¹æ³•ï¼Œæ˜¯ä¸ºæ¨¡å‹æä¾›æ›´é«˜ä¿¡å™ªæ¯”ã€æ›´ä¸°å¯Œä¿¡æ¯çš„æ•°æ®ã€‚**\n\n**è·¯å¾„ Bï¼šå°è¯•å®Œå…¨ä¸åŒçš„æ¨¡å‹ (æ¨¡å‹ä¸ºä¸­å¿ƒ - The Model-Centric Approach)**\n\n-   **è¡ŒåŠ¨ï¼š** æˆ‘ä»¬å·²ç»è¯æ˜äº†éšæœºæ£®æ—ï¼ˆä¸€ç§åŸºäºå†³ç­–æ ‘çš„é›†æˆæ¨¡å‹ï¼‰çš„æé™ã€‚æˆ‘ä»¬å¯ä»¥å°è¯•ç»“æ„å®Œå…¨ä¸åŒçš„æ¨¡å‹ï¼Œæ¯”å¦‚ï¼š\n\n    -   **æ·±åº¦å­¦ä¹ /ç¥ç»ç½‘ç»œ (Deep Learning / Neural Networks):** å¦‚æœæœ‰***è¶³å¤Ÿå¤šçš„æ•°æ®***ï¼Œç¥ç»ç½‘ç»œèƒ½å¤Ÿæ•æ‰åˆ°æ¯”æ ‘æ¨¡å‹æ›´é«˜é˜¶ã€æ›´å¤æ‚çš„éçº¿æ€§å…³ç³»ã€‚\n\n    -   **æ¢¯åº¦æå‡æœº (Gradient Boosting Machines):** æˆ‘ä»¬å¯ä»¥å¯¹ä¹‹å‰æµ‹è¯•è¿‡çš„ XGBoost æˆ– LightGBM æ¨¡å‹è¿›è¡ŒåŒæ ·æ·±å…¥çš„ç‰¹å¾é€‰æ‹©å’Œè´å¶æ–¯ä¼˜åŒ–ï¼Œæœ‰æ—¶å®ƒä»¬åœ¨ç‰¹å®šæ•°æ®é›†ä¸Šçš„è¡¨ç°ä¼šç•¥èƒœäºéšæœºæ£®æ—ã€‚\n\n-   **ç»“è®ºï¼š** æ¢ä¸€ä¸ªæ›´å¼ºå¤§çš„æ¨¡å‹**æœ‰å¯èƒ½**ä¼šç•¥å¾®æå‡æ€§èƒ½ï¼Œä½†è¿™é€šå¸¸æ˜¯åœ¨æ•°æ®è´¨é‡å·²ç»å¾ˆå¥½çš„å‰æä¸‹ã€‚å¦‚æœæ•°æ®æœ¬èº«ä¿¡æ¯é‡æœ‰é™ï¼Œæ¢æ¨¡å‹ä¹Ÿåªæ˜¯â€œé”¦ä¸Šæ·»èŠ±â€ï¼Œè€Œä¸ä¼šæœ‰è´¨çš„é£è·ƒã€‚\n\n------------------------------------------------------------------------\n\n## è®ºæ–‡æ€»ç»“ğŸ¤—\n\nthis is what it is æ²¡ä»€ä¹ˆæ€»ç»“çš„ï¼Œ**æˆ‘ä»¬çš„æœºå™¨å­¦ä¹ å¾—åˆ°äº†åœ¨æˆ‘ä»¬æµ‹é‡çš„æ‰€æœ‰äº‹ç‰©ä¸­ï¼Œå“ªäº›ä¸æ‚£è€…çš„ä¸»è§‚å¹¸ç¦æ„Ÿæœ€å¯†åˆ‡ç›¸å…³ï¼Ÿå³ OCSã€èº¯ä½“åŒ–ã€è®¤çŸ¥å’ŒæŠ‘éƒæ˜¯æœ€é‡è¦çš„é¢„æµ‹å› ç´ ã€‚æˆ‘ä»¬ç¡®å®šäº†ä¸»è¦ç‰¹å¾**\n\n***`è¿™ä¹Ÿæ˜¯å·®ä¸å¤šä½ ä»¬è¦å†™çš„è®ºæ–‡çš„æœºå™¨å­¦ä¹ çš„å¤§æ¦‚æµç¨‹`***\n\n-   ä½†æ˜¯å¦‚æœçœ‹æˆ‘ä»¬çš„å¤ç°è®ºæ–‡ï¼Œä»–ä»¬æ¥ä¸‹æ¥çš„æ­¥éª¤æ˜¯\n\n### Step 1: Network Analysis (ç½‘ç»œåˆ†æ)ğŸ«¥\n\n**â€œä¸ºä»€ä¹ˆâ€ï¼ˆç›®çš„ï¼‰ï¼š**\\\næœºå™¨å­¦ä¹ å‘Šè¯‰æˆ‘ä»¬ï¼Œå¼ºè¿«ç—‡ç—‡çŠ¶ã€èº¯ä½“åŒ–ç—‡çŠ¶ã€æŠ‘éƒç—‡å’Œè®¤çŸ¥æ˜¯æœ€é‡è¦çš„é¢„æµ‹å› ç´ ã€‚ä½†å®ƒå¹¶æ²¡æœ‰å‘Šè¯‰æˆ‘ä»¬å®ƒä»¬æ˜¯å¦‚ä½•ç›¸äº’å…³è”çš„ã€‚å¼ºè¿«ç—‡ç—‡çŠ¶å’Œèº¯ä½“åŒ–ç—‡çŠ¶æ˜¯å¦é«˜åº¦ç›¸å…³ï¼ŸæŠ‘éƒç—‡æ˜¯å¦æ˜¯è¿æ¥ä¸€åˆ‡çš„ä¸­å¿ƒæ¢çº½ï¼Ÿ\n\nç½‘ç»œåˆ†æå¸®åŠ©æˆ‘ä»¬å°†ç—‡çŠ¶çš„â€œç”Ÿæ€ç³»ç»Ÿâ€å¯è§†åŒ–ã€‚å®ƒå°†æ¯ä¸ªå˜é‡ï¼ˆç—‡çŠ¶ã€äººå£ç»Ÿè®¡å› ç´ ï¼‰è§†ä¸ºä¸€ä¸ªâ€œèŠ‚ç‚¹â€ï¼ˆåŸå¸‚ï¼‰ï¼Œå¹¶å°†å®ƒä»¬ä¹‹é—´çš„ç›¸å…³æ€§è§†ä¸ºä¸€æ¡â€œè¾¹â€ï¼ˆé«˜é€Ÿå…¬è·¯ï¼‰ã€‚ç›¸å…³æ€§è¶Šå¼ºï¼Œé«˜é€Ÿå…¬è·¯å°±è¶Šç²—ã€‚\n\nè®ºæ–‡ä¸­çš„å›¾3ï¼‰ï¼š\n\n-   **ç¤¾ç¾¤ï¼ˆç¾¤è½ï¼‰ï¼š** ä»–ä»¬å¯»æ‰¾çš„æ˜¯èŠ‚ç‚¹ä¹‹é—´çš„è¿æ¥æ¯”ä¸ç½‘ç»œå…¶ä»–éƒ¨åˆ†çš„è¿æ¥æ›´ç´§å¯†çš„é›†ç¾¤ã€‚åœ¨è®ºæ–‡ä¸­ï¼Œä»–ä»¬å‘ç°äº†ä¸€ä¸ªå…³é”®æ¨¡å¼ï¼š\n\n    -   **ç¤¾åŒº 1ï¼š** ä¸»è§‚å¹¸ç¦æ„Ÿï¼ˆSWBï¼‰ã€å¼ºè¿«ç—‡\n\n    -   **ç¤¾åŒº 2ï¼š** ç²¾ç¥ç—…ç—‡çŠ¶ï¼ˆé˜³æ€§ã€é˜´æ€§ï¼‰ã€è®¤çŸ¥ç¼ºé™·å’Œç¤¾ä¼šå¿ƒç†åŠŸèƒ½ (PSP) å½¢æˆäº†å¦ä¸€ä¸ªä¸åŒçš„é›†ç¾¤ã€‚\n\n    -   å¹¸ç¦æ„Ÿçš„å†…åœ¨ä½“éªŒä¸å¼ºè¿«ç—‡å’Œèº¯ä½“ç³»ç»Ÿæ›´å¯†åˆ‡ç›¸å…³\n\n-   **ä¸­å¿ƒæ€§ï¼š** è¯¥æŒ‡æ ‡ç”¨äºè¯†åˆ«ç½‘ç»œä¸­æœ€å…·â€œå½±å“åŠ›â€çš„èŠ‚ç‚¹ã€‚è®ºæ–‡æŒ‡å‡ºï¼Œ **æŠ‘éƒç—‡**çš„â€œä¸­ä»‹ä¸­å¿ƒæ€§â€æœ€é«˜ã€‚\n\n    -   **è¿™æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ** è¿™æ„å‘³ç€æŠ‘éƒç—‡æ˜¯è¿æ¥ä¸¤ä¸ªç¾¤ä½“çš„å…³é”®**æ¡¥æ¢** ã€‚è¦ä»â€œç²¾ç¥ç—…ç—‡çŠ¶â€ç¾¤ä½“èµ°å‘â€œä¸»è§‚å¹¸ç¦æ„Ÿâ€ç¾¤ä½“ï¼Œé€šå¸¸éœ€è¦ç»è¿‡â€œæŠ‘éƒç—‡â€è¿™ä¸€ç¯èŠ‚ã€‚è¿™è¡¨æ˜æŠ‘éƒç—‡èµ·ç€å…³é”®çš„ä¸­ä»‹ä½œç”¨ã€‚\n\nè¿™æ˜¯ä¸€ç§å¯è§†åŒ–å’Œæ¢ç´¢æ€§çš„å·¥å…·ã€‚å®ƒä»æˆ‘ä»¬çš„æœºå™¨å­¦ä¹ æ¨¡å‹ä¸­è·å–é‡è¦ç‰¹å¾åˆ—è¡¨ï¼Œå¹¶å°†å…¶è½¬åŒ–ä¸ºåœ°å›¾ã€‚è¿™å¼ åœ°å›¾å‘æˆ‘ä»¬å±•ç¤ºäº†å¤æ‚ç—‡çŠ¶ç½‘ç»œçš„ç»“æ„å’Œå…³é”®å› ç´ ï¼Œè¿™è®©æˆ‘ä»¬å‡è®¾æŠ‘éƒç—‡æ˜¯ä¸€ä¸ªå…³é”®çš„ä¸­ä»‹å› ç´ ã€‚\n\n### Step 2: Structural Equation Modeling (SEM) (ç»“æ„æ–¹ç¨‹æ¨¡å‹)ğŸ”\n\næ–¹å‘æˆ–å› æœå…³ç³»ã€‚å®ƒæ˜¾ç¤ºäº†ä¸¤åº§åŸå¸‚ä¹‹é—´çš„é«˜é€Ÿå…¬è·¯ï¼Œä½†æ²¡æœ‰æ˜¾ç¤ºäº¤é€šèµ°å‘\n\nçœ‹çœ‹è®ºæ–‡ä¸­çš„å›¾ 4ã€‚è¿™æ˜¯ä»–ä»¬çš„ SEM åˆ†æç»“æœã€‚å®ƒå°±åƒä¸€ä¸ªæµç¨‹å›¾ï¼Œå±•ç¤ºäº†å½±å“åŠ›çš„æµåŠ¨ã€‚\n\n-   **ç›´æ¥æ•ˆåº”ï¼ˆç›´æ¥æ•ˆåº”ï¼‰ï¼š** ä»ä¸€ä¸ªå˜é‡åˆ°å¦ä¸€ä¸ªå˜é‡çš„ç›´çº¿ç®­å¤´ã€‚\n\n    -   è®ºæ–‡å‘ç°ï¼Œ **å¼ºè¿«æ€§è¡Œä¸ºå¯¹ä¸»è§‚å¹¸ç¦æ„Ÿï¼ˆSWBï¼‰çš„ç›´æ¥è´Ÿé¢å½±å“æœ€ä¸ºå¼ºçƒˆ** ï¼ˆè§ç²—çº¢è‰²ç®­å¤´ï¼Œç³»æ•°ä¸º-0.59ï¼‰ã€‚è¿™æ˜¯è®ºæ–‡æœ€é‡è¦çš„å‘ç°ï¼šé«˜å¼ºè¿«æ€§è¡Œä¸ºä¼šç›´æ¥æ‘§æ¯æ‚£è€…çš„å¹¸ç¦æ„Ÿã€‚\n\n-   **é—´æ¥æ•ˆåº”ï¼š** è‡³å°‘ç»è¿‡ä¸€ä¸ªå…¶ä»–å˜é‡çš„è·¯å¾„ã€‚\n\n    -   è®ºæ–‡è¯å®äº†æŠ‘éƒç—‡çš„â€œæ¡¥æ¢â€ä½œç”¨ã€‚ä¾‹å¦‚ï¼Œé˜´æ€§ç—‡çŠ¶æœ‰ä¸€ä¸ªç®­å¤´æŒ‡å‘æŠ‘éƒç—‡ï¼ŒæŠ‘éƒç—‡ä¹Ÿæœ‰ä¸€ä¸ªç®­å¤´æŒ‡å‘ä¸»è§‚å¹¸ç¦æ„Ÿã€‚è¿™æ˜¯ä¸€æ¡**é—´æ¥è·¯å¾„** ã€‚è¿™æ„å‘³ç€é˜´æ€§ç—‡çŠ¶éƒ¨åˆ†åœ°é€šè¿‡å¢åŠ æŠ‘éƒæ¥æ¶åŒ–ä¸»è§‚å¹¸ç¦æ„Ÿ ã€‚\n\n    -   OCS è¿˜é€šè¿‡æŠ‘éƒç—‡å¯¹ SWB äº§ç”Ÿé—´æ¥å½±å“ ã€‚\n\nSEM æ˜¯ä¸€ç§éªŒè¯æ€§å·¥å…·ï¼Œæ˜¯åˆ†æçš„æœ€ç»ˆæ­¥éª¤ï¼Œä¹Ÿæ˜¯æœ€æœ‰åŠ›çš„ä¸€æ­¥ã€‚å®ƒè¶…è¶Šäº†â€œä»€ä¹ˆæ˜¯é‡è¦çš„â€ï¼ˆMLï¼‰å’Œâ€œå®ƒä»¬å¦‚ä½•å…³è”â€ï¼ˆç½‘ç»œåˆ†æï¼‰çš„èŒƒç•´ï¼Œä»è€Œæ£€éªŒäº†å…³äºâ€œä»€ä¹ˆå¯¼è‡´ä»€ä¹ˆâ€çš„ç‰¹å®šç†è®ºã€‚SEM ç»“æœä¸ºæœ¬æ–‡çš„ä¸»è¦ç»“è®ºæä¾›äº†æœ€æœ‰åŠ›çš„è¯æ®ï¼šç®¡ç† OCS å¯¹äºæ”¹å–„ç²¾ç¥åˆ†è£‚ç—‡æ‚£è€…çš„ä¸»è§‚å¹¸ç¦æ„Ÿè‡³å…³é‡è¦ï¼Œè¿™æ—¢æ˜¯å› ä¸ºå®ƒå¼ºå¤§çš„ç›´æ¥å½±å“ï¼Œä¹Ÿæ˜¯å› ä¸ºå®ƒé€šè¿‡æŠ‘éƒç—‡äº§ç”Ÿçš„é—´æ¥å½±å“ã€‚\n\n# æˆ‘æ»´ä»»åŠ¡å®Œæˆäº†ğŸ›«","srcMarkdownNoYaml":"\n\n# SEMåŠ MLåˆ†æ ğŸ«¥\n\n------------------------------------------------------------------------\n\n***è¦å…·ä½“çŸ¥é“ä¸ºä»€ä¹ˆè¦ç»“åˆï¼Œå¯ä»¥å‚è€ƒæ–‡çŒ® [æ··åˆäººå·¥ç¥ç»ç½‘ç»œä¸ç»“æ„æ–¹ç¨‹æ¨¡å‹æŠ€æœ¯ï¼šç»¼è¿°](https://link.springer.com/article/10.1007/s40747-021-00503-w)Hybrid artificial neural network and structural equation modelling techniques: a survey***\n\n## ä¸ºä»€ä¹ˆè¦ç»“åˆæœºå™¨å­¦ä¹ ï¼ˆMLï¼‰ä¸ç»“æ„æ–¹ç¨‹æ¨¡å‹ï¼ˆSEMï¼‰\n\n### âœ¨ ç†è®ºä¸å®è·µçš„èåˆï¼šSEM + ML çš„ä¼˜åŠ¿\n\nç»“æ„æ–¹ç¨‹æ¨¡å‹ï¼ˆSEMï¼‰æ˜¯ä¸€ç§å¼ºå¤§çš„å› æœå»ºæ¨¡å·¥å…·ï¼Œèƒ½å¤ŸåŒæ—¶å¤„ç†æµ‹é‡æ¨¡å‹ï¼ˆæ½œå˜é‡ï¼‰å’Œè·¯å¾„æ¨¡å‹ï¼ˆå˜é‡é—´å…³ç³»ï¼‰ã€‚ä½†åœ¨å®é™…ç ”ç©¶ä¸­ï¼Œå°¤å…¶æ˜¯é¢å¯¹é«˜ç»´æ•°æ®(å°±æ˜¯å˜é‡å¤š)ã€å¤æ‚å˜é‡ç»“æ„æˆ–éçº¿æ€§å…³ç³»æ—¶ï¼ŒSEMä¹Ÿé¢ä¸´æŒ‘æˆ˜ï¼š\n\n-   **å˜é‡ç­›é€‰å›°éš¾**ï¼šä¼ ç»ŸSEMä¾èµ–ç†è®ºå‡è®¾ï¼Œå˜é‡é€‰æ‹©ä¸»è§‚æ€§å¼º(ä¸€èˆ¬è¦å‚è€ƒç¤¾ä¼šç§‘å­¦æ–‡çŒ®ï¼Œå¹¶ä¸”è¿›è¡Œå‡è®¾ï¼Œéº»äº†)ï¼›\n\n-   **æ¨¡å‹æ‹Ÿåˆå—é™**ï¼šå½“å˜é‡æ•°é‡å¤šã€å…³ç³»å¤æ‚æ—¶ï¼ŒSEMæ¨¡å‹å®¹æ˜“è¿‡æ‹Ÿåˆæˆ–æ‹Ÿåˆä¸ä½³(è¿‡æ‹Ÿåˆå’Œæ¬ æ‹Ÿåˆ)ï¼›\n\n-   **é¢„æµ‹èƒ½åŠ›æœ‰é™**ï¼šSEMæ›´åå‘è§£é‡Šæ€§è€Œéé¢„æµ‹æ€§ã€‚\n\nè€Œæœºå™¨å­¦ä¹ ï¼ˆMLï¼‰æ­£å¥½å¯ä»¥è¡¥è¶³è¿™äº›çŸ­æ¿ï¼š\n\n| åŠŸèƒ½       | SEM         | ML                |\n|------------|-------------|-------------------|\n| å› æœæ¨ç†   | âœ… å¼º       | âŒ å¼±ï¼ˆä½†å¯è¾…åŠ©ï¼‰ |\n| æ½œå˜é‡å»ºæ¨¡ | âœ… æ”¯æŒ     | âŒ ä¸ç›´æ¥æ”¯æŒ     |\n| ç‰¹å¾ç­›é€‰   | âŒ ä¾èµ–ç†è®º | âœ… æ•°æ®é©±åŠ¨       |\n| éçº¿æ€§å»ºæ¨¡ | âŒ æœ‰é™     | âœ… å¼ºå¤§           |\n| é¢„æµ‹èƒ½åŠ›   | âŒ å¼±       | âœ… å¼º             |\n\nå› æ­¤ï¼Œå°†MLä¸SEMç»“åˆï¼Œå¯ä»¥å®ç°ï¼š\n\n-   **æ•°æ®é©±åŠ¨çš„å˜é‡ç­›é€‰**ï¼ˆå¦‚ç”¨éšæœºæ£®æ—æˆ–SHAPå€¼æ‰¾å‡ºæœ€é‡è¦çš„é¢„æµ‹å› å­(ä¸€èˆ¬æ¥è¯´å¦‚æœå˜é‡è¾ƒå¤šçš„æ—¶å€™ï¼Œä¸€èˆ¬æ˜¯ä¸é™ç»´çš„ï¼Œè€Œæ˜¯ç­›é€‰å˜é‡çš„ï¼‰ï¼›\n\n-   **æå‡æ¨¡å‹è§£é‡ŠåŠ›ä¸é¢„æµ‹åŠ›**ï¼ˆå…ˆç”¨MLæ‰¾å‡º**å…³é”®å˜é‡**ï¼Œå†ç”¨SEMå»ºæ¨¡è·¯å¾„ï¼‰ï¼›\n\n-   **å¢å¼ºæ¨¡å‹ç¨³å¥æ€§**ï¼ˆMLå¯ç”¨äº**éªŒè¯**SEMæ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ï¼‰ï¼›\n\n-   **æé«˜ç ”ç©¶å½±å“åŠ›**ï¼ˆç»“åˆæ–¹æ³•æ›´å‰æ²¿ï¼Œæ˜“å‘è¡¨åœ¨é«˜å½±å“å› å­æœŸåˆŠï¼‰ã€‚\n\n### ğŸ“ˆ æ–‡çŒ®æ”¯æŒï¼šç»“åˆMLä¸SEMçš„ç ”ç©¶è¶Šæ¥è¶Šå¤šï¼Œå½±å“å› å­ä¹Ÿåœ¨ä¸Šå‡\n\nä»¥ä¸‹æ˜¯æä¾›çš„å‡ ç¯‡ä»£è¡¨æ€§æ–‡çŒ®ï¼Œå±•ç¤ºäº†ML+SEMçš„å®é™…åº”ç”¨ä¸å‘è¡¨æ½œåŠ›ï¼š\n\n1.  âœ… **å¤ç°çš„è®ºæ–‡**ï¼š PMC12236327\n\n    -   ç»“åˆéšæœºæ£®æ—ä¸SEMï¼Œè¯†åˆ«å½±å“ç²¾ç¥åˆ†è£‚ç—‡æ‚£è€…ä¸»è§‚å¹¸ç¦æ„Ÿçš„å…³é”®å› ç´ ã€‚\n\n    -   é€šè¿‡MLç­›é€‰å˜é‡ï¼Œå†ç”¨lavaanæ„å»ºè·¯å¾„æ¨¡å‹ï¼Œå®ç°å› æœè§£é‡Šä¸é¢„æµ‹å¹¶é‡ã€‚\n\n    -   å‘è¡¨åœ¨ã€ŠTranslational Psychiatryã€‹ï¼ŒIF â‰ˆ 7.9ã€‚\n\n2.  ğŸ“± **æ™ºèƒ½ç©¿æˆ´è®¾å¤‡é‡‡çº³ç ”ç©¶**ï¼š Bou Nassif et al. (2022)\n\n    -   ä½¿ç”¨PLS-SEMä¸MLå¯¹æ™ºèƒ½æ‰‹è¡¨é‡‡çº³æ„å›¾è¿›è¡Œå»ºæ¨¡ã€‚\n\n    -   MLæ­ç¤ºâ€œç”¨æˆ·æ»¡æ„åº¦â€æ˜¯æœ€å…³é”®é¢„æµ‹å› å­ï¼ŒSEMéªŒè¯å…¶è·¯å¾„å…³ç³»ã€‚\n\n    -   å‘è¡¨åœ¨ã€ŠHeliyonã€‹ï¼ŒIF â‰ˆ 4.0ã€‚\n\n3.  ğŸ§  **æ¶ˆè´¹è€…å¿ƒç†ä¸è¡Œä¸ºç ”ç©¶**ï¼š ScienceDirect 2023è®ºæ–‡\n\n    -   ç”¨MLç­›é€‰å½±å“æ¶ˆè´¹è€…ä¿¡ä»»çš„å˜é‡ï¼Œå†ç”¨SEMå»ºæ¨¡ä¿¡ä»»å½¢æˆæœºåˆ¶ã€‚\n\n    -   å‘è¡¨åœ¨ã€ŠJournal of Business Researchã€‹ï¼ŒIF â‰ˆ 10.0ã€‚\n\n4.  ğŸ§¬ **å¥åº·è¡Œä¸ºé¢„æµ‹ç ”ç©¶**ï¼š ScienceDirect 2024è®ºæ–‡\n\n    -   ç»“åˆMLä¸SEMé¢„æµ‹å¥åº·è¡Œä¸ºé‡‡çº³ï¼Œå¼ºè°ƒæ•°æ®é©±åŠ¨ä¸ç†è®ºå»ºæ¨¡çš„èåˆã€‚\n\n    -   å‘è¡¨åœ¨ã€ŠPreventive Medicine Reportsã€‹ï¼ŒIF â‰ˆ 3.5ã€‚\n\n------------------------------------------------------------------------\n\n## ä»€ä¹ˆæ˜¯æœºå™¨å­¦ä¹ ğŸ«¤\n\nåœ¨æ­£å¼è¿›å…¥æœºå™¨å­¦ä¹ ï¼ˆMachine Learning, MLï¼‰ï¼‹ç»“æ„æ–¹ç¨‹æ¨¡å‹ï¼ˆSEMï¼‰çš„æ•´åˆåº”ç”¨ä¹‹å‰ï¼Œé¦–å…ˆè¦è®©å¤§å®¶å¯¹â€œæœºå™¨å­¦ä¹ â€è¿™ä¸ªæ¦‚å¿µæœ‰ä¸€ä¸ªç›´è§‚çš„ç†è§£ã€‚ä¸å¿…è¿‡åˆ†çº ç»“å¤æ‚çš„æ•°å­¦å…¬å¼ï¼Œè€Œè¦æŠ“ä½å®ƒçš„æ ¸å¿ƒæ€æƒ³å’Œç ”ç©¶æµç¨‹ã€‚\n\n### 2.1 æœºå™¨å­¦ä¹ çš„å®šä¹‰ğŸ¤¤\n\næœºå™¨å­¦ä¹ æ˜¯ä¸€ç§***è®©è®¡ç®—æœºé€šè¿‡â€œæ ·æœ¬æ•°æ®â€è‡ªè¡Œå‘ç°è§„å¾‹***ï¼Œ***å¹¶å°†è¿™äº›è§„å¾‹ç”¨äºâ€œé¢„æµ‹â€æˆ–â€œå†³ç­–â€çš„æŠ€æœ¯ã€‚***\\\n- å®ƒä¸åƒä¼ ç»Ÿç»Ÿè®¡å­¦é‚£æ ·å¼ºè°ƒæ•´ä½“å‡è®¾æ£€éªŒå’Œå‚æ•°ä¼°è®¡ï¼Œæ›´æ³¨é‡â€œä»æ•°æ®ä¸­è‡ªåŠ¨å­¦ä¹ â€ã€‚\\\n- ML æ—¨åœ¨ç”¨å·²æœ‰æ•°æ®è®­ç»ƒä¸€ä¸ªæ¨¡å‹ï¼Œè®©æ¨¡å‹åœ¨æ–°æ•°æ®ä¸Šä¹Ÿèƒ½è¡¨ç°å‡ºè‰¯å¥½çš„é¢„æµ‹æˆ–åˆ†ç±»èƒ½åŠ›ã€‚\n\n***è¿™ä¹Ÿè®©æœºå™¨å­¦ä¹ æ— æ³•ç”¨æ•°å­¦å…¬å¼å’Œå› æœå…³ç³»æ¥çŸ¥é“ç”µè„‘æ˜¯æ€ä¹ˆæƒ³çš„ï¼Œå½¢æˆäº†æ‰€è°“çš„é»‘åŒ£å­ï¼Œè§£é‡Šæ€§å¤ªå·®ï¼Œä½†æ˜¯ç”¨æ¥é¢„æµ‹å°±æ²¡æ¯›ç—…***\n\n### 2.2 ML ä¸ä¼ ç»Ÿç»Ÿè®¡æ–¹æ³•çš„å·®å¼‚ğŸŒ®\n\n-   ç›®æ ‡ä¸åŒ\n    -   ç»Ÿè®¡å­¦ï¼šåé‡è§£é‡Šæ€§ï¼Œè§£æå˜é‡é—´çš„å› æœæˆ–å…³è”ï¼›\\\n    -   æœºå™¨å­¦ä¹ ï¼šåé‡é¢„æµ‹æ€§ï¼Œè¿½æ±‚æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ï¼Œå³ç»™æˆ‘æ•°æ®æˆ‘å¯ä»¥é¢„æµ‹å‡ºå¤§æ¦‚çš„ï¼Œç¬¦åˆä¹‹å‰æ•°æ®çš„ç­”æ¡ˆã€‚\n-   æ¨¡å‹å‡è®¾\n    -   ç»Ÿè®¡æ¨¡å‹ï¼šé€šå¸¸è¦æ±‚æ»¡è¶³æ­£æ€æ€§ã€çº¿æ€§å…³ç³»ç­‰ä¸¥æ ¼å‡è®¾ï¼›\\\n    -   ML æ¨¡å‹ï¼šå¯¹æ•°æ®åˆ†å¸ƒå’Œå…³ç³»çš„å‡è®¾æ›´å¼±ï¼Œ***å¯ä»¥å¤„ç†éçº¿æ€§ã€é«˜ç»´åº¦æ•°æ®***ã€‚\n-   å…³æ³¨ç‚¹\n    -   ç»Ÿè®¡æ–¹æ³•ï¼šä¼°è®¡å‚æ•°ã€æ˜¾è‘—æ€§æ£€éªŒã€ç½®ä¿¡åŒºé—´ï¼›\\\n    -   ML æ–¹æ³•ï¼š***æ¨¡å‹é€‰æ‹©ã€äº¤å‰éªŒè¯ã€è¿‡æ‹Ÿåˆæ§åˆ¶ã€é¢„æµ‹è¯¯å·®***ã€‚\n\n### 2.3 æœºå™¨å­¦ä¹ çš„ä¸»è¦ç±»å‹ğŸ¤–\n\n1.  **ç›‘ç£å­¦ä¹ ï¼ˆSupervised Learningï¼‰**\n    -   æœ‰â€œæ ‡ç­¾â€çš„æ•°æ®ï¼ˆä¾‹å¦‚ï¼šæ‚£è€…æœ‰/æ— å‹åŠ›æ€§æŸä¼¤ï¼‰ã€‚\\\n    -   å¸¸è§ç®—æ³•ï¼šé€»è¾‘å›å½’ã€å†³ç­–æ ‘ã€éšæœºæ£®æ—ã€æ”¯æŒå‘é‡æœºã€ç¥ç»ç½‘ç»œç­‰ã€‚\\\n    -   æ ¸å¿ƒä»»åŠ¡ï¼šåˆ†ç±»ï¼ˆClassificationï¼‰å’Œå›å½’ï¼ˆRegressionï¼‰ã€‚\n2.  **æ— ç›‘ç£å­¦ä¹ ï¼ˆUnsupervised Learningï¼‰**\n    -   æ— æ ‡ç­¾æ•°æ®ã€‚\\\n    -   å¸¸è§ç®—æ³•ï¼šèšç±»ï¼ˆK-meansã€å±‚æ¬¡èšç±»ï¼‰ã€é™ç»´ï¼ˆPCAã€t-SNEï¼‰ã€‚\\\n    -   æ ¸å¿ƒä»»åŠ¡ï¼šå‘ç°æ•°æ®çš„å†…åœ¨ç»“æ„ã€åˆ†ç¾¤ã€ç‰¹å¾é™ç»´ã€‚\n3.  **å¼ºåŒ–å­¦ä¹ ï¼ˆReinforcement Learningï¼‰**\n    -   é€šè¿‡â€œè¯•é”™â€ä¸ç¯å¢ƒäº’åŠ¨æ¥å­¦ä¹ æœ€ä¼˜ç­–ç•¥ã€‚\\\n    -   åœ¨æŠ¤ç†ç ”ç©¶ä¸­åº”ç”¨ç›¸å¯¹å°‘ï¼Œå¯ç”¨äºä¼˜åŒ–æŠ¤ç†è·¯å¾„æˆ–èµ„æºè°ƒåº¦ã€‚\n\n### 2.4 æœºå™¨å­¦ä¹ ç ”ç©¶æµç¨‹ğŸ›«\n\n1.  **æ•°æ®å‡†å¤‡ä¸æ¸…æ´—**\n    -   æ±‡æ€»ä¸´åºŠæŒ‡æ ‡ã€é—®å·é‡è¡¨ã€ç”µå­å¥åº·è®°å½•ç­‰ï¼›\\\n    -   å¤„ç†ç¼ºå¤±å€¼ã€å¼‚å¸¸å€¼ã€åˆ†ç±»å˜é‡ç¼–ç ã€‚\n2.  **ç‰¹å¾å·¥ç¨‹**\n    -   é€‰æ‹©æˆ–æ„é€ ä¸ç ”ç©¶ç›®æ ‡æœ€ç›¸å…³çš„å˜é‡ï¼ˆç‰¹å¾ï¼‰å³æŒ‘é€‰é‡è¦çš„ç‰¹å¾å˜é‡ï¼Œè¿‡æ»¤ä¸éœ€è¦çš„å˜é‡ï¼›\\\n    -   å½’ä¸€åŒ–ã€æ ‡å‡†åŒ–ã€one-hot ç¼–ç (ç‹¬çƒ­ç¼–ç )ç­‰ã€‚\n3.  **æ¨¡å‹è®­ç»ƒä¸ä¼˜åŒ–**\n    -   åœ¨â€œè®­ç»ƒé›†â€ä¸Šè®­ç»ƒæ¨¡å‹ï¼›\\\n    -   é€šè¿‡äº¤å‰éªŒè¯ï¼ˆCross-Validationï¼‰é€‰æ‹©è¶…å‚æ•°ï¼Œ**é˜²æ­¢è¿‡æ‹Ÿåˆ**(è¿‡æ‹Ÿåˆå³æ˜¯å¯¹æ¨¡å‹æ¥è¯´ï¼Œå­¦ä¹ å¤ªå¤šä¸é‡è¦çš„ç‰¹å¾ï¼Œæ¯”å¦‚æˆ‘è®­ç»ƒäº†ä¸€ä¸ªè¯†åˆ«å­¦é•¿è¿˜æ˜¯å­¦å§çš„æ¨¡å‹ï¼Œä½†æ˜¯æ¨¡å‹å­¦ä¹ åˆ°äº†å‡ ä¸ªå¥³è£…çš„å­¦é•¿ï¼Œæœ¬æ¥å¥³è£…è¿™æ˜¯å‡ ä¸ªäººçš„ç‰¹æ®Šç™–å¥½ï¼Œä½†æ˜¯æ¨¡å‹è®¤ä¸ºå¥³è£…çš„éƒ½æ˜¯å­¦é•¿ï¼Œè¿™æ‰¯ä¸æ‰¯ï¼‰ã€‚\n4.  **æ¨¡å‹è¯„ä¼°**\n    -   ***åœ¨â€œæµ‹è¯•é›†â€æˆ–â€œç•™å‡ºæ•°æ®â€ä¸Šè¯„ä¼°é¢„æµ‹æ€§èƒ½***ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæœºå™¨å­¦ä¹ éƒ½è¦åˆ†æˆè®­ç»ƒé›†å’ŒéªŒè¯é›†ï¼Œè¦ä¹ˆ7/3,è¦ä¹ˆ8/2ç­‰ç­‰ï¼ˆåƒä¸‡åˆ«è€å°èªæ˜ï¼Œè§‰å¾—æ•°æ®ä¸å¤Ÿå¤šï¼Œè¿˜è¦æ‹†åˆ†ï¼Œè€æ»‘å¤´æŠŠæ‰€æœ‰æ•°æ®éƒ½æ‹¿å»è®­ç»ƒï¼Œç„¶åå†æ‹¿å…¶ä¸­ä¸€éƒ¨åˆ†æ¥é¢„æµ‹ï¼Œå› ä¸ºæ¨¡å‹æœ‰è®°å¿†çš„ï¼Œä½ é¢„æµ‹è®­ç»ƒè¿‡çš„æ•°æ®ï¼Œè‚¯å®šå‡†ç¡®ç‡æ˜¯ç™¾åˆ†ç™¾ï¼Œå°±å¥½åƒä½ æ˜æ˜çŸ¥é“æ˜å¤©çš„å¤©æ°”ï¼Œé‚£ä¸ºä»€ä¹ˆè¦æ ¹æ®ä¹‹å‰çš„æ•°æ®æ¨æµ‹å‘¢ï¼‰ï¼ˆå¦‚ AUCã€å‡†ç¡®ç‡ã€RMSEï¼‰ï¼›\\\n    -   æ¯”è¾ƒä¸åŒç®—æ³•çš„ä¼˜åŠ£ã€‚\n5.  **æ¨¡å‹è§£é‡Šä¸åº”ç”¨**\n    -   ä½¿ç”¨ SHAPã€LIME ç­‰æ–¹æ³•**è§£é‡Šæ¨¡å‹**\n\n        å®ƒä»¬æ˜¯ä¸¤ç§å¸¸ç”¨çš„â€œæ¨¡å‹è§£é‡Šå·¥å…·â€ï¼Œå¯ä»¥å‘Šè¯‰æˆ‘ä»¬ï¼š**å“ªäº›å˜é‡å¯¹æ¨¡å‹é¢„æµ‹æœ€é‡è¦ï¼Œä»¥åŠå®ƒä»¬çš„å½±å“æ–¹å‘**\n\n------------------------------------------------------------------------\n\n# å¤ç°ä¸€ç¯‡è®ºæ–‡ğŸ¤–\n\n**`æœ€å¥½å­¦ä¹ çš„æ–¹æ³•å°±æ˜¯çœ‹ç›¸å…³è®ºæ–‡ï¼Œç„¶åå­¦ä¹ è®ºæ–‡çŸ¥è¯†ï¼Œç„¶åå¤ç°å­¦ä¹ ï¼Œæ‰€ä»¥å•¥ä¹Ÿä¸è¯´äº†ï¼Œç›´æ¥çœŸåˆ€çœŸæªå¼€å¹²å°±å®Œäº†`**\n\n#### Replicating Research on Subjective Well-Being in Schizophrenia: A Guide to Generating Synthetic Data for SEM and Machine Learning ç²¾ç¥åˆ†è£‚ç—‡æ‚£è€…ä¸»è§‚å¹¸ç¦æ„Ÿç ”ç©¶ï¼šSEM å’Œæœºå™¨å­¦ä¹ åˆæˆæ•°æ®ç”ŸæˆæŒ‡å—\n\n#### [è®ºæ–‡é“¾æ¥](https://pmc.ncbi.nlm.nih.gov/articles/PMC12236327/#s5) 2024 Sep 7 ; 51(4):1118â€“1133. doi: 10.1093/schbul/sbae156 - IF=7.9(æˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆè¿™ç§æ–‡ç« æœ‰7åˆ†ï¼Œåšç”Ÿä¿¡ç´¯æ­»ç´¯æ´»è¿˜æ‹¿ä¸åˆ°5åˆ†ï¼Œåæ§½ä¸€ä¸‹ï¼Œéº»äº†ğŸ¥¶ï¼‰\n\n***ï¼ç°åœ¨æˆ‘ä¸ä»¥ç¤¾ä¼šç§‘å­¦çš„è§’åº¦è§£æè¿™ç¯‡æ–‡ç« ï¼Œåªç”¨ç»Ÿè®¡å­¦å’Œä»£ç æ¥è§£æå¦‚ä½•å¤„ç†***\n\nå› ä¸ºæˆ‘ç°åœ¨æ²¡æœ‰ç›¸å…³çš„æ•°æ®ï¼Œæ‰€ä»¥æˆ‘åªèƒ½ç”¨ä»£ç æ¨¡æ‹Ÿå’Œæ–‡ç« å·®ä¸å¤šçš„æ•°æ®\n\n-   **è¡¨ 1ï¼šæœºå™¨å­¦ä¹ æ¨¡å‹ä¸­åŒ…å«çš„ç‹¬ç«‹å˜é‡åˆ—è¡¨ï¼š** è¯¥è¡¨æ¦‚è¿°äº†åˆ†æä¸­ä½¿ç”¨çš„æ‰€æœ‰å˜é‡ï¼ŒåŒ…æ‹¬ç¤¾ä¼šäººå£å› ç´ ï¼ˆå¹´é¾„ã€æ€§åˆ«ã€æ•™è‚²ã€èŒä¸šï¼‰ã€ç–¾ç—…ç›¸å…³å› ç´ ï¼ˆç–¾ç—…æŒç»­æ—¶é—´ï¼‰å’Œå„ç§ä¸´åºŠæµ‹é‡ã€‚\n\n-   **è¡¨ 2ï¼šæ ·æœ¬ç‰¹å¾ï¼š**æä¾›äº† 637 åæ‚£è€…åŸå§‹æ•°æ®é›†ä¸­å˜é‡çš„æè¿°æ€§ç»Ÿè®¡æ•°æ®ã€‚å®ƒåŒ…æ‹¬è¿ç»­å˜é‡çš„å¹³å‡å€¼ã€æ ‡å‡†å·®å’ŒèŒƒå›´ï¼Œä»¥åŠåˆ†ç±»å˜é‡çš„é¢‘ç‡ã€‚\n\n-   **å›¾ 3ï¼šç½‘ç»œæ¨¡å‹å’Œä¸­å¿ƒæ€§æŒ‡æ ‡ï¼š**å±•ç¤ºäº†ä¸åŒå˜é‡ä¹‹é—´çš„ç›¸å…³æ€§ã€‚è¿æ¥åŠå…¶ç²—ç»†è¡¨ç¤ºå…³ç³»çš„å¼ºåº¦ï¼Œè¿™åº”è¯¥åæ˜ åœ¨åˆæˆæ•°æ®çš„ç›¸å…³çŸ©é˜µä¸­ã€‚\n\n-   **å›¾ 4ï¼šç»“æ„æ–¹ç¨‹æ¨¡å‹ï¼ˆSEMï¼‰åˆ†æï¼š** è¯¥å›¾æ¯”ç½‘ç»œåˆ†ææ›´è¿›ä¸€æ­¥ï¼Œæ­ç¤ºäº†å˜é‡ä¹‹é—´çš„å› æœè·¯å¾„å’Œæ•ˆåº”æ–¹å‘ã€‚è·¯å¾„ç³»æ•°é‡åŒ–äº†è¿™äº›å…³ç³»çš„å¼ºåº¦å’Œæ–¹å‘ã€‚\n\n#### ä½¿ç”¨ Python ç”Ÿæˆåˆæˆæ•°æ®\n\nä»¥ä¸‹ Python ä»£ç æ¼”ç¤ºäº†å¦‚ä½•ç”Ÿæˆä¸€ä¸ªä¸è®ºæ–‡ä¸­æè¿°çš„ç‰¹å¾è¿‘ä¼¼çš„åˆæˆæ•°æ®é›†ã€‚æ­¤ä»£ç ä½¿ç”¨ numpy å’Œ pandas åº“åˆ›å»ºä¸€ä¸ªæ•°æ®æ¡†ï¼Œå…¶ä¸­åŒ…å«ä¸åŸå§‹ç ”ç©¶ä¸­çš„å˜é‡å…·æœ‰ç›¸ä¼¼ç»Ÿè®¡ç‰¹æ€§å’Œç›¸å…³æ€§çš„å˜é‡ã€‚å˜é‡ä¸ç”¨Chinese\n\n```{python}\n#| echo: true\n# å¯¼å…¥æ‰€éœ€çš„åº“\n# å¯¼å…¥æ‰€éœ€çš„åº“\nimport numpy as np\nimport pandas as pd\nfrom scipy.stats import truncnorm\n\n# --- 1. å®šä¹‰æ ·æœ¬é‡ ---\nn_patients = 637\n\n# --- 2. åŸºäºSEMå’Œç½‘ç»œåˆ†æç”Ÿæˆæ ¸å¿ƒç›¸å…³æ•°æ® ---\ncorrelation_matrix = np.array([\n    # SWB,   OCS,   Som,   Cog,   Dep,   Neg,   Pos,   PSP\n    [1.00, -0.59, -0.40, -0.20, -0.35, -0.25, -0.15,  0.30],\n    [-0.59,  1.00,  0.70,  0.30,  0.40,  0.20,  0.18, -0.25],\n    [-0.40,  0.70,  1.00,  0.25,  0.35,  0.15,  0.10, -0.20],\n    [-0.20,  0.30,  0.25,  1.00,  0.26,  0.48,  0.36, -0.40],\n    [-0.35,  0.40,  0.35,  0.26,  1.00,  0.35,  0.24, -0.50],\n    [-0.25,  0.20,  0.15,  0.48,  0.35,  1.00,  0.22, -0.60],\n    [-0.15,  0.18,  0.10,  0.36,  0.24,  0.22,  1.00, -0.30],\n    [ 0.30, -0.25, -0.20, -0.40, -0.50, -0.60, -0.30,  1.00]\n])\n\nmean = np.zeros(correlation_matrix.shape[0])\nnp.random.seed(42)\ncorrelated_data = np.random.multivariate_normal(mean, correlation_matrix, size=n_patients)\n\n# --- 3. ç¼©æ”¾å’Œè½¬æ¢æ•°æ®ä»¥åŒ¹é…è®ºæ–‡è¡¨2ä¸­çš„ç»Ÿè®¡ç‰¹å¾ ---\n\ndef scale_variable(data_column, mean, std, min_val, max_val):\n    scaled = data_column * std + mean\n    return np.clip(scaled, min_val, max_val)\n\ncgi_pos = scale_variable(correlated_data[:, 6], 3.7, 1.4, 1, 7)\ncgi_neg = scale_variable(correlated_data[:, 5], 3.3, 1.2, 1, 7)\ncgi_dep = scale_variable(correlated_data[:, 4], 2.6, 1.2, 1, 6)\ncgi_cog = scale_variable(correlated_data[:, 3], 3.1, 1.1, 1, 6)\nscl_som = scale_variable(correlated_data[:, 2], 21.3, 8.7, 12, 58)\nscl_ocs = scale_variable(correlated_data[:, 1], 22.4, 8.3, 10, 50)\nswn_total = scale_variable(correlated_data[:, 0], 73.5, 17.6, 24, 120)\npsp_total = scale_variable(correlated_data[:, 7], 55.9, 14.8, 10, 90)\ndiepss_severity = np.random.uniform(0, 4, n_patients)\ndiepss_severity = np.clip(diepss_severity, 0, 4)\ndiepss_severity_mean = np.mean(diepss_severity)\ndiepss_severity = (diepss_severity - diepss_severity_mean) * (0.8 / np.std(diepss_severity)) + 0.6\ndiepss_severity = np.clip(diepss_severity, 0, 4)\n\n# --- 4. ç”Ÿæˆç¤¾ä¼šäººå£ç»Ÿè®¡å­¦åŠå…¶ä»–å˜é‡ ---\n\nage_mean, age_std, age_min, age_max = 35.7, 10.5, 18, 64\nage = truncnorm.rvs((age_min - age_mean) / age_std, (age_max - age_mean) / age_std, loc=age_mean, scale=age_std, size=n_patients)\nsex = np.random.choice([1, 0], size=n_patients, p=[0.529, 0.471])\neducation = np.random.choice(['Less than 12 years', 'High school', 'College or graduate'], size=n_patients, p=[0.171, 0.413, 0.416])\noccupation = np.random.choice([1, 0], size=n_patients, p=[0.174, 0.826])\nillness_duration_mean, illness_duration_std, illness_duration_min, illness_duration_max = 9.1, 8.1, 0, 44\nillness_duration = truncnorm.rvs((illness_duration_min - illness_duration_mean) / illness_duration_std, (illness_duration_max - illness_duration_mean) / illness_duration_std, loc=illness_duration_mean, scale=illness_duration_std, size=n_patients)\nobesity = np.random.choice([1, 0], size=n_patients, p=[0.468, 0.532])\nhypertension = np.random.choice([1, 0], size=n_patients, p=[0.273, 0.727])\ndiabetes = np.random.choice([1, 0], size=n_patients, p=[0.154, 0.846])\n\n# --- 5. ç»„åˆæˆ Pandas DataFrame ---\nsynthetic_df = pd.DataFrame({\n    'Age': age.round(1),\n    'Sex_Female': sex,\n    'Education': education,\n    'Occupation_Employed': occupation,\n    'Duration_of_Illness': illness_duration.round(1),\n    'Obesity': obesity,\n    'Hypertension': hypertension,\n    'Diabetes': diabetes,\n    'CGI_Positive': cgi_pos.round(1),\n    'CGI_Negative': cgi_neg.round(1),\n    'CGI_Depressive': cgi_dep.round(1),\n    'CGI_Cognitive': cgi_cog.round(1),\n    'SCL90R_Somatization': scl_som.round(1),\n    'SCL90R_OCS': scl_ocs.round(1),\n    'SWN_Total_Score': swn_total.round(1),\n    'DIEPSS_Overall_Severity': diepss_severity.round(1),\n    'PSP_Total_Score': psp_total.round(1)\n})\n\n# --- 6. å°†æ•°æ®æ¡† (DataFrame) ä¿å­˜ä¸º CSV æ–‡ä»¶ ---\n# !!! é‡è¦æç¤º: è¯·å°†ä¸‹é¢çš„è·¯å¾„ä¿®æ”¹ä¸ºæ‚¨å¸Œæœ›ä¿å­˜æ–‡ä»¶çš„å®é™…ä½ç½® !!!\n# ä¾‹å¦‚ Windows: \"C:/Users/ç”¨æˆ·å/Documents/synthetic_data.csv\"\n# ä¾‹å¦‚ macOS: \"/Users/ç”¨æˆ·å/Documents/synthetic_data.csv\"\nfile_path = \"./synthetic_schizophrenia_data.csv\"\n\n# ä½¿ç”¨ to_csv() å‡½æ•°æ¥ä¿å­˜æ•°æ®\n# å‚æ•° index=False çš„æ„æ€æ˜¯ï¼Œæ•°æ®æ¡†çš„è¡Œç´¢å¼• (0, 1, 2, ...) ä¸ä¼šè¢«å†™å…¥åˆ° CSV æ–‡ä»¶ä¸­\nsynthetic_df.to_csv(file_path, index=False)\n\nprint(synthetic_df.head(10))\n\n```\n\n### ğŸ§® æ•°æ®ç»´åº¦\n\n-   **æ ·æœ¬æ•°ï¼ˆè¡Œæ•°ï¼‰**ï¼š`637` ç”± `n_patients = 637` æŒ‡å®šï¼Œæ¨¡æ‹Ÿçš„æ˜¯637ä½ç²¾ç¥åˆ†è£‚ç—‡æ‚£è€…çš„ä¸´åºŠä¸äººå£å­¦æ•°æ®ã€‚\n\n-   **å˜é‡æ•°ï¼ˆåˆ—æ•°ï¼‰**ï¼š`17` åŒ…æ‹¬ä¸´åºŠç—‡çŠ¶ã€äººå£å­¦ç‰¹å¾ã€åŠŸèƒ½çŠ¶æ€å’Œä»£è°¢æŒ‡æ ‡ç­‰å˜é‡ã€‚\n\n### ğŸ“Š å˜é‡åˆ—è¡¨ä¸ç±»å‹\n\n| å˜é‡å                    | ç±»å‹     | æè¿°                        |\n|---------------------------|----------|-----------------------------|\n| `Age`                     | è¿ç»­å˜é‡ | å¹´é¾„ï¼ˆ18â€“64å²ï¼‰             |\n| `Sex_Female`              | äºŒå…ƒå˜é‡ | æ€§åˆ«ï¼ˆ1=å¥³æ€§ï¼Œ0=ç”·æ€§ï¼‰      |\n| `Education`               | åˆ†ç±»å˜é‡ | æ•™è‚²æ°´å¹³ï¼ˆ3ç±»ï¼‰             |\n| `Occupation_Employed`     | äºŒå…ƒå˜é‡ | æ˜¯å¦å°±ä¸šï¼ˆ1=åœ¨èŒï¼‰          |\n| `Duration_of_Illness`     | è¿ç»­å˜é‡ | ç—…ç¨‹ï¼ˆ0â€“44å¹´ï¼‰              |\n| `Obesity`                 | äºŒå…ƒå˜é‡ | æ˜¯å¦è‚¥èƒ–                    |\n| `Hypertension`            | äºŒå…ƒå˜é‡ | æ˜¯å¦é«˜è¡€å‹                  |\n| `Diabetes`                | äºŒå…ƒå˜é‡ | æ˜¯å¦ç³–å°¿ç—…                  |\n| `CGI_Positive`            | è¿ç»­å˜é‡ | é˜³æ€§ç—‡çŠ¶è¯„åˆ†ï¼ˆ1â€“7ï¼‰         |\n| `CGI_Negative`            | è¿ç»­å˜é‡ | é˜´æ€§ç—‡çŠ¶è¯„åˆ†ï¼ˆ1â€“7ï¼‰         |\n| `CGI_Depressive`          | è¿ç»­å˜é‡ | æŠ‘éƒç—‡çŠ¶è¯„åˆ†ï¼ˆ1â€“6ï¼‰         |\n| `CGI_Cognitive`           | è¿ç»­å˜é‡ | è®¤çŸ¥ç¼ºé™·è¯„åˆ†ï¼ˆ1â€“6ï¼‰         |\n| `SCL90R_Somatization`     | è¿ç»­å˜é‡ | èº¯ä½“åŒ–è¯„åˆ†ï¼ˆ12â€“58ï¼‰         |\n| `SCL90R_OCS`              | è¿ç»­å˜é‡ | å¼ºè¿«ç—‡çŠ¶è¯„åˆ†ï¼ˆ10â€“50ï¼‰       |\n| `SWN_Total_Score`         | è¿ç»­å˜é‡ | ä¸»è§‚å¹¸ç¦æ„Ÿè¯„åˆ†ï¼ˆ24â€“120ï¼‰    |\n| `DIEPSS_Overall_Severity` | è¿ç»­å˜é‡ | é”¥ä½“å¤–ç³»ä¸è‰¯ååº”è¯„åˆ†ï¼ˆ0â€“4ï¼‰ |\n| `PSP_Total_Score`         | è¿ç»­å˜é‡ | ç¤¾ä¼šåŠŸèƒ½è¯„åˆ†ï¼ˆ10â€“90ï¼‰       |\n\n### ğŸ“Š å˜é‡æ¢ç´¢(æœºå™¨å­¦ä¹ è¿›è¡Œå˜é‡çš„æ¢ç´¢ï¼Œå³ç‰¹å¾å·¥ç¨‹)\n\n------------------------------------------------------------------------\n\n**è®ºæ–‡çš„é¦–è¦åˆ†ææ­¥éª¤æ˜¯åˆ©ç”¨æœºå™¨å­¦ä¹  (ML) æ¥è¯†åˆ«å†³å®šé«˜æ°´å¹³ä¸»è§‚å¹¸ç¦æ„Ÿ (SWB) çš„æœ€é‡è¦å› ç´ ã€‚è®ºæ–‡ä½œè€…è®­ç»ƒäº†å¤šä¸ªæ¨¡å‹ï¼Œå‘ç°éšæœºæ£®æ— (RF) æ¨¡å‹è¡¨ç°æœ€ä½³**\n\n1.  å‡†å¤‡æœºå™¨å­¦ä¹ çš„æ•°æ® ã€‚\n\n2.  è®­ç»ƒéšæœºæ£®æ—æ¨¡å‹æ¥é¢„æµ‹å“ªäº›æ‚£è€…å…·æœ‰â€œé«˜æ°´å¹³çš„ SWBâ€ã€‚\n\n3.  ä½¿ç”¨ AUC æŒ‡æ ‡è¯„ä¼°æ¨¡å‹çš„æ€§èƒ½ ï¼Œå°±åƒè®ºæ–‡ä¸­æ‰€åšçš„é‚£æ ·ã€‚\n\n4.  ä½¿ç”¨ SHAP å€¼åˆ†æ**ç‰¹å¾é‡è¦æ€§**ï¼Œ ä»¥äº†è§£å“ªäº›å˜é‡æ˜¯æœ€å¼ºå¤§çš„é¢„æµ‹å› å­ï¼Œé‡ç°è®ºæ–‡ä¸­å›¾ 1B ä¸­çš„å‘ç°ã€‚\n\n#### ç¬¬ä¸€æ­¥å¯¼å…¥éœ€è¦çš„åŒ…ğŸ§‰\n\n-   åŒ…æ˜¯å¯ä»¥è®¤ä¸ºæ˜¯æ¸¸æˆçš„mod,éƒ½æ˜¯å¤§ä½¬æ”¶é›†çš„ç®—æ³•æˆ–è€…å…¶ä»–çš„ä»£ç æ¥å®ç°ä½ éœ€è¦çš„åŠŸèƒ½ï¼Œè¿™äº›éƒ½æ˜¯åœ°åŸº\n\n```{python}\n#| echo: true\n# å¯¼å…¥æ‰€éœ€çš„åº“\nimport pandas as pd                 # å¯¼å…¥ pandas ç”¨äºè¯»å–å’Œå¤„ç†æ•°æ®\nimport numpy as np                  # å¯¼å…¥ numpy ç”¨äºæ•°å€¼è®¡ç®—\nfrom sklearn.model_selection import train_test_split # å¯¼å…¥ train_test_split ç”¨äºåˆ’åˆ†è®­ç»ƒé›†å’Œæµ‹è¯•é›†\nfrom sklearn.ensemble import RandomForestClassifier  # å¯¼å…¥éšæœºæ£®æ—åˆ†ç±»å™¨\nfrom sklearn.metrics import roc_auc_score, roc_curve # å¯¼å…¥è¯„ä¼°æŒ‡æ ‡è®¡ç®—å‡½æ•°\nimport matplotlib.pyplot as plt     # å¯¼å…¥ matplotlib ç”¨äºç»˜å›¾\nimport shap                         # å¯¼å…¥ SHAP åº“ç”¨äºæ¨¡å‹è§£é‡Š\n```\n\n#### ç¬¬äºŒæ­¥å¯¼å…¥æ•°æ®ğŸ¤¤\n\nå°±æ˜¯æˆ‘ä»¬è¦çš„æ•°æ®ï¼Œå³è°ƒæŸ¥çš„æ•°æ®ï¼Œä¸€èˆ¬æ˜¯XLSX(excelè¡¨æ ¼)ï¼Œcsv(æ•°æ®æ ¼å¼ä¸‡é‡‘æ²¹)ï¼Œæˆ–è€…å…¶ä»–æ ¼å¼\n\n```{python}\n#| echo: true\n\n# --- 1. åŠ è½½å¹¶å‡†å¤‡æ•°æ® ---\n# Load and Prepare the Data\n\n# !!! é‡è¦æç¤º: è¯·å°†ä¸‹é¢çš„è·¯å¾„ä¿®æ”¹ä¸ºæ‚¨ä¿å­˜ CSV æ–‡ä»¶çš„å®é™…ä½ç½® !!!\n# For example: \"C:/Users/YourUsername/Documents/synthetic_schizophrenia_data.csv\"\nfile_path = \"./synthetic_schizophrenia_data.csv\"\n\n# è¯»å–æˆ‘ä»¬ä¹‹å‰ç”Ÿæˆçš„åˆæˆæ•°æ®\ndf = pd.read_csv(file_path)\n```\n\n#### ç¬¬ä¸‰æ­¥ å®šä¹‰ç›®æ ‡å˜é‡å’Œç‰¹å¾å˜é‡ğŸ¥¶\n\næˆ‘ä»¬å¿…é¡»è¦çŸ¥é“what the fuck is our ç›®æ ‡å˜é‡ï¼Œå³æˆ‘ä»¬è¦ç ”ç©¶çš„ç›®æ ‡ï¼Œè¿™ç¯‡æ–‡ç« ç ”ç©¶çš„æ˜¯ **é«˜æ°´å¹³ä¸»è§‚å¹¸ç¦æ„Ÿ (SWB)**ï¼Œä»–ä»¬æƒ³è¦çŸ¥é“ä»€ä¹ˆå› ç´ å½±å“è¿™ä¸ªé¬¼ä¸œè¥¿ï¼Œè€Œè¿™äº›å› ç´ ï¼Œæ¯”å¦‚å¹´é¾„ï¼Œèº«é«˜ï¼Œä½“é‡å°±æ˜¯ç‰¹å¾å˜é‡\n\n-   **å®šä¹‰ç›®æ ‡**ï¼š æœ¬æ–‡æœºå™¨å­¦ä¹ æ¨¡å‹çš„ä¸»è¦ç›®æ ‡å¹¶éé¢„æµ‹å‡†ç¡®çš„ä¸»è§‚å¹¸ç¦æ„Ÿ (SWB) è¯„åˆ†ï¼Œè€Œæ˜¯å°†æ‚£è€…åˆ†ä¸ºä¸¤ç»„ï¼šå…·æœ‰â€œé«˜æ°´å¹³ SWBâ€çš„æ‚£è€…å’Œä¸å…·æœ‰â€œé«˜æ°´å¹³ SWBâ€çš„æ‚£è€…ã€‚æˆ‘ä»¬éµå¾ªæœ¬æ–‡çš„æ€è·¯ï¼Œåˆ›å»ºäº†ä¸€ä¸ªäºŒå…ƒç›®æ ‡å˜é‡ ( High_SWB )ï¼Œå…¶ä¸­ 80 åˆ†åŠä»¥ä¸Šè¢«è§†ä¸ºâ€œé«˜â€ï¼ˆç¼–ç ä¸º 1ï¼‰ï¼Œä½äº 80 åˆ†åˆ™è¢«è§†ä¸ºâ€œä½â€ï¼ˆç¼–ç ä¸º 0ï¼‰ã€‚\n\n```{python}\n#| echo: true\n\n# å®šä¹‰ç›®æ ‡å˜é‡ (Y)\n# æ ¹æ®è®ºæ–‡ï¼Œ\"é«˜æ°´å¹³SWB\" å®šä¹‰ä¸º SWN æ€»åˆ†è¾¾åˆ°æˆ–è¶…è¿‡ 80\n# æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªåä¸º 'High_SWB' çš„æ–°åˆ—ï¼Œ1 è¡¨ç¤ºé«˜SWBï¼Œ0 è¡¨ç¤ºéé«˜SWB\ndf['High_SWB'] = (df['SWN_Total_Score'] >= 80).astype(int)\n\n# å®šä¹‰ç‰¹å¾å˜é‡ (X)\n# X æ˜¯é™¤äº†ç›®æ ‡å˜é‡å’ŒåŸå§‹SWNåˆ†æ•°ä¹‹å¤–çš„æ‰€æœ‰åˆ—\n# We drop the original score and the target variable to create our feature set\nX = df.drop(['SWN_Total_Score', 'High_SWB'], axis=1)\ny = df['High_SWB']\n```\n\n#### ç‰¹å¾å·¥ç¨‹\n\nç‰¹å¾å·¥ç¨‹æ˜¯æŒ‡ä»åŸå§‹æ•°æ®ä¸­æå–æœ‰ç”¨çš„ç‰¹å¾ï¼Œä»¥ä¾¿äºæœºå™¨å­¦ä¹ æ¨¡å‹çš„è®­ç»ƒå’Œé¢„æµ‹ã€‚\n\nç‰¹å¾å·¥ç¨‹åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š\n\n1.  ç‰¹å¾é€‰æ‹©ï¼šé€‰æ‹©æœ€ç›¸å…³çš„ç‰¹å¾ï¼Œä»¥å‡å°‘æ¨¡å‹çš„å¤æ‚åº¦ï¼Œæé«˜æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ã€‚å³æœ‰çš„æ—¶å€™ç‰¹å¾å¤ªå¤šï¼Œä¸”å…¶ä¸­æœ‰æ— æ„ä¹‰æˆ–è€…ä¸é‡è¦çš„ç‰¹å¾ï¼Œè¿™æ—¶å€™å°±éœ€è¦é€‰æ‹©æœ€ç›¸å…³çš„ç‰¹å¾ï¼Œä»¥å‡å°‘æ¨¡å‹çš„å¤æ‚åº¦ï¼Œæé«˜æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ã€‚\n2.  ç‰¹å¾æå–ï¼šä»åŸå§‹æ•°æ®ä¸­æå–æœ‰ç”¨çš„ç‰¹å¾ï¼Œä»¥ä¾¿äºæœºå™¨å­¦ä¹ æ¨¡å‹çš„è®­ç»ƒå’Œé¢„æµ‹ã€‚\n3.  ç‰¹å¾å˜æ¢ï¼šå¯¹ç‰¹å¾è¿›è¡Œå˜æ¢ï¼Œä»¥ä¾¿äºæœºå™¨å­¦ä¹ æ¨¡å‹çš„è®­ç»ƒå’Œé¢„æµ‹ã€‚æ¯”å¦‚æ ‡å‡†åŒ–ï¼Œå½’ä¸€åŒ–ï¼Œç‹¬çƒ­ç¼–ç ï¼Œç­‰ç­‰ã€‚ å¯¹äºä¸€äº›å…¶ä»–æ•°æ®ç±»å‹ï¼Œæ¯”å¦‚å­—ç¬¦å‹ï¼Œå¦‚æ˜¯å¦ä¸ºç”·æˆ–è€…å¥³æ€§ï¼Œä¸€èˆ¬å¯ä»¥ç”¨1ä»£è¡¨ç”·ï¼Œ0ä»£è¡¨å¥³ï¼Œå› ä¸ºæ¨¡å‹ä¸€èˆ¬æ— æ³•äº†è§£å­—çš„çœŸå®å«ä¹‰ï¼Œä½†æ˜¯æ•°å­—å¯ä»¥ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œå¯¹äºç‰¹å¾å·¥ç¨‹è¿™ä¸ªæ­¥éª¤éœ€è¦èŠ±è´¹å¾ˆå¤šæ—¶é—´ã€‚æˆ‘ä»¬è¿™ä¸ªä¾‹å­çš„æ•°æ®æ¯”è¾ƒç¬¦åˆæœºå™¨å­¦ä¹ çš„ç±»å‹ï¼Œä¸éœ€è¦å¤ªå¤šæ›´æ”¹\n\nç‹¬çƒ­ç¼–ç æ˜¯å°†åˆ†ç±»å˜é‡è½¬æ¢ä¸ºäºŒè¿›åˆ¶å˜é‡ï¼Œå³å°†æ¯ä¸ªåˆ†ç±»å˜é‡è½¬æ¢ä¸ºå¤šä¸ªäºŒè¿›åˆ¶å˜é‡ï¼Œæ¯ä¸ªäºŒè¿›åˆ¶å˜é‡è¡¨ç¤ºä¸€ä¸ªåˆ†ç±»ã€‚æ¯”å¦‚è¿™ä¸ªä¾‹å­æ•™è‚²æ˜¯åˆ†ä¸ºä¸‰ç±»ï¼Œä¸”éƒ½ä¸ºå­—ç¬¦å‹ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæ•™è‚²åˆ†ä¸ºä¸‰ä¸ªäºŒè¿›åˆ¶ï¼ˆ0/1ï¼‰å˜é‡ï¼Œæ¯ä¸ªäºŒè¿›åˆ¶å˜é‡è¡¨ç¤ºä¸€ä¸ªåˆ†ç±»ã€‚\n\n```{python}\n#| echo: true\n\n# å¤„ç†åˆ†ç±»å˜é‡\n# 'Education' åˆ—æ˜¯æ–‡æœ¬ç±»å‹ï¼Œæœºå™¨å­¦ä¹ æ¨¡å‹éœ€è¦æ•°å€¼è¾“å…¥ã€‚\n# æˆ‘ä»¬ä½¿ç”¨ \"ç‹¬çƒ­ç¼–ç \" (One-Hot Encoding) å°†å…¶è½¬æ¢ä¸ºæ•°å€¼åˆ—ã€‚\n# This converts the 'Education' column into multiple binary (0/1) columns.\nX = pd.get_dummies(X, columns=['Education'], drop_first=True)\n\n```\n\næ¥ä¸‹æ¥æˆ‘ä»¬è¦è¿›è¡Œæ•°æ®æ ‡å‡†åŒ–ï¼Œä»–çš„ç»Ÿè®¡å­¦æ„ä¹‰æˆ‘å°±ä¸è¯´äº†ï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆè¦è¿›è¡Œæ ‡å‡†åŒ–ï¼Œæ ‡å‡†åŒ–å¯ä»¥ä¼šå°†æ‰€æœ‰ç‰¹å¾ç¼©æ”¾åˆ°å‡å€¼ä¸º0ï¼Œæ ‡å‡†å·®ä¸º1çš„èŒƒå›´ï¼Œå¯¹äºé€»è¾‘å›å½’ç­‰çº¿æ€§æ¨¡å‹å¾ˆé‡è¦ï¼Œè€Œå¯¹äºä¸€äº›éšæœºæ£®æ—ï¼Œç¥ç»ç½‘ç»œç­‰ç­‰çš„é»‘ç®±æ¨¡å‹ä¸å¤ªé‡è¦ï¼Œä½†æ˜¯æˆ‘è¿˜æ˜¯è¿›è¡Œæ ‡å‡†åŒ–ã€‚\n\n```{python}\n#| echo: true\n# æ•°æ®æ ‡å‡†åŒ– (å¯¹äºé€»è¾‘å›å½’ç­‰çº¿æ€§æ¨¡å‹å¾ˆé‡è¦)\n# StandardScaler ä¼šå°†æ‰€æœ‰ç‰¹å¾ç¼©æ”¾åˆ°å‡å€¼ä¸º0ï¼Œæ ‡å‡†å·®ä¸º1çš„èŒƒå›´\n#å…ˆå¯¼å…¥æˆ‘ä»¬éœ€è¦çš„åŒ…\nfrom sklearn.preprocessing import StandardScaler\n\nscaler = StandardScaler()\nX_scaled = scaler.fit_transform(X)\n```\n\n\\#### æœºå™¨å­¦ä¹  æˆ‘ä»¬å…ˆå®šä¹‰ä¸€å †æˆ‘ä»¬è¦ç”¨çš„æœºæ¢°å­¦ä¹ çš„æ¨¡å‹ï¼Œè®ºæ–‡é‡Œé¢ç”¨çš„æ˜¯éšæœºæ£®æ—ï¼Œé€»è¾‘å›å½’ï¼Œæ”¯æŒå‘é‡æœºï¼Œç­‰ç­‰\n\næˆ‘ä»¬å°†ä½¿ç”¨äº”ç§æœºå™¨å­¦ä¹ æ¨¡å‹æ¥é¢„æµ‹æ‚£è€…æ˜¯å¦å…·æœ‰é«˜æ°´å¹³çš„ä¸»è§‚å¹¸ç¦æ„Ÿï¼ˆSWBï¼‰ã€‚æ¯ç§æ¨¡å‹éƒ½æœ‰ä¸åŒçš„ç‰¹ç‚¹å’Œé€‚ç”¨åœºæ™¯ã€‚\n\n##### 1ï¸âƒ£ Logistic Regression (LR)\n\n. é€»è¾‘å›å½’æ˜¯ä¸€ç§ç»å…¸çš„çº¿æ€§æ¨¡å‹ï¼Œé€‚ç”¨äºäºŒåˆ†ç±»é—®é¢˜ï¼ˆå¦‚ï¼šé«˜SWB vs ä½SWBï¼‰ã€‚\n\n. ä¼˜ç‚¹ï¼šç®€å•ã€æ˜“è§£é‡Šã€è®¡ç®—å¿«ã€‚\n\n. åŸç†ï¼šæ ¹æ®æ¯ä¸ªå˜é‡çš„æƒé‡ï¼Œè®¡ç®—ä¸€ä¸ªæ¦‚ç‡å€¼ï¼ˆ0åˆ°1ä¹‹é—´ï¼‰ï¼Œåˆ¤æ–­å±äºå“ªä¸ªç±»åˆ«ã€‚\n\n. é€‚ç”¨åœºæ™¯ï¼šå˜é‡ä¹‹é—´å…³ç³»è¾ƒç®€å•ã€çº¿æ€§æ—¶æ•ˆæœå¥½ã€‚\n\n2ï¸âƒ£ Random Forest (RF) . éšæœºæ£®æ—æ˜¯ä¸€ç§é›†æˆå­¦ä¹ æ–¹æ³•ï¼Œç”±å¤šä¸ªå†³ç­–æ ‘ç»„æˆã€‚\n\n. ä¼˜ç‚¹ï¼šæŠ—è¿‡æ‹Ÿåˆã€èƒ½å¤„ç†éçº¿æ€§å…³ç³»ã€å¯¹ç¼ºå¤±å€¼å’Œå¼‚å¸¸å€¼é²æ£’ã€‚\n\n. åŸç†ï¼šæ¯æ£µæ ‘éƒ½åœ¨ä¸åŒçš„æ•°æ®å­é›†ä¸Šè®­ç»ƒï¼Œæœ€ç»ˆé€šè¿‡â€œæŠ•ç¥¨â€å†³å®šé¢„æµ‹ç»“æœã€‚\n\n. é€‚ç”¨åœºæ™¯ï¼šå˜é‡å¤šã€å…³ç³»å¤æ‚æ—¶è¡¨ç°ä¼˜å¼‚ã€‚\n\n. 3ï¸âƒ£ Gradient Boosting Machine (GBM) æ¢¯åº¦æå‡æœºæ˜¯ä¸€ç§é€æ­¥ä¼˜åŒ–çš„é›†æˆæ–¹æ³•ã€‚\n\n. ä¼˜ç‚¹ï¼šé¢„æµ‹ç²¾åº¦é«˜ï¼Œé€‚åˆå¤æ‚æ•°æ®ç»“æ„ã€‚\n\n. åŸç†ï¼šæ¯æ£µæ–°æ ‘éƒ½ä¸“æ³¨äºçº æ­£å‰ä¸€æ£µæ ‘çš„é”™è¯¯ï¼Œé€æ­¥æå‡æ•´ä½“æ€§èƒ½ã€‚\n\n. é€‚ç”¨åœºæ™¯ï¼šéœ€è¦é«˜ç²¾åº¦é¢„æµ‹æ—¶ï¼ŒGBMæ˜¯å¸¸ç”¨é€‰æ‹©ã€‚\n\n.\n\n4ï¸âƒ£ XGBoost (XGB) . æç«¯æ¢¯åº¦æå‡æ˜¯GBMçš„é«˜æ•ˆç‰ˆæœ¬ï¼Œåœ¨æ•°æ®ç§‘å­¦ç«èµ›ä¸­éå¸¸æµè¡Œã€‚\n\n. ä¼˜ç‚¹ï¼šé€Ÿåº¦å¿«ã€æ€§èƒ½å¼ºã€æ”¯æŒç¼ºå¤±å€¼å¤„ç†å’Œæ­£åˆ™åŒ–ã€‚\n\n. åŸç†ï¼šåœ¨GBMåŸºç¡€ä¸ŠåŠ å…¥æ›´å¤šä¼˜åŒ–ç­–ç•¥ï¼Œå¦‚å‰ªæã€å¹¶è¡Œè®¡ç®—ã€‚\n\n. é€‚ç”¨åœºæ™¯ï¼šå¤§æ•°æ®ã€é«˜ç»´åº¦ã€éœ€è¦å¿«é€Ÿè®­ç»ƒæ—¶ã€‚\n\n5ï¸âƒ£ LightGBM (LGBM) . è½»é‡çº§æ¢¯åº¦æå‡æœºæ˜¯å¦ä¸€ç§é«˜æ•ˆçš„GBMå˜ä½“ï¼Œä¸“ä¸ºå¤§è§„æ¨¡æ•°æ®è®¾è®¡ã€‚\n\n. ä¼˜ç‚¹ï¼šè®­ç»ƒé€Ÿåº¦å¿«ã€å†…å­˜å ç”¨ä½ã€é€‚åˆé«˜ç»´ç¨€ç–æ•°æ®ã€‚\n\n. åŸç†ï¼šä½¿ç”¨â€œå¶å­ä¼˜å…ˆâ€ç­–ç•¥æ„å»ºæ ‘ï¼Œæå‡æ•ˆç‡ã€‚\n\n. é€‚ç”¨åœºæ™¯ï¼šæ•°æ®é‡å¤§ã€å˜é‡å¤šæ—¶éå¸¸é€‚åˆã€‚\n\n**å½“ç„¶ï¼Œéšç€ç°åœ¨ç®—æ³•çš„å‡çº§ï¼Œè¿˜æœ‰å¾ˆå¤šç®—æ³•åœ¨ä»–ä»¬ä¹‹ä¸Šæœ‰æ›´å¥½çš„è¡¨ç°ï¼Œä¹Ÿè¦æ ¹æ®æ•°æ®å’Œæ¨¡å‹çš„ç”¨é€”è¿›è¡ŒåŒ¹é…**\n\nğŸ“Š ä¸ºä»€ä¹ˆè¦æ¯”è¾ƒå¤šä¸ªæ¨¡å‹ï¼Ÿ ä¸åŒæ¨¡å‹å¯¹æ•°æ®çš„æ•æ„Ÿæ€§ä¸åŒï¼Œé€‚åˆçš„åœºæ™¯ä¹Ÿä¸åŒã€‚\n\næ¯”è¾ƒå¤šä¸ªæ¨¡å‹å¯ä»¥æ‰¾åˆ°æœ€ç¨³å®šã€æœ€å‡†ç¡®çš„é¢„æµ‹æ–¹æ³•ã€‚\n\n```{python}\n#| echo: true\n\n#  å®šä¹‰è¦æ¯”è¾ƒçš„æ¨¡å‹ ---\n# ä¾æ—§å¯¼å…¥éœ€è¦çš„åŒ…\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.ensemble import RandomForestClassifier, GradientBoostingClassifier\nimport xgboost as xgb\nimport lightgbm as lgb\n\n# æˆ‘ä»¬å°†æ‰€æœ‰æ¨¡å‹å‚¨å­˜åœ¨ä¸€ä¸ªå­—å…¸ä¸­ï¼Œæ–¹ä¾¿å¾ªç¯è°ƒç”¨\nmodels = {\n    \"Logistic Regression (LR)\": LogisticRegression(max_iter=1000, random_state=42),\n    \"Random Forest (RF)\": RandomForestClassifier(n_estimators=500, max_depth=5, random_state=42),\n    \"Gradient Boosting (GBM)\": GradientBoostingClassifier(n_estimators=200, max_depth=3, random_state=42),\n    \"XGBoost (XGB)\": xgb.XGBClassifier(n_estimators=200, max_depth=3, use_label_encoder=False, eval_metric='logloss', random_state=42),\n    \"LightGBM (LGBM)\": lgb.LGBMClassifier(n_estimators=200, max_depth=3, random_state=42, verbosity=-1)\n\n}\n```\n\n##### ğŸ§ª ä½¿ç”¨ 5 æŠ˜äº¤å‰éªŒè¯è¯„ä¼°æ‰€æœ‰æ¨¡å‹\n\nåœ¨è¿™ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†å¯¹äº”ç§æœºå™¨å­¦ä¹ æ¨¡å‹è¿›è¡Œæ€§èƒ½è¯„ä¼°ï¼Œä½¿ç”¨çš„æ˜¯ä¸€ç§éå¸¸ç¨³å¥çš„æ–¹æ³•ï¼š5 æŠ˜äº¤å‰éªŒè¯ï¼ˆ5-fold cross-validationï¼‰ã€‚\n\n. âœ… ä»€ä¹ˆæ˜¯äº¤å‰éªŒè¯ï¼Ÿ äº¤å‰éªŒè¯æ˜¯ä¸€ç§å°†æ•°æ®é›†åˆ†æˆå¤šä¸ªâ€œå­é›†â€æ¥è®­ç»ƒå’Œæµ‹è¯•æ¨¡å‹çš„æ–¹æ³•ã€‚\n\n. åœ¨ 5 æŠ˜äº¤å‰éªŒè¯ä¸­ï¼Œæˆ‘ä»¬å°†æ•°æ®åˆ†æˆ 5 ä»½ï¼š\n\n. æ¯æ¬¡ç”¨å…¶ä¸­ 4 ä»½è®­ç»ƒæ¨¡å‹ï¼Œå‰©ä¸‹ 1 ä»½æµ‹è¯•æ¨¡å‹ã€‚\n\n. è¿™ä¸ªè¿‡ç¨‹é‡å¤ 5 æ¬¡ï¼Œæ¯æ¬¡æµ‹è¯•é›†éƒ½ä¸åŒã€‚\n\n. æœ€åæˆ‘ä»¬è®¡ç®— 5 æ¬¡çš„å¹³å‡æ€§èƒ½æŒ‡æ ‡ï¼ˆå¦‚ AUCï¼‰ï¼Œå¾—åˆ°ä¸€ä¸ªæ›´ç¨³å®šçš„è¯„ä¼°ç»“æœã€‚\n\n. è¿™ç§æ–¹æ³•æ¯”å•æ¬¡è®­ç»ƒ/æµ‹è¯•åˆ’åˆ†æ›´å¯é ï¼Œèƒ½å‡å°‘â€œè¿æ°”å¥½/åâ€å¸¦æ¥çš„è¯¯å·®ã€‚\n\n. ğŸ“Š ä¸ºä»€ä¹ˆé€‰æ‹© AUCï¼Ÿ . AUC æ˜¯è¡¡é‡æ¨¡å‹åŒºåˆ†èƒ½åŠ›çš„æŒ‡æ ‡ï¼Œå€¼è¶Šæ¥è¿‘ 1ï¼Œæ¨¡å‹è¶Šå¥½ã€‚\n\n```{python}\n#| echo: true\nfrom sklearn.model_selection import cross_val_score\n\nresults = {} # åˆ›å»ºä¸€ä¸ªç©ºå­—å…¸æ¥å‚¨å­˜ç»“æœ\n\nprint(\"æ­£åœ¨ä½¿ç”¨5æŠ˜äº¤å‰éªŒè¯è¯„ä¼°æ¯ä¸ªæ¨¡å‹...\")\n\n# å¾ªç¯éå†æˆ‘ä»¬å®šä¹‰çš„æ¯ä¸ªæ¨¡å‹\nfor model_name, model in models.items():\n    # å¯¹çº¿æ€§æ¨¡å‹ï¼ˆé€»è¾‘å›å½’ï¼‰ä½¿ç”¨æ ‡å‡†åŒ–åçš„æ•°æ®\n    if model_name == \"Logistic Regression (LR)\":\n        X_input = X_scaled\n    else: # å¯¹æ ‘æ¨¡å‹ä½¿ç”¨åŸå§‹ç¼–ç åçš„æ•°æ®\n        X_input = X\n\n    # ä½¿ç”¨ cross_val_score å‡½æ•°è¿›è¡Œ5æŠ˜äº¤å‰éªŒè¯\n    # cv=5: æŒ‡å®šäº†æŠ˜æ•°\n    # scoring='roc_auc': æŒ‡å®šè¯„ä¼°æŒ‡æ ‡ä¸º AUC\n\n    cv_scores = cross_val_score(model, X_input, y, cv=5, scoring='roc_auc')\n\n    # å°†æ¯ä¸ªæ¨¡å‹çš„åç§°å’Œå…¶5æ¬¡äº¤å‰éªŒè¯çš„å¹³å‡åˆ†åŠæ ‡å‡†å·®å­˜å…¥ç»“æœå­—å…¸\n    results[model_name] = {\n        'mean_auc': np.mean(cv_scores),\n        'std_auc': np.std(cv_scores)\n    }\n    \n    # æ‰“å°æ¯ä¸ªæ¨¡å‹çš„è¯„ä¼°ç»“æœ\n    print(f\"  {model_name}: å¹³å‡ AUC = {results[model_name]['mean_auc']:.4f} (æ ‡å‡†å·® = {results[model_name]['std_auc']:.4f})\")\n```\n\nè¿™äº› LightGBM çš„æ—¥å¿—ä¿¡æ¯å’Œè­¦å‘Šæ˜¯æ¨¡å‹è®­ç»ƒè¿‡ç¨‹ä¸­çš„æ­£å¸¸è¾“å‡ºï¼Œå°¤å…¶æ˜¯è¿™å¥ï¼š\n\n> **\\[Warning\\] No further splits with positive gain, best gain: -inf**\n\nå®ƒçš„æ„æ€æ˜¯ï¼šåœ¨æŸä¸€è½®è®­ç»ƒä¸­ï¼ŒLightGBM æ²¡æœ‰æ‰¾åˆ°ä»»ä½•å¯ä»¥ç»§ç»­åˆ†è£‚çš„èŠ‚ç‚¹ï¼ˆå³æ²¡æœ‰â€œæ­£å¢ç›Šâ€çš„åˆ†è£‚ç‚¹ï¼‰ï¼Œæ‰€ä»¥è¯¥è½®çš„æ ‘æ„å»ºå°±æå‰ç»ˆæ­¢äº†ã€‚è¿™é€šå¸¸æ˜¯å› ä¸ºï¼š\n\n-   æ•°æ®å·²ç»è¢«å¾ˆå¥½åœ°æ‹Ÿåˆï¼›\n\n-   å½“å‰å‚æ•°é™åˆ¶äº†æ ‘çš„å¤æ‚åº¦ï¼ˆå¦‚ `max_depth`ã€`min_data_in_leaf` ç­‰ï¼‰ï¼›\n\n-   æˆ–è€…æ•°æ®æœ¬èº«ä¸æ”¯æŒè¿›ä¸€æ­¥åˆ†è£‚ï¼ˆä¾‹å¦‚æ ·æœ¬å¤ªå°‘æˆ–ç‰¹å¾å¤ªå¼±ï¼‰ã€‚\n\nè¿™ä¸æ˜¯é”™è¯¯ï¼Œä¹Ÿä¸ä¼šå½±å“æ¨¡å‹çš„æ­£å¸¸è®­ç»ƒå’Œé¢„æµ‹æ€§èƒ½ã€‚\n\n#### å¯è§†åŒ–ç»“æœğŸ¤¨\n\n. æ¯”è¾ƒå¹³å‡ AUC åˆ†æ•°ï¼š æŸ¥çœ‹æ‰“å°çš„è¾“å‡ºå’Œæ¡å½¢å›¾ã€‚æ‚¨å°†çœ‹åˆ°äº”ä¸ªæ¨¡å‹çš„å¹³å‡ AUC åˆ†æ•°ã€‚ ä¸åŸå§‹è®ºæ–‡ä¸€è‡´ï¼Œæ‚¨å¯èƒ½ä¼šå‘ç°æ‰€æœ‰é«˜çº§æ¨¡å‹ï¼ˆRFï¼ŒGBMï¼ŒXGBï¼ŒLGBMï¼‰çš„è¡¨ç°éå¸¸ç›¸ä¼¼ï¼Œå¹¶ä¸”æ˜æ˜¾ä¼˜äºåŸºçº¿ Logistic å›å½’æ¨¡å‹ ã€‚\n\néšæœºæ£®æ—æ¨¡å‹å¯èƒ½ä»ç„¶ç•¥å ä¼˜åŠ¿ï¼Œå°±åƒè®ºæ–‡ä¸­æåˆ°çš„é‚£æ ·ï¼ŒAUC å¾—åˆ†åœ¨ 0.79-0.80 å·¦å³ ã€‚è¿™è¯å®äº†æˆ‘ä»¬ä¹‹å‰çš„å‘ç°ï¼Œä½†ç°åœ¨çš„ç½®ä¿¡åº¦æ›´é«˜äº†ã€‚é¡¶çº§æ¨¡å‹ä¹‹é—´æ€§èƒ½æ¥è¿‘ï¼Œè¿™æ˜¯æœºå™¨å­¦ä¹ ä¸­ä¸€ä¸ªéå¸¸å¸¸è§ä¸”é‡è¦çš„å‘ç°ã€‚\n\næ ‡å‡†å·®ï¼ˆè¯¯å·®çº¿ï¼‰çš„é‡è¦æ€§ï¼š æ ‡å‡†å·®ï¼ˆç”±æ¡å½¢å›¾ä¸Šçš„é»‘è‰²â€œè¯¯å·®çº¿â€è¡¨ç¤ºï¼‰å‘Šè¯‰æ‚¨æ¨¡å‹çš„æ€§èƒ½åœ¨ 5 ä¸ªä¸åŒæŠ˜å ä¹‹é—´çš„å·®å¼‚æœ‰å¤šå¤§ã€‚ æ ‡å‡†å·®è¶Šå°ï¼ˆè¯¯å·®çº¿è¶ŠçŸ­ï¼‰ï¼Œæ•ˆæœè¶Šå¥½ã€‚ è¿™æ„å‘³ç€æ¨¡å‹ç¨³å®šï¼Œå…¶æ€§èƒ½ä¸ä¼šä¸¥é‡ä¾èµ–äºè®­ç»ƒæ—¶æ‰€ç”¨çš„ç‰¹å®šæ•°æ®å­é›†ã€‚\n\næ‚¨å¯èƒ½ä¼šæ³¨æ„åˆ°åŸºäºæ ‘çš„æ¨¡å‹å…·æœ‰ç›¸å¯¹è¾ƒä½çš„æ–¹å·®ï¼Œè¿™è¡¨æ˜å®ƒä»¬å¾ˆç¨³å®šã€‚\n\n```{python}\n#| echo: true\n\n# å°†ç»“æœå­—å…¸è½¬æ¢ä¸º DataFrameï¼Œæ–¹ä¾¿ç»˜å›¾\nresults_df = pd.DataFrame(results).T.sort_values(by='mean_auc', ascending=False)\n\nplt.figure(figsize=(12, 7))\nbars = plt.bar(results_df.index, results_df['mean_auc'], yerr=results_df['std_auc'], capsize=5, color='skyblue')\n\n# åœ¨æ¯ä¸ªæŸ±çŠ¶å›¾ä¸Šæ˜¾ç¤ºæ•°å€¼\nfor bar in bars:\n    yval = bar.get_height()\n    plt.text(bar.get_x() + bar.get_width()/2.0, yval + 0.01, f'{yval:.3f}', ha='center', va='bottom')\n\nplt.ylabel('Mean AUC Score ')\nplt.xlabel('Machine Learning Models ')\nplt.title('Comparison of ML Models using 5-Fold Cross-Validation ')\nplt.ylim(0, 1.0) # è®¾ç½®yè½´èŒƒå›´ä¸º0åˆ°1\nplt.xticks(rotation=15) # æ—‹è½¬xè½´æ ‡ç­¾ï¼Œé˜²æ­¢é‡å \nplt.grid(axis='y', linestyle='--', alpha=0.7)\nplt.show()\n```\n\n**ğŸ¯ æ¨¡å‹è¡¨ç°æ’åï¼ˆæŒ‰ AUCï¼‰**\n\n| æ¨¡å‹åç§°                    | å¹³å‡ AUC åˆ†æ•° |\n|-----------------------------|---------------|\n| ğŸ¥‡ **Random Forest (RF)**   | **0.798**     |\n| ğŸ¥ˆ Logistic Regression (LR) | 0.792         |\n| ğŸ¥‰ LightGBM (LGBM)          | 0.760         |\n| XGBoost (XGB)               | 0.758         |\n| Gradient Boosting (GBM)     | 0.757         |\n\n**ğŸ“Œ è¯„ä¼°**\n\n> åœ¨è¿™æ¬¡è¯„ä¼°ä¸­ï¼Œ**Random Forest** ä¸ä»…åœ¨å¹³å‡ AUC ä¸Šé¢†å…ˆï¼Œè€Œä¸”å…¶ç¨³å®šæ€§ä¹Ÿå¾ˆé«˜ï¼ˆæ ‡å‡†å·®è¾ƒå°ï¼‰ã€‚è¿™è¯´æ˜å®ƒåœ¨ä¸åŒæ•°æ®åˆ’åˆ†ä¸‹éƒ½èƒ½ä¿æŒè‰¯å¥½çš„é¢„æµ‹èƒ½åŠ›ï¼Œæ˜¯ä¸€ä¸ªéå¸¸å¯é çš„æ¨¡å‹é€‰æ‹©ã€‚\n\n-   è™½ç„¶é€»è¾‘å›å½’æ˜“äºè§£é‡Šï¼Œä½†åœ¨å¤æ‚æ•°æ®ä¸­ï¼Œé›†æˆæ ‘æ¨¡å‹ï¼ˆå¦‚ RFï¼‰å¾€å¾€èƒ½æ•æ‰æ›´ä¸°å¯Œçš„éçº¿æ€§å…³ç³»ï¼›\n\n-   RF çš„ä¼˜åŠ¿åœ¨äºâ€œç¨³å¥æ€§â€å’Œâ€œæ³›åŒ–èƒ½åŠ›â€ï¼Œå°¤å…¶é€‚åˆä¸´åºŠæ•°æ®è¿™ç§å˜é‡å¤šã€ç»“æ„å¤æ‚çš„åœºæ™¯ï¼›\n\n-   è¿™ä¹ŸéªŒè¯äº†åŸå§‹è®ºæ–‡çš„ç»“è®ºï¼šRF æ˜¯é¢„æµ‹ä¸»è§‚å¹¸ç¦æ„Ÿçš„é¦–é€‰æ¨¡å‹ä¹‹ä¸€ã€‚\n\n------------------------------------------------------------------------\n\n## æ”¹è¿›æ¨¡å‹ğŸ¤–ğŸ¤–\n\nè™½ç„¶æˆ‘ä»¬çš„æ¨¡å‹AUCæœ‰0.8å·¦å³ï¼Œè¿™æ ·çš„æ•°æ®å·²ç»ä¸é”™äº†ï¼Œå¦‚æœæ¯”è¾ƒåŸæ¥çš„è®ºæ–‡[åŸè®ºæ–‡é“¾æ¥](https://pmc.ncbi.nlm.nih.gov/articles/PMC12236327/#s5)\n\n`The random forest (RF) model had the highest area under the curve (AUC) of 0.794 at baseline. Obsessive-compulsive symptoms (OCS) had the most significant impact on high levels of SWB, followed by somatization, cognitive deficits, and depression. The network analysis demonstrated robust connections among the SWB, OCS, and somatization. SEM analysis revealed that OCS exerted the strongest direct effect on SWB, and also an indirect effect via the mediation of depression. Furthermore, the contribution of OCS at baseline to SWB was maintained 6 months later.éšæœºæ£®æ— (RF) æ¨¡å‹çš„åŸºçº¿æ›²çº¿ä¸‹é¢ç§¯ (AUC) æœ€é«˜ï¼Œä¸º 0.794ã€‚å¼ºè¿«ç—‡çŠ¶ (OCS) å¯¹é«˜æ°´å¹³ä¸»è§‚å¹¸ç¦æ„Ÿ (SWB) çš„å½±å“æœ€ä¸ºæ˜¾è‘—ï¼Œå…¶æ¬¡æ˜¯èº¯ä½“åŒ–ã€è®¤çŸ¥ç¼ºé™·å’ŒæŠ‘éƒç—‡ã€‚ç½‘ç»œåˆ†æè¡¨æ˜ï¼ŒSWBã€OCS å’Œèº¯ä½“åŒ–ä¹‹é—´å­˜åœ¨ç¨³æ€è”ç³»ã€‚ç»“æ„æ–¹ç¨‹æ¨¡å‹ (SEM) åˆ†ææ˜¾ç¤ºï¼ŒOCS å¯¹ SWB çš„ç›´æ¥å½±å“æœ€ä¸ºæ˜¾è‘—ï¼Œå¹¶ä¸”ä¹Ÿé€šè¿‡æŠ‘éƒç—‡çš„ä¸­ä»‹äº§ç”Ÿé—´æ¥å½±å“ã€‚æ­¤å¤–ï¼ŒåŸºçº¿ OCS å¯¹ SWB çš„è´¡çŒ®åœ¨ 6 ä¸ªæœˆåå¾—ä»¥ç»´æŒã€‚`\n\nçœ‹èµ·æ¥ç¡®å®å·²ç»ä¸é”™äº†ï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜æ˜¯å¯ä»¥å¯¹åŸæ¥çš„æ¨¡å‹è¿›è¡Œæ”¹å–„ï¼Œè¿™æ˜¯åŸè®ºæ–‡æ²¡æœ‰è¿›è¡Œçš„æ“ä½œï¼Œå…·ä½“æœ‰ä¸¤ç§æ–¹æ³•ï¼Œåœ¨æ¨¡å‹ä¸æ”¹å˜çš„æƒ…å†µä¸‹\n\n**ç‰¹å¾é€‰æ‹©ï¼ˆFeature Selectionï¼‰** å’Œ **è¶…å‚æ•°è°ƒæ•´ï¼ˆHyperparameter Tuningï¼‰**\n\n#### ğŸ§  ä¸ºä»€ä¹ˆè¦è¿›è¡Œç‰¹å¾é€‰æ‹©ï¼Ÿ\n\n> **ç†å¿µï¼šå°‘å³æ˜¯å¤šï¼ˆLess is Moreï¼‰**\n\nåœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œä½¿ç”¨æ‰€æœ‰å˜é‡å¹¶ä¸æ€»æ˜¯æœ€å¥½çš„é€‰æ‹©ã€‚æœ‰äº›å˜é‡å¯èƒ½ï¼š\n\n-   ä¸ç›®æ ‡æ— å…³ï¼ˆå™ªå£°ï¼‰ï¼›\n\n-   ä¸å…¶ä»–å˜é‡é«˜åº¦å†—ä½™ï¼ˆé‡å¤ä¿¡æ¯ï¼‰ï¼›\n\n-   å¢åŠ æ¨¡å‹å¤æ‚åº¦ï¼Œå¯¼è‡´è¿‡æ‹Ÿåˆï¼›\n\n-   é™ä½æ¨¡å‹è§£é‡Šæ€§ï¼Œè®©ä¸´åºŠäººå‘˜éš¾ä»¥ç†è§£ã€‚\n\n### âœ… ç‰¹å¾é€‰æ‹©çš„å¥½å¤„ï¼š\n\n-   **æå‡æ¨¡å‹æ€§èƒ½**ï¼šå»é™¤æ— å…³å˜é‡åï¼Œæ¨¡å‹æ›´ä¸“æ³¨äºæœ‰æ•ˆä¿¡æ¯ï¼›\n\n-   **æé«˜è®­ç»ƒé€Ÿåº¦**ï¼šå˜é‡å°‘ï¼Œè®¡ç®—æ›´å¿«ï¼›\n\n-   **å¢å¼ºè§£é‡Šæ€§**ï¼šæ›´å®¹æ˜“å‘ä¸´åºŠäººå‘˜è§£é‡Šæ¨¡å‹å†³ç­–ï¼›\n\n-   **å‡å°‘è¿‡æ‹Ÿåˆé£é™©**ï¼šæ¨¡å‹æ›´ç¨³å¥ï¼Œæ³›åŒ–èƒ½åŠ›æ›´å¼ºã€‚\n\n#### ğŸ”§ ä¸ºä»€ä¹ˆè¦è¿›è¡Œè¶…å‚æ•°è°ƒæ•´ï¼Ÿ\n\n> **ç†å¿µï¼šæ¨¡å‹çš„â€œä¸ªæ€§åŒ–è®¾ç½®â€å†³å®šå®ƒçš„è¡¨ç°**\n\næ¯ä¸ªæœºå™¨å­¦ä¹ æ¨¡å‹éƒ½æœ‰ä¸€äº›â€œå†…éƒ¨è®¾ç½®â€ï¼Œç§°ä¸º**è¶…å‚æ•°**ï¼ˆhyperparametersï¼‰ï¼Œå®ƒä»¬ä¸æ˜¯ä»æ•°æ®ä¸­å­¦å‡ºæ¥çš„ï¼Œè€Œæ˜¯ä½ æå‰è®¾å®šçš„ã€‚\n\nä¾‹å¦‚ï¼š\n\n-   éšæœºæ£®æ—çš„ `n_estimators`ï¼ˆæ ‘çš„æ•°é‡ï¼‰ã€`max_depth`ï¼ˆæ ‘çš„æœ€å¤§æ·±åº¦ï¼‰ï¼›\n\n-   XGBoost çš„ `learning_rate`ï¼ˆå­¦ä¹ ç‡ï¼‰ã€`subsample`ï¼ˆæ ·æœ¬é‡‡æ ·æ¯”ä¾‹ï¼‰ï¼›\n\n-   LightGBM çš„ `num_leaves`ï¼ˆå¶å­æ•°ï¼‰ã€`min_data_in_leaf`ï¼ˆæ¯ä¸ªå¶å­æœ€å°‘æ ·æœ¬æ•°ï¼‰ã€‚\n\n### âœ… è¶…å‚æ•°è°ƒæ•´çš„å¥½å¤„ï¼š\n\n-   **æå‡æ¨¡å‹æ€§èƒ½**ï¼šæ‰¾åˆ°æœ€é€‚åˆå½“å‰æ•°æ®çš„å‚æ•°ç»„åˆï¼›\n\n-   **æ§åˆ¶æ¨¡å‹å¤æ‚åº¦**ï¼šé˜²æ­¢è¿‡æ‹Ÿåˆæˆ–æ¬ æ‹Ÿåˆï¼›\n\n-   **å¢å¼ºæ¨¡å‹ç¨³å®šæ€§**ï¼šæé«˜åœ¨ä¸åŒæ•°æ®åˆ’åˆ†ä¸‹çš„è¡¨ç°ä¸€è‡´æ€§ã€‚\n\n### ç‰¹å¾é€‰æ‹©ğŸ¤©\n\n```{python}\n#| echo: true\n\n# å¯¼å…¥æ‰€éœ€çš„åº“\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom sklearn.model_selection import cross_val_score\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.preprocessing import StandardScaler\n# --- 2. è¯†åˆ«æœ€é‡è¦çš„ç‰¹å¾ ---\n# Identify the most important features\n\n#å’Œä»¥å‰ä¸€æ ·å¯¼å…¥æ•°æ®\n# --- 1. åŠ è½½å¹¶å‡†å¤‡æ•°æ® (ä¸ä¹‹å‰ç›¸åŒ) ---\n# Load and Prepare the Data\n\n# !!! é‡è¦æç¤º: è¯·å°†ä¸‹é¢çš„è·¯å¾„ä¿®æ”¹ä¸ºæ‚¨ä¿å­˜ CSV æ–‡ä»¶çš„å®é™…ä½ç½® !!!\nfile_path = \"./synthetic_schizophrenia_data.csv\"\ndf = pd.read_csv(file_path)\n\ndf['High_SWB'] = (df['SWN_Total_Score'] >= 80).astype(int)\nX = df.drop(['SWN_Total_Score', 'High_SWB'], axis=1)\ny = df['High_SWB']\nX = pd.get_dummies(X, columns=['Education'], drop_first=True)\n\n\n\n\nprint(\"--- æ–¹æ³•ä¸€: ç‰¹å¾é€‰æ‹© ---\")\nprint(\"é¦–å…ˆï¼Œæˆ‘ä»¬è®­ç»ƒä¸€ä¸ªåŸºç¡€æ¨¡å‹æ¥è·å–ç‰¹å¾é‡è¦æ€§...\")\n\n# è®­ç»ƒä¸€ä¸ªä¸´æ—¶çš„éšæœºæ£®æ—æ¨¡å‹æ¥è·å–ç‰¹å¾é‡è¦æ€§æ’åº\ntemp_rf = RandomForestClassifier(n_estimators=500, max_depth=5, random_state=42)\ntemp_rf.fit(X, y)\n\n# åˆ›å»ºä¸€ä¸ªåŒ…å«ç‰¹å¾åç§°å’Œå…¶é‡è¦æ€§åˆ†æ•°çš„ DataFrame\nfeature_importances = pd.DataFrame({\n    'feature': X.columns,\n    'importance': temp_rf.feature_importances_\n}).sort_values('importance', ascending=False)\n\n# æ‰“å°æœ€é‡è¦çš„ç‰¹å¾\nprint(\"\\næ ¹æ®åŸºç¡€æ¨¡å‹å¾—å‡ºçš„ç‰¹å¾é‡è¦æ€§æ’åº:\")\nprint(feature_importances)\n```\n\n#### ğŸ“Š åˆ é™¤å»ºè®®ï¼ˆæŒ‰é‡è¦æ€§æ–­å±‚ï¼‰\n\næˆ‘æ‰“ç®—åˆ é™¤çš„å˜é‡ï¼Œå…¶é‡è¦æ€§å¦‚ä¸‹ï¼š\n\n| ç‰¹å¾åç§°                     | é‡è¦æ€§ |\n|------------------------------|--------|\n| DIEPSS_Overall_Severity      | 0.0267 |\n| Obesity                      | 0.0096 |\n| Diabetes                     | 0.0076 |\n| Occupation_Employed          | 0.0063 |\n| Education_High school        | 0.0061 |\n| Hypertension                 | 0.0049 |\n| Sex_Female                   | 0.0047 |\n| Education_Less than 12 years | 0.0043 |\n\nè¿™äº›å˜é‡éƒ½å’Œ `Age` çš„é‡è¦æ€§ï¼ˆ0.0408ï¼‰æ–­å±‚ï¼Œè¯´æ˜å®ƒä»¬å¯èƒ½å¯¹æ¨¡å‹é¢„æµ‹è´¡çŒ®éå¸¸æœ‰é™ã€‚\n\nä½†æ˜¯è€ƒè™‘åˆ°`DIEPSS_Oerall_Severity`å¯¹äºå®é™…æ„ä¹‰çš„ç¡®æœ‰å½±å“ï¼Œä¸”å’Œå…¶åé¢çš„ä¹Ÿæ–­å±‚äº†ï¼Œæ‰€ä»¥æˆ‘æ‰“ç®—ä¿ç•™\n\n***ç‰¹å¾é€‰æ‹©ä¸ä»…æ˜¯â€œæ•°å­¦é—®é¢˜â€ï¼Œä¹Ÿæ˜¯â€œé¢†åŸŸçŸ¥è¯†é—®é¢˜â€ã€‚***\n\næ‰€ä»¥æˆ‘ä»¬å·²ç»é€‰å‡ºäº†***10ä¸ªè´¡çŒ®æ¯”è¾ƒå¤§çš„ç‰¹å¾***\n\n```{python}\n#| echo: true\n# é€‰æ‹©æœ€é‡è¦çš„å‰ 10 ä¸ªç‰¹å¾\nN_TOP_FEATURES = 10\ntop_features = feature_importances['feature'].head(N_TOP_FEATURES).tolist()\nprint(f\"\\næˆ‘ä»¬å°†é€‰æ‹©æœ€é‡è¦çš„ {N_TOP_FEATURES} ä¸ªç‰¹å¾è¿›è¡Œå»ºæ¨¡: {top_features}\")\n\n# åˆ›å»ºåªåŒ…å«æœ€é‡è¦ç‰¹å¾çš„æ–°æ•°æ®é›†\nX_selected = X[top_features]\n\n# --- 3. åœ¨ç­›é€‰åçš„ç‰¹å¾ä¸Šé‡æ–°è¯„ä¼°æ¨¡å‹ ---\n# Re-evaluate the model on selected features\n\nprint(\"\\nä½¿ç”¨ç­›é€‰å‡ºçš„ç‰¹å¾è¿›è¡Œ5æŠ˜äº¤å‰éªŒè¯...\")\n# ä½¿ç”¨ä¸ä¹‹å‰ç›¸åŒçš„æ¨¡å‹é…ç½®\nmodel_on_selected_features = RandomForestClassifier(n_estimators=500, max_depth=5, random_state=42)\ncv_scores_selected = cross_val_score(model_on_selected_features, X_selected, y, cv=5, scoring='roc_auc')\n\n# æ‰“å°ç»“æœ\nmean_auc_selected = np.mean(cv_scores_selected)\nprint(f\"\\nä½¿ç”¨æœ€é‡è¦çš„ {N_TOP_FEATURES} ä¸ªç‰¹å¾, æ¨¡å‹çš„å¹³å‡ AUC åˆ†æ•°æ˜¯: {mean_auc_selected:.4f}\")\nprint(f\"åŸå§‹æ¨¡å‹çš„å¹³å‡ AUC åˆ†æ•°æ˜¯: 0.7980 (ä½œä¸ºå¯¹æ¯”)\")\n```\n\nä¸ºäº†åŠ ä»¥åŒºåˆ«ï¼Œæˆ‘ä»¬åˆ†åˆ«å¤åˆ¶ä»£ç ï¼Œé€‰å–9ä¸ªå’Œ11ä¸ªç‰¹å¾è¿›è¡Œè®­ç»ƒçœ‹çœ‹æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œå³å‰”é™¤`DIEPSS_Overall_Severity 0.026666` å’ŒåŠ ä¸Šä¸å¤ªé‡è¦çš„`Obesity 0.009579`çš„å˜é‡\n\n```{python}\n#| echo: true\n# é€‰æ‹©æœ€é‡è¦çš„å‰ 9 ä¸ªç‰¹å¾\n#å‰”é™¤DIEPSS_Overall_Severity 0.026666\nN_TOP_FEATURES = 9\ntop_features = feature_importances['feature'].head(N_TOP_FEATURES).tolist()\nprint(f\"\\næˆ‘ä»¬å°†é€‰æ‹©æœ€é‡è¦çš„ {N_TOP_FEATURES} ä¸ªç‰¹å¾è¿›è¡Œå»ºæ¨¡: {top_features}\")\n\n# åˆ›å»ºåªåŒ…å«æœ€é‡è¦ç‰¹å¾çš„æ–°æ•°æ®é›†\nX_selected = X[top_features]\n\n# --- 3. åœ¨ç­›é€‰åçš„ç‰¹å¾ä¸Šé‡æ–°è¯„ä¼°æ¨¡å‹ ---\n# Re-evaluate the model on selected features\n\nprint(\"\\nä½¿ç”¨ç­›é€‰å‡ºçš„ç‰¹å¾è¿›è¡Œ5æŠ˜äº¤å‰éªŒè¯...\")\n# ä½¿ç”¨ä¸ä¹‹å‰ç›¸åŒçš„æ¨¡å‹é…ç½®\nmodel_on_selected_features = RandomForestClassifier(n_estimators=500, max_depth=5, random_state=42)\ncv_scores_selected = cross_val_score(model_on_selected_features, X_selected, y, cv=5, scoring='roc_auc' )\n\n# æ‰“å°ç»“æœ\nmean_auc_selected = np.mean(cv_scores_selected)\nprint(f\"\\nä½¿ç”¨æœ€é‡è¦çš„ {N_TOP_FEATURES} ä¸ªç‰¹å¾, æ¨¡å‹çš„å¹³å‡ AUC åˆ†æ•°æ˜¯: {mean_auc_selected:.4f}\")\nprint(f\"åŸå§‹æ¨¡å‹çš„å¹³å‡ AUC åˆ†æ•°æ˜¯: 0.7980 (ä½œä¸ºå¯¹æ¯”)\")\n\n```\n\n```{python}\n#| echo: true\n# é€‰æ‹©æœ€é‡è¦çš„å‰ 11 ä¸ªç‰¹å¾\n# åŠ ä¸Šä¸å¤ªé‡è¦çš„Obesity 0.009579çš„å˜é‡\nN_TOP_FEATURES = 11\ntop_features = feature_importances['feature'].head(N_TOP_FEATURES).tolist()\nprint(f\"\\næˆ‘ä»¬å°†é€‰æ‹©æœ€é‡è¦çš„ {N_TOP_FEATURES} ä¸ªç‰¹å¾è¿›è¡Œå»ºæ¨¡: {top_features}\")\n\n# åˆ›å»ºåªåŒ…å«æœ€é‡è¦ç‰¹å¾çš„æ–°æ•°æ®é›†\nX_selected = X[top_features]\n\n# --- 3. åœ¨ç­›é€‰åçš„ç‰¹å¾ä¸Šé‡æ–°è¯„ä¼°æ¨¡å‹ ---\n# Re-evaluate the model on selected features\n\nprint(\"\\nä½¿ç”¨ç­›é€‰å‡ºçš„ç‰¹å¾è¿›è¡Œ5æŠ˜äº¤å‰éªŒè¯...\")\n# ä½¿ç”¨ä¸ä¹‹å‰ç›¸åŒçš„æ¨¡å‹é…ç½®\nmodel_on_selected_features = RandomForestClassifier(n_estimators=500, max_depth=5, random_state=42)\ncv_scores_selected = cross_val_score(model_on_selected_features, X_selected, y, cv=5, scoring='roc_auc')\n\n# æ‰“å°ç»“æœ\nmean_auc_selected = np.mean(cv_scores_selected)\nprint(f\"\\nä½¿ç”¨æœ€é‡è¦çš„ {N_TOP_FEATURES} ä¸ªç‰¹å¾, æ¨¡å‹çš„å¹³å‡ AUC åˆ†æ•°æ˜¯: {mean_auc_selected:.4f}\")\nprint(f\"åŸå§‹æ¨¡å‹çš„å¹³å‡ AUC åˆ†æ•°æ˜¯: 0.7980 (ä½œä¸ºå¯¹æ¯”)\")\n\n```\n\n#### ğŸ¯ æ•™å­¦æ€»ç»“ï¼šç‰¹å¾é€‰æ‹©çš„å®è¯ä»·å€¼\n\n| ç‰¹å¾æ•°é‡                           | å¹³å‡ AUC åˆ†æ•° | ç›¸å¯¹è¡¨ç°    |\n|------------------------------------|---------------|-------------|\n| åŸå§‹æ¨¡å‹ï¼ˆå…¨éƒ¨ç‰¹å¾ï¼‰               | 0.7980        | åŸºå‡†        |\n| æœ€é‡è¦çš„ 10 ä¸ªç‰¹å¾                 | **0.7991**    | âœ… æœ€ä½³è¡¨ç° |\n| æœ€é‡è¦çš„ 9 ä¸ªç‰¹å¾ï¼ˆå‰”é™¤ DIEPSSï¼‰   | 0.7975        | ç•¥ä½        |\n| æœ€é‡è¦çš„ 11 ä¸ªç‰¹å¾ï¼ˆåŠ å…¥ Obesityï¼‰ | 0.7974        | ç•¥ä½        |\n\n#### ğŸ§  è¦ç‚¹ä¸€ï¼šä¸æ˜¯ç‰¹å¾è¶Šå¤šè¶Šå¥½\n\n> å¢åŠ å˜é‡å¹¶ä¸ä¸€å®šæå‡æ¨¡å‹æ€§èƒ½ï¼Œåè€Œå¯èƒ½å¼•å…¥å™ªå£°æˆ–å†—ä½™ä¿¡æ¯ã€‚\n\n-   åŠ å…¥ **Obesityï¼ˆ0.009579ï¼‰** åï¼Œæ¨¡å‹æ€§èƒ½ç•¥å¾®ä¸‹é™ï¼›\n\n-   åˆ é™¤ **DIEPSSï¼ˆ0.026666ï¼‰** åï¼Œæ¨¡å‹ä¹Ÿç•¥å¾®ä¸‹é™ï¼›\n\n-   è¯´æ˜è¿™ä¸¤ä¸ªå˜é‡è™½ç„¶è´¡çŒ®ä¸å¤§ï¼Œä½†ä¹Ÿä¸æ˜¯å®Œå…¨æ— æ•ˆï¼Œå°¤å…¶ DIEPSS å¯èƒ½æœ‰ä¸€å®šä¸´åºŠè§£é‡Šä»·å€¼ã€‚\n\n#### ğŸ§  è¦ç‚¹äºŒï¼šæ‰¾åˆ°â€œæœ€ä½³å˜é‡ç»„åˆâ€æ‰æ˜¯å…³é”®\n\n> 10ä¸ªå˜é‡ç»„åˆçš„æ¨¡å‹è¡¨ç°æœ€å¥½ï¼Œè¯´æ˜å®ƒåœ¨ä¿¡æ¯é‡ä¸ç®€æ´æ€§ä¹‹é—´è¾¾åˆ°äº†å¹³è¡¡ã€‚\n\n-   è¿™ä¸ªç»„åˆæ—¢ä¿ç•™äº†é«˜è´¡çŒ®å˜é‡ï¼Œåˆé¿å…äº†ä½è´¡çŒ®å˜é‡çš„å¹²æ‰°ï¼›\n\n-   æ¨¡å‹æ›´å¿«ã€æ›´ç¨³å®šã€æ›´æ˜“è§£é‡Šï¼›ã€‚\n\n#### ğŸ§  è¦ç‚¹ä¸‰ï¼šè¿›è¡Œâ€œå˜é‡æ•æ„Ÿæ€§åˆ†æâ€\n\n-   é€ä¸ªæ·»åŠ æˆ–å‰”é™¤å˜é‡ï¼Œè§‚å¯Ÿæ¨¡å‹æ€§èƒ½å˜åŒ–ï¼›\n\n-   ç»“åˆé¢†åŸŸçŸ¥è¯†åˆ¤æ–­æ˜¯å¦ä¿ç•™æŸäº›ä¸´åºŠé‡è¦ä½†æ¨¡å‹è´¡çŒ®è¾ƒä½çš„å˜é‡ï¼›\n\n-   ç”¨å›¾è¡¨å±•ç¤º AUC éšå˜é‡æ•°é‡å˜åŒ–çš„è¶‹åŠ¿ï¼Œå¼ºåŒ–â€œå˜é‡é€‰æ‹©æ˜¯ç­–ç•¥æ€§å†³ç­–â€çš„ç†å¿µã€‚\n\n### è¶…å‚æ•°è°ƒä¼˜ğŸƒ\n\nä¾‹å¦‚ï¼Œå‡è®¾ n_estimators=500ï¼Œmax_depth=5ï¼Œä½†è¿™äº›è®¾ç½®å¯èƒ½å¹¶éæˆ‘ä»¬ç‰¹å®šâ€œèµ›é“â€ï¼ˆæ•°æ®é›†ï¼‰çš„æœ€ä½³è®¾ç½®ã€‚é€šè¿‡ç³»ç»Ÿåœ°å°è¯•è¿™äº›è®¾ç½®çš„ä¸åŒç»„åˆï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°èƒ½å¤Ÿå®ç°æœ€ä½³æ€§èƒ½çš„é…ç½® \\#### å…ˆæ˜¯ç½‘æ ¼æœç´¢\n\næ‰‹åŠ¨å®šä¹‰ä¸€ä¸ªå›ºå®šçš„ param_grid ç„¶åè¿›è¡Œâ€œæš´åŠ›â€æœç´¢ï¼ˆBrute-force Searchï¼‰ï¼Œæ˜¯è¶…å‚æ•°è°ƒä¼˜æœ€åŸºç¡€çš„æ–¹æ³•\n\n```{python}\n#| echo: true\n# å¯¼å…¥ GridSearchCV\nfrom sklearn.model_selection import GridSearchCV\n\nprint(\"\\n\\n--- æ–¹æ³•äºŒ: è¶…å‚æ•°è°ƒä¼˜ (è¿™å¯èƒ½éœ€è¦å‡ åˆ†é’Ÿ) ---\")\n\n# --- 1. å®šä¹‰è¦æœç´¢çš„è¶…å‚æ•°ç½‘æ ¼ ---\n# Define the parameter grid to search\n\n# è¿™æ˜¯ä¸€ä¸ªæˆ‘ä»¬è¦æµ‹è¯•çš„è¶…å‚æ•°ç»„åˆçš„ \"èœå•\"\nparam_grid = {\n    'n_estimators': [200, 400, 600],       # æ ‘çš„æ•°é‡\n    'max_depth': [4, 5, 6, 7],             # æ ‘çš„æœ€å¤§æ·±åº¦\n    'min_samples_leaf': [1, 3, 5],         # ä¸€ä¸ªå¶èŠ‚ç‚¹ä¸Šæœ€å°‘çš„æ ·æœ¬æ•°\n    'max_features': ['sqrt', 'log2']       # æ¯æ¬¡åˆ†è£‚æ—¶è€ƒè™‘çš„æœ€å¤§ç‰¹å¾æ•°\n}\n\n# --- 2. è®¾ç½®å¹¶è¿è¡Œ GridSearchCV ---\n# Setup and run GridSearchCV\n\n# åˆå§‹åŒ–æˆ‘ä»¬çš„åŸºç¡€æ¨¡å‹\nrf_base = RandomForestClassifier(random_state=42)\n\n# è®¾ç½® GridSearchCV\n# estimator: æˆ‘ä»¬è¦è°ƒä¼˜çš„æ¨¡å‹\n# param_grid: æˆ‘ä»¬å®šä¹‰çš„å‚æ•°ç½‘æ ¼\n# cv=5: ä½¿ç”¨5æŠ˜äº¤å‰éªŒè¯æ¥è¯„ä¼°æ¯ä¸€ç§å‚æ•°ç»„åˆ\n# scoring='roc_auc': æˆ‘ä»¬çš„è¯„ä¼°æŒ‡æ ‡\n\ngrid_search = GridSearchCV(estimator=rf_base, param_grid=param_grid, cv=5, scoring='roc_auc' , verbose=1)\n\n# åœ¨å®Œæ•´æ•°æ®é›†ä¸Šè¿è¡Œç½‘æ ¼æœç´¢\ngrid_search.fit(X, y)\n\n# --- 3. æ‰“å°æœ€ä½³ç»“æœ ---\n# Print the best results\n\nprint(\"\\nè¶…å‚æ•°è°ƒä¼˜å®Œæˆ!\")\n\n# æ‰“å°æ‰¾åˆ°çš„æœ€ä½³å‚æ•°ç»„åˆ\nprint(f\"æ‰¾åˆ°çš„æœ€ä½³è¶…å‚æ•°ç»„åˆ (Best Parameters): \\n{grid_search.best_params_}\")\n\n# æ‰“å°ä½¿ç”¨æœ€ä½³å‚æ•°æ—¶ï¼Œäº¤å‰éªŒè¯å¾—åˆ°çš„æœ€ä½³AUCåˆ†æ•°\nprint(f\"\\nä½¿ç”¨æœ€ä½³å‚æ•°æ—¶ï¼Œæ¨¡å‹çš„æœ€ä½³å¹³å‡ AUC åˆ†æ•°æ˜¯: {grid_search.best_score_:.4f}\")\n\n```\n\nä½¿ç”¨æœ€ä½³å‚æ•°æ—¶ï¼Œæ¨¡å‹çš„æœ€ä½³å¹³å‡ AUC åˆ†æ•°æ˜¯: 0.7997 æ­£å¦‚æˆ‘è¯´ï¼Œç½‘æ ¼æœç´¢æ˜¯è¶…å‚æ•°æœ€åŸºç¡€çš„æ–¹æ³•ï¼Œä½†å®ƒæœ‰ä¸¤ä¸ªä¸»è¦ç¼ºç‚¹ï¼š\n\n1.  **ç»´åº¦è¯…å’’ (Curse of Dimensionality):** å½“å‚æ•°å’Œä½ æƒ³å°è¯•çš„å€¼å˜å¤šæ—¶ï¼Œç»„åˆçš„æ•°é‡ä¼šå‘ˆæŒ‡æ•°çº§å¢é•¿ï¼Œå¯¼è‡´è®¡ç®—æˆæœ¬æé«˜ï¼Œéå¸¸è€—æ—¶ã€‚\n\n2.  **æ•ˆç‡ä½ä¸‹:** å®ƒä¼šèŠ±è´¹å¤§é‡æ—¶é—´å»å°è¯•é‚£äº›æ˜æ˜¾ä¸ä½³çš„å‚æ•°ç»„åˆã€‚\n\næ¥ä¸‹æ¥æˆ‘ä¼šç”¨ä¸€ä¸ªæ›´åŠ çˆ½çš„æ–¹æ³•ï¼Œ***å³è´å¶æ–¯ä¼˜åŒ–***\n\nè¿™æ˜¯ç›®å‰æœ€å…ˆè¿›å’Œæœ€é«˜æ•ˆçš„è°ƒä¼˜æ–¹æ³•ä¹‹ä¸€ï¼Œå®ƒå®Œç¾åœ°ä½“ç°äº†â€œè¿­ä»£é€‰æ‹©æœ€å¥½â€çš„æ€æƒ³ã€‚\n\n**æ ¸å¿ƒæ€æƒ³ï¼š**\\\nè´å¶æ–¯ä¼˜åŒ–ä¼šå»ºç«‹ä¸€ä¸ªå…³äºâ€œå“ªä¸ªå‚æ•°ç»„åˆå¯èƒ½å¾—åˆ°æ›´é«˜åˆ†æ•°â€çš„æ¦‚ç‡æ¨¡å‹ã€‚\n\n1.  å®ƒé¦–å…ˆå°è¯•å‡ ä¸ªéšæœºçš„å‚æ•°ç»„åˆã€‚\n\n2.  ç„¶åï¼Œå®ƒæ ¹æ®å·²æœ‰çš„ç»“æœï¼Œæ›´æ–°å†…éƒ¨çš„æ¦‚ç‡æ¨¡å‹ï¼Œé¢„æµ‹å‡ºâ€œæœ€æœ‰å¸Œæœ›â€æå‡åˆ†æ•°çš„ä¸‹ä¸€ä¸ªå‚æ•°ç»„åˆã€‚\n\n3.  å®ƒä¼šå»å°è¯•è¿™ä¸ªâ€œæœ€æœ‰å¸Œæœ›â€çš„ç»„åˆï¼Œç„¶åå†æ¬¡æ›´æ–°æ¨¡å‹ã€‚\n\n4.  è¿™ä¸ªè¿‡ç¨‹ä¼šä¸æ–­è¿­ä»£ï¼Œæ™ºèƒ½åœ°å°†æœç´¢èµ„æºé›†ä¸­åœ¨å‚æ•°ç©ºé—´ä¸­æœ€æœ‰æ½œåŠ›çš„åŒºåŸŸã€‚\n\n**æ‰“ä¸ªæ¯”æ–¹ï¼š** è¿™å°±åƒåœ¨ä¸€ä¸ªå¤§é›¾å¼¥æ¼«çš„å±±åŒºé‡Œæ‰¾æœ€é«˜å³°ã€‚ä½ ä¸ä¼šåœ¨åœ°æ¯¯å¼æœç´¢æ¯ä¸€å¯¸åœŸåœ°ï¼ˆç½‘æ ¼æœç´¢ï¼‰ï¼Œè€Œæ˜¯æ ¹æ®ä½ å½“å‰æ‰€åœ¨ä½ç½®çš„é«˜åº¦å’Œå¡åº¦ï¼Œæ¥åˆ¤æ–­ä¸‹ä¸€æ­¥å¾€å“ªä¸ªæ–¹å‘èµ°æœ€æœ‰å¯èƒ½ç™»å¾—æ›´é«˜ã€‚\n\n**ğŸ¥¸ä¸è¿‡éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºæ˜¯éšæœºç»„åˆï¼Œæ¯æ¬¡è¿œè¡Œä»£ç å¾—åˆ°çš„æœ€å¥½çš„ç»“æœéƒ½ä¸ä¸€æ ·ï¼Œå°±å¥½åƒåœ¨ä¹Œæ³±æ³±çš„å¤§æµ·æ‰¾æœ€å¤§çš„èˆ¹ï¼Œæœ‰çš„æ—¶å€™ä½ ä¸ä¸€å®šèƒ½æ‰¾åˆ°å±±ä¸œèˆ°èˆªæ¯ï¼Œå¯èƒ½åªä¼šæ‰¾åˆ°æŠ¤å«èˆ°**\n\n```{python}\n#| echo: true\n# å¯¼å…¥ optuna åº“\nimport optuna\nfrom sklearn.model_selection import cross_val_score\n\nprint(\"\\n\\n--- æœ€æ™ºèƒ½çš„è°ƒä¼˜æ–¹æ³•äºŒ: è´å¶æ–¯ä¼˜åŒ– (Bayesian Optimization with Optuna) ---\")\nprint(\"Optuna ä¼šæ ¹æ®å†å²ç»“æœï¼Œæ™ºèƒ½åœ°é€‰æ‹©ä¸‹ä¸€æ¬¡è¦å°è¯•çš„è¶…å‚æ•°...\")\n\n# --- 1. å®šä¹‰ä¸€ä¸ª \"ç›®æ ‡å‡½æ•°\" (Objective Function) ---\n# è¿™ä¸ªå‡½æ•°å‘Šè¯‰ Optuna å¦‚ä½•è¯„ä¼°ä¸€ç»„è¶…å‚æ•°çš„å¥½å\ndef objective(trial):\n    # 'trial' å¯¹è±¡ç”¨äºå»ºè®®è¶…å‚æ•°çš„å€¼\n    # Optuna ä¼šæ™ºèƒ½åœ°å†³å®šå»ºè®®å€¼çš„èŒƒå›´å’Œå…·ä½“å€¼\n    params = {\n        'n_estimators': trial.suggest_int('n_estimators', 200, 800), # å»ºè®®ä¸€ä¸ªåœ¨ [200, 800] èŒƒå›´å†…çš„æ•´æ•°\n        'max_depth': trial.suggest_int('max_depth', 3, 10),\n        'min_samples_leaf': trial.suggest_int('min_samples_leaf', 1, 10),\n        'max_features': trial.suggest_categorical('max_features', ['sqrt', 'log2']),\n    }\n    \n    # ä½¿ç”¨è¿™ç»„å‚æ•°åˆ›å»ºå¹¶è¯„ä¼°æ¨¡å‹\n    model = RandomForestClassifier(random_state=42, **params)\n    \n    # ä½¿ç”¨äº¤å‰éªŒè¯æ¥è·å¾—ç¨³å¥çš„åˆ†æ•°\n    score = cross_val_score(model, X, y, cv=5, scoring='roc_auc', ).mean()\n    \n    # Optuna çš„ç›®æ ‡æ˜¯æœ€å¤§åŒ–è¿™ä¸ªè¿”å›å€¼\n    return score\n\n# --- 2. åˆ›å»ºä¸€ä¸ª \"ç ”ç©¶\" (Study) å¹¶å¼€å§‹ä¼˜åŒ– ---\n# direction='maximize': å‘Šè¯‰ Optuna æˆ‘ä»¬çš„ç›®æ ‡æ˜¯æœ€å¤§åŒ– objective å‡½æ•°çš„è¿”å›å€¼\nstudy = optuna.create_study(direction='maximize', study_name='RF_Optimization')\n\n# n_trials=100: è¿è¡Œ100æ¬¡è¿­ä»£ã€‚Optuna ä¼šåœ¨è¿™100æ¬¡ä¸­æ™ºèƒ½åœ°å¯»æ‰¾æœ€ä¼˜è§£ã€‚\nstudy.optimize(objective, n_trials=100)\n\n# --- 3. æ‰“å°æœ€ä½³ç»“æœ ---\nprint(\"\\nè´å¶æ–¯ä¼˜åŒ–å®Œæˆ!\")\nprint(f\"è¿­ä»£æ¬¡æ•° (Number of finished trials): {len(study.trials)}\")\nprint(f\"æ‰¾åˆ°çš„æœ€ä½³è¶…å‚æ•°ç»„åˆ (Best Parameters): \\n{study.best_params}\")\nprint(f\"\\nä½¿ç”¨æœ€ä½³å‚æ•°æ—¶ï¼Œæ¨¡å‹çš„æœ€ä½³å¹³å‡ AUC åˆ†æ•°æ˜¯: {study.best_value:.4f}\")\n\n```\n\nä½¿ç”¨æœ€ä½³å‚æ•°æ—¶ï¼Œæ¨¡å‹çš„æœ€ä½³å¹³å‡ AUC åˆ†æ•°æ˜¯: 0.8042(å·®ä¸å¤šè¿œè¡Œäº†å¥½å‡ æ¬¡çš„æœ€å¥½æ•°æ®),è¿™æ˜¯è¿­ä»£åªæœ‰100æ¬¡ï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥å¤šè¿­ä»£ï¼Œè®¾ç½®åˆ°200ï¼Œ500ç­‰ç­‰ï¼Œåªè¦ä½ çš„è®¡ç®—æœºèƒ½æŠ—ä½ã€‚\n\n### æœ€ç»ˆä¼˜åŒ–ï¼šç»“åˆç‰¹å¾é€‰æ‹©ä¸è´å¶æ–¯è°ƒä¼˜ğŸ¤¤\n\n**ç›®æ ‡**ï¼š åœ¨æˆ‘ä»¬å·²ç»éªŒè¯è¿‡çš„â€œæœ€ä½³ç‰¹å¾é›†â€ï¼ˆæœ€é‡è¦çš„10ä¸ªç‰¹å¾ï¼‰ä¸Šï¼Œä½¿ç”¨è´å¶æ–¯ä¼˜åŒ–ï¼ˆOptunaï¼‰æ¥å¯»æ‰¾æœ€ä¼˜çš„è¶…å‚æ•°ç»„åˆï¼Œä»è€Œè·å¾—ç†è®ºä¸Šæ€§èƒ½æœ€å¥½çš„æ¨¡å‹\n\n```{python}\n#| echo: true\n# å¯¼å…¥æ‰€æœ‰éœ€è¦çš„åº“\nimport pandas as pd\nimport numpy as np\nimport optuna\nfrom sklearn.model_selection import cross_val_score\nfrom sklearn.ensemble import RandomForestClassifier\n\n# --- 1. æœ€ç»ˆæ­¥éª¤ä¸€ï¼šç¡®å®šå¹¶ç­›é€‰å‡ºæœ€ä½³ç‰¹å¾é›† (Top 10) ---\n# The first step of our final process: identify and select the best feature set.\n\n# !!! é‡è¦æç¤º: è¯·å°†ä¸‹é¢çš„è·¯å¾„ä¿®æ”¹ä¸ºæ‚¨ä¿å­˜ CSV æ–‡ä»¶çš„å®é™…ä½ç½® !!!\nfile_path = \"./synthetic_schizophrenia_data.csv\"\ndf = pd.read_csv(file_path)\n\ndf['High_SWB'] = (df['SWN_Total_Score'] >= 80).astype(int)\nX = df.drop(['SWN_Total_Score', 'High_SWB'], axis=1)\ny = df['High_SWB']\nX = pd.get_dummies(X, columns=['Education'], drop_first=True)\n\n\n# è®­ç»ƒä¸€ä¸ªä¸´æ—¶æ¨¡å‹æ¥è·å–ç‰¹å¾é‡è¦æ€§\ntemp_rf = RandomForestClassifier(n_estimators=500, max_depth=5, random_state=42, )\ntemp_rf.fit(X, y)\n\n# è·å–æœ€é‡è¦çš„10ä¸ªç‰¹å¾çš„åç§°\nN_TOP_FEATURES = 10\nfeature_importances = pd.DataFrame({\n    'feature': X.columns,\n    'importance': temp_rf.feature_importances_\n}).sort_values('importance', ascending=False)\ntop_10_features = feature_importances['feature'].head(N_TOP_FEATURES).tolist()\n\n# åˆ›å»ºåªåŒ…å«è¿™10ä¸ªç‰¹å¾çš„æ–°æ•°æ®é›†\nX_top10 = X[top_10_features]\n\nprint(\"--- æœ€ç»ˆä¼˜åŒ–æµç¨‹ ---\")\nprint(f\"å·²æˆåŠŸç­›é€‰å‡ºæœ€é‡è¦çš„ {N_TOP_FEATURES} ä¸ªç‰¹å¾ç”¨äºæœ€ç»ˆè°ƒä¼˜:\")\nprint(top_10_features)\n\n\n# --- 2. æœ€ç»ˆæ­¥éª¤äºŒï¼šåœ¨æœ€ä½³ç‰¹å¾é›†ä¸Šè¿›è¡Œè´å¶æ–¯ä¼˜åŒ– ---\n# The second step: run Bayesian Optimization on this optimal feature set.\n\nprint(\"\\nç°åœ¨ï¼Œæˆ‘ä»¬åªåœ¨è¿™10ä¸ªç‰¹å¾ä¸Šè¿›è¡Œè´å¶æ–¯ä¼˜åŒ– (Optuna)...\")\n\n# å®šä¹‰ç›®æ ‡å‡½æ•°ï¼Œä¸ä¹‹å‰ç±»ä¼¼ï¼Œä½†è¿™æ¬¡ä½¿ç”¨çš„æ˜¯ç­›é€‰åçš„æ•°æ®\ndef objective_top10(trial):\n    # å®šä¹‰è¶…å‚æ•°æœç´¢ç©ºé—´\n    params = {\n        'n_estimators': trial.suggest_int('n_estimators', 200, 800),\n        'max_depth': trial.suggest_int('max_depth', 3, 10),\n        'min_samples_leaf': trial.suggest_int('min_samples_leaf', 1, 10),\n        'max_features': trial.suggest_categorical('max_features', ['sqrt', 'log2']),\n    }\n    \n    model = RandomForestClassifier(random_state=42, **params)\n    \n    # ï¼ï¼ï¼ å…³é”®ä¸åŒç‚¹ ï¼ï¼ï¼\n    # æ³¨æ„ï¼šæˆ‘ä»¬åœ¨è¿™é‡Œä½¿ç”¨ X_top10ï¼Œè€Œä¸æ˜¯å®Œæ•´çš„ X\n    # CRITICAL DIFFERENCE: We are using X_top10 here, not the full X.\n    score = cross_val_score(model, X_top10, y, cv=5, scoring='roc_auc').mean()\n    \n    return score\n\n# åˆ›å»ºä¸€ä¸ªæ–°çš„ \"ç ”ç©¶\" (Study)\nstudy_top10 = optuna.create_study(direction='maximize', study_name='RF_Top10_Optimization')\n\n# è¿è¡Œä¼˜åŒ–ï¼Œn_trials å¯ä»¥æ ¹æ®éœ€è¦è°ƒæ•´\nstudy_top10.optimize(objective_top10, n_trials=100)\n\n# --- 3. æ‰“å°æœ€ç»ˆä¼˜åŒ–ç»“æœ ---\n# Print the final optimization results\n\nbest_params_top10 = study_top10.best_params\nbest_score_top10 = study_top10.best_value\n\nprint(\"\\nåœ¨Top 10ç‰¹å¾é›†ä¸Šçš„è´å¶æ–¯ä¼˜åŒ–å®Œæˆ!\")\nprint(f\"æ‰¾åˆ°çš„æœ€ä½³è¶…å‚æ•°ç»„åˆ (Best Parameters): \\n{best_params_top10}\")\nprint(f\"\\næœ€ç»ˆæ¨¡å‹çš„æœ€ä½³å¹³å‡ AUC åˆ†æ•°æ˜¯: {best_score_top10:.4f}\")\n\n# --- 4. è®­ç»ƒæœ€ç»ˆçš„ã€æœ€ä¼˜åŒ–çš„æ¨¡å‹ ---\n# Train the final, most optimized model\n\nprint(\"\\næ­£åœ¨ä½¿ç”¨æ‰¾åˆ°çš„æœ€ä½³ç‰¹å¾å’Œæœ€ä½³è¶…å‚æ•°æ¥è®­ç»ƒæœ€ç»ˆæ¨¡å‹...\")\nfinal_model = RandomForestClassifier(random_state=42,  **best_params_top10)\nfinal_model.fit(X_top10, y)\n\nprint(\"æœ€ç»ˆæ¨¡å‹è®­ç»ƒå®Œæˆï¼è¿™ä¸ªæ¨¡å‹æ˜¯æˆ‘ä»¬æ•´ä¸ªåˆ†æè¿‡ç¨‹çš„æœ€ç»ˆæˆæœã€‚\")\n\n```\n\nåŒæ ·è¿è¡Œäº†å¥½å‡ æ¬¡ï¼Œå¾—åˆ°äº†è¾ƒå¥½çš„æ•°æ®ï¼Œ***æ˜¯æœ€ç»ˆæ¨¡å‹çš„æœ€ä½³å¹³å‡ AUC åˆ†æ•°æ˜¯: 0.8044***\n\n***AUC æ¥è¿‘ 0.805 é€šå¸¸æ„å‘³ç€æ¨¡å‹å·²ç»æ•æ‰åˆ°äº†æ•°æ®ä¸­å¤§éƒ¨åˆ†çš„å¯é¢„æµ‹ç»“æ„ã€‚è¿™å°±æ˜¯æˆ‘ä»¬åœ¨æœºå™¨å­¦ä¹ ä¸­å¸¸è¯´çš„â€œæ€§èƒ½ç“¶é¢ˆâ€ï¼šå†æ€ä¹ˆè°ƒå‚ã€é€‰ç‰¹å¾ï¼Œæå‡ç©ºé—´å·²ç»éå¸¸æœ‰é™ï¼Œè¿™æ˜¯æˆ‘ä»¬éšæœºæ£®æ—çš„æé™äº†ï¼Œé™¤éæ¢ä¸€ä¸ªæ›´åŠ é€‚é…è¿™ä¸ªæ•°æ®çš„æœºå™¨å­¦ä¹ æ¨¡å‹ã€‚***\n\n***æ¨¡å‹çš„æ€§èƒ½ä¸Šé™ï¼Œå¾€å¾€ä¸æ˜¯ç”±ç®—æ³•å†³å®šçš„ï¼Œè€Œæ˜¯ç”±æ•°æ®æœ¬èº«çš„å¯é¢„æµ‹æ€§å†³å®šçš„ã€‚ å¦‚æœæ•°æ®ä¸­æ²¡æœ‰æ›´å¤šâ€œå¯è§£é‡Šçš„ä¿¡å·â€ï¼Œå†å¤æ‚çš„æ¨¡å‹ä¹Ÿæ— æ³•å‡­ç©ºåˆ›é€ é¢„æµ‹èƒ½åŠ›ã€‚***\n\n#### 1. æ¦‚å¿µå¼•å…¥ï¼šæ€§èƒ½å¤©èŠ±æ¿ä¸ä¸å¯çº¦å‡è¯¯å·® (Irreducible Error)ğŸ§‰\n\næ€§èƒ½å¤©èŠ±æ¿ï¼ˆPerformance Ceilingï¼‰ã€‚â€\n\n**æ ¸å¿ƒçŸ¥è¯†ç‚¹ï¼š**\\\nåœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œä¸€ä¸ªæ¨¡å‹çš„æ€»è¯¯å·®å¯ä»¥è¢«åˆ†è§£ä¸ºä¸¤éƒ¨åˆ†ï¼š\n\n**æ€»è¯¯å·® = å¯çº¦å‡è¯¯å·® (Reducible Error) + ä¸å¯çº¦å‡è¯¯å·® (Irreducible Error)**\n\n-   **å¯çº¦å‡è¯¯å·®ï¼š** è¿™æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡é€‰æ‹©æ›´å¥½çš„æ¨¡å‹ã€åšç‰¹å¾å·¥ç¨‹ã€è°ƒä¼˜è¶…å‚æ•°æ¥å‡å°‘çš„éƒ¨åˆ†ã€‚æˆ‘ä»¬ä¹‹å‰åšçš„æ‰€æœ‰å·¥ä½œï¼Œéƒ½æ˜¯åœ¨åŠªåŠ›**å°†è¿™éƒ¨åˆ†è¯¯å·®é™åˆ°æœ€ä½**ã€‚\n\n-   **ä¸å¯çº¦å‡è¯¯å·®ï¼š** è¿™æ˜¯æ•°æ®æœ¬èº«å›ºæœ‰çš„ã€æ— æ³•è¢«ä»»ä½•æ¨¡å‹æ¶ˆé™¤çš„â€œå™ªå£°â€æˆ–ä¸ç¡®å®šæ€§ã€‚**è¿™ä¸ªè¯¯å·®å†³å®šäº†æˆ‘ä»¬æ€§èƒ½å¤©èŠ±æ¿çš„é«˜åº¦ã€‚**\n\n-   **æ‰“ä¸ªæ¯”æ–¹ (Analogy):**\\\n    è¿™å°±åƒç”¨éº¦å…‹é£å½•éŸ³ã€‚æˆ‘ä»¬å¯ä»¥ä¹°æ›´å¥½çš„éº¦å…‹é£ã€è°ƒæ•´å½•éŸ³æ£šçš„ç¯å¢ƒæ¥å‡å°‘èƒŒæ™¯å™ªéŸ³ï¼ˆé™ä½**å¯çº¦å‡è¯¯å·®**ï¼‰ã€‚ä½†æ˜¯ï¼Œå£°éŸ³æœ¬èº«çš„ä¸€äº›å¾®å°é¢¤åŠ¨ã€ç©ºæ°”ä¸­çš„éšæœºåˆ†å­è¿åŠ¨æ˜¯æ— æ³•è¢«æ¶ˆé™¤çš„ï¼ˆ**ä¸å¯çº¦å‡è¯¯å·®**ï¼‰ã€‚æˆ‘ä»¬èƒ½åšçš„ï¼Œå°±æ˜¯å°½å¯èƒ½æ¸…æ™°åœ°æ•æ‰åˆ°â€œä¿¡å·â€ï¼Œä½†æˆ‘ä»¬æ— æ³•æ¶ˆé™¤æ‰€æœ‰çš„â€œå™ªå£°â€ã€‚\n\n#### æ•™å­¦æ€»ç»“ï¼šå½“æˆ‘ä»¬è§¦åŠå¤©èŠ±æ¿æ—¶ï¼Œè¯¥åšä»€ä¹ˆğŸ¤–ï¼Ÿ\n\nè¿™æ˜¯æœ€å…³é”®çš„æ•™å­¦éƒ¨åˆ†ã€‚å½“æ¨¡å‹è°ƒä¼˜ä¸å†æœ‰æ•ˆæ—¶ï¼ŒçœŸæ­£çš„æ•°æ®ç§‘å­¦å®¶ä¼šä»ä»¥ä¸‹å‡ ä¸ªæ–¹é¢æ€è€ƒï¼Œè¿™ä¹Ÿæ˜¯æœªæ¥çš„å·¥ä½œæ–¹å‘ï¼š\n\n**è·¯å¾„ Aï¼šè·å–æ›´å¥½çš„æ•°æ® (æ•°æ®ä¸ºä¸­å¿ƒ - The Data-Centric Approach)**\\\nè¿™æ˜¯**æœ€é‡è¦ã€æœ€æœ‰æ•ˆ**çš„è·¯å¾„ã€‚\n\n-   **è¡ŒåŠ¨ï¼š** ä¸é¢†åŸŸä¸“å®¶ï¼ˆç²¾ç¥ç§‘åŒ»ç”Ÿã€å¿ƒç†å­¦å®¶ï¼‰åˆä½œï¼Œè®¨è®ºæ˜¯å¦å¯ä»¥æ”¶é›†æ–°çš„ã€å¯èƒ½ä¸ä¸»è§‚å¹¸ç¦æ„Ÿç›¸å…³çš„æ•°æ®ã€‚æ¯”å¦‚ï¼Œåœ¨ä¸‹ä¸€æ¬¡ç ”ç©¶ä¸­åŠ å…¥â€œç¤¾ä¼šæ”¯æŒé‡è¡¨â€ã€â€œç”Ÿæ´»äº‹ä»¶è®°å½•â€ç­‰ã€‚\n\n-   **ç»“è®ºï¼š** **æå‡æ€§èƒ½å¤©èŠ±æ¿çš„æœ€å¥½æ–¹æ³•ï¼Œæ˜¯ä¸ºæ¨¡å‹æä¾›æ›´é«˜ä¿¡å™ªæ¯”ã€æ›´ä¸°å¯Œä¿¡æ¯çš„æ•°æ®ã€‚**\n\n**è·¯å¾„ Bï¼šå°è¯•å®Œå…¨ä¸åŒçš„æ¨¡å‹ (æ¨¡å‹ä¸ºä¸­å¿ƒ - The Model-Centric Approach)**\n\n-   **è¡ŒåŠ¨ï¼š** æˆ‘ä»¬å·²ç»è¯æ˜äº†éšæœºæ£®æ—ï¼ˆä¸€ç§åŸºäºå†³ç­–æ ‘çš„é›†æˆæ¨¡å‹ï¼‰çš„æé™ã€‚æˆ‘ä»¬å¯ä»¥å°è¯•ç»“æ„å®Œå…¨ä¸åŒçš„æ¨¡å‹ï¼Œæ¯”å¦‚ï¼š\n\n    -   **æ·±åº¦å­¦ä¹ /ç¥ç»ç½‘ç»œ (Deep Learning / Neural Networks):** å¦‚æœæœ‰***è¶³å¤Ÿå¤šçš„æ•°æ®***ï¼Œç¥ç»ç½‘ç»œèƒ½å¤Ÿæ•æ‰åˆ°æ¯”æ ‘æ¨¡å‹æ›´é«˜é˜¶ã€æ›´å¤æ‚çš„éçº¿æ€§å…³ç³»ã€‚\n\n    -   **æ¢¯åº¦æå‡æœº (Gradient Boosting Machines):** æˆ‘ä»¬å¯ä»¥å¯¹ä¹‹å‰æµ‹è¯•è¿‡çš„ XGBoost æˆ– LightGBM æ¨¡å‹è¿›è¡ŒåŒæ ·æ·±å…¥çš„ç‰¹å¾é€‰æ‹©å’Œè´å¶æ–¯ä¼˜åŒ–ï¼Œæœ‰æ—¶å®ƒä»¬åœ¨ç‰¹å®šæ•°æ®é›†ä¸Šçš„è¡¨ç°ä¼šç•¥èƒœäºéšæœºæ£®æ—ã€‚\n\n-   **ç»“è®ºï¼š** æ¢ä¸€ä¸ªæ›´å¼ºå¤§çš„æ¨¡å‹**æœ‰å¯èƒ½**ä¼šç•¥å¾®æå‡æ€§èƒ½ï¼Œä½†è¿™é€šå¸¸æ˜¯åœ¨æ•°æ®è´¨é‡å·²ç»å¾ˆå¥½çš„å‰æä¸‹ã€‚å¦‚æœæ•°æ®æœ¬èº«ä¿¡æ¯é‡æœ‰é™ï¼Œæ¢æ¨¡å‹ä¹Ÿåªæ˜¯â€œé”¦ä¸Šæ·»èŠ±â€ï¼Œè€Œä¸ä¼šæœ‰è´¨çš„é£è·ƒã€‚\n\n------------------------------------------------------------------------\n\n## è®ºæ–‡æ€»ç»“ğŸ¤—\n\nthis is what it is æ²¡ä»€ä¹ˆæ€»ç»“çš„ï¼Œ**æˆ‘ä»¬çš„æœºå™¨å­¦ä¹ å¾—åˆ°äº†åœ¨æˆ‘ä»¬æµ‹é‡çš„æ‰€æœ‰äº‹ç‰©ä¸­ï¼Œå“ªäº›ä¸æ‚£è€…çš„ä¸»è§‚å¹¸ç¦æ„Ÿæœ€å¯†åˆ‡ç›¸å…³ï¼Ÿå³ OCSã€èº¯ä½“åŒ–ã€è®¤çŸ¥å’ŒæŠ‘éƒæ˜¯æœ€é‡è¦çš„é¢„æµ‹å› ç´ ã€‚æˆ‘ä»¬ç¡®å®šäº†ä¸»è¦ç‰¹å¾**\n\n***`è¿™ä¹Ÿæ˜¯å·®ä¸å¤šä½ ä»¬è¦å†™çš„è®ºæ–‡çš„æœºå™¨å­¦ä¹ çš„å¤§æ¦‚æµç¨‹`***\n\n-   ä½†æ˜¯å¦‚æœçœ‹æˆ‘ä»¬çš„å¤ç°è®ºæ–‡ï¼Œä»–ä»¬æ¥ä¸‹æ¥çš„æ­¥éª¤æ˜¯\n\n### Step 1: Network Analysis (ç½‘ç»œåˆ†æ)ğŸ«¥\n\n**â€œä¸ºä»€ä¹ˆâ€ï¼ˆç›®çš„ï¼‰ï¼š**\\\næœºå™¨å­¦ä¹ å‘Šè¯‰æˆ‘ä»¬ï¼Œå¼ºè¿«ç—‡ç—‡çŠ¶ã€èº¯ä½“åŒ–ç—‡çŠ¶ã€æŠ‘éƒç—‡å’Œè®¤çŸ¥æ˜¯æœ€é‡è¦çš„é¢„æµ‹å› ç´ ã€‚ä½†å®ƒå¹¶æ²¡æœ‰å‘Šè¯‰æˆ‘ä»¬å®ƒä»¬æ˜¯å¦‚ä½•ç›¸äº’å…³è”çš„ã€‚å¼ºè¿«ç—‡ç—‡çŠ¶å’Œèº¯ä½“åŒ–ç—‡çŠ¶æ˜¯å¦é«˜åº¦ç›¸å…³ï¼ŸæŠ‘éƒç—‡æ˜¯å¦æ˜¯è¿æ¥ä¸€åˆ‡çš„ä¸­å¿ƒæ¢çº½ï¼Ÿ\n\nç½‘ç»œåˆ†æå¸®åŠ©æˆ‘ä»¬å°†ç—‡çŠ¶çš„â€œç”Ÿæ€ç³»ç»Ÿâ€å¯è§†åŒ–ã€‚å®ƒå°†æ¯ä¸ªå˜é‡ï¼ˆç—‡çŠ¶ã€äººå£ç»Ÿè®¡å› ç´ ï¼‰è§†ä¸ºä¸€ä¸ªâ€œèŠ‚ç‚¹â€ï¼ˆåŸå¸‚ï¼‰ï¼Œå¹¶å°†å®ƒä»¬ä¹‹é—´çš„ç›¸å…³æ€§è§†ä¸ºä¸€æ¡â€œè¾¹â€ï¼ˆé«˜é€Ÿå…¬è·¯ï¼‰ã€‚ç›¸å…³æ€§è¶Šå¼ºï¼Œé«˜é€Ÿå…¬è·¯å°±è¶Šç²—ã€‚\n\nè®ºæ–‡ä¸­çš„å›¾3ï¼‰ï¼š\n\n-   **ç¤¾ç¾¤ï¼ˆç¾¤è½ï¼‰ï¼š** ä»–ä»¬å¯»æ‰¾çš„æ˜¯èŠ‚ç‚¹ä¹‹é—´çš„è¿æ¥æ¯”ä¸ç½‘ç»œå…¶ä»–éƒ¨åˆ†çš„è¿æ¥æ›´ç´§å¯†çš„é›†ç¾¤ã€‚åœ¨è®ºæ–‡ä¸­ï¼Œä»–ä»¬å‘ç°äº†ä¸€ä¸ªå…³é”®æ¨¡å¼ï¼š\n\n    -   **ç¤¾åŒº 1ï¼š** ä¸»è§‚å¹¸ç¦æ„Ÿï¼ˆSWBï¼‰ã€å¼ºè¿«ç—‡\n\n    -   **ç¤¾åŒº 2ï¼š** ç²¾ç¥ç—…ç—‡çŠ¶ï¼ˆé˜³æ€§ã€é˜´æ€§ï¼‰ã€è®¤çŸ¥ç¼ºé™·å’Œç¤¾ä¼šå¿ƒç†åŠŸèƒ½ (PSP) å½¢æˆäº†å¦ä¸€ä¸ªä¸åŒçš„é›†ç¾¤ã€‚\n\n    -   å¹¸ç¦æ„Ÿçš„å†…åœ¨ä½“éªŒä¸å¼ºè¿«ç—‡å’Œèº¯ä½“ç³»ç»Ÿæ›´å¯†åˆ‡ç›¸å…³\n\n-   **ä¸­å¿ƒæ€§ï¼š** è¯¥æŒ‡æ ‡ç”¨äºè¯†åˆ«ç½‘ç»œä¸­æœ€å…·â€œå½±å“åŠ›â€çš„èŠ‚ç‚¹ã€‚è®ºæ–‡æŒ‡å‡ºï¼Œ **æŠ‘éƒç—‡**çš„â€œä¸­ä»‹ä¸­å¿ƒæ€§â€æœ€é«˜ã€‚\n\n    -   **è¿™æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ** è¿™æ„å‘³ç€æŠ‘éƒç—‡æ˜¯è¿æ¥ä¸¤ä¸ªç¾¤ä½“çš„å…³é”®**æ¡¥æ¢** ã€‚è¦ä»â€œç²¾ç¥ç—…ç—‡çŠ¶â€ç¾¤ä½“èµ°å‘â€œä¸»è§‚å¹¸ç¦æ„Ÿâ€ç¾¤ä½“ï¼Œé€šå¸¸éœ€è¦ç»è¿‡â€œæŠ‘éƒç—‡â€è¿™ä¸€ç¯èŠ‚ã€‚è¿™è¡¨æ˜æŠ‘éƒç—‡èµ·ç€å…³é”®çš„ä¸­ä»‹ä½œç”¨ã€‚\n\nè¿™æ˜¯ä¸€ç§å¯è§†åŒ–å’Œæ¢ç´¢æ€§çš„å·¥å…·ã€‚å®ƒä»æˆ‘ä»¬çš„æœºå™¨å­¦ä¹ æ¨¡å‹ä¸­è·å–é‡è¦ç‰¹å¾åˆ—è¡¨ï¼Œå¹¶å°†å…¶è½¬åŒ–ä¸ºåœ°å›¾ã€‚è¿™å¼ åœ°å›¾å‘æˆ‘ä»¬å±•ç¤ºäº†å¤æ‚ç—‡çŠ¶ç½‘ç»œçš„ç»“æ„å’Œå…³é”®å› ç´ ï¼Œè¿™è®©æˆ‘ä»¬å‡è®¾æŠ‘éƒç—‡æ˜¯ä¸€ä¸ªå…³é”®çš„ä¸­ä»‹å› ç´ ã€‚\n\n### Step 2: Structural Equation Modeling (SEM) (ç»“æ„æ–¹ç¨‹æ¨¡å‹)ğŸ”\n\næ–¹å‘æˆ–å› æœå…³ç³»ã€‚å®ƒæ˜¾ç¤ºäº†ä¸¤åº§åŸå¸‚ä¹‹é—´çš„é«˜é€Ÿå…¬è·¯ï¼Œä½†æ²¡æœ‰æ˜¾ç¤ºäº¤é€šèµ°å‘\n\nçœ‹çœ‹è®ºæ–‡ä¸­çš„å›¾ 4ã€‚è¿™æ˜¯ä»–ä»¬çš„ SEM åˆ†æç»“æœã€‚å®ƒå°±åƒä¸€ä¸ªæµç¨‹å›¾ï¼Œå±•ç¤ºäº†å½±å“åŠ›çš„æµåŠ¨ã€‚\n\n-   **ç›´æ¥æ•ˆåº”ï¼ˆç›´æ¥æ•ˆåº”ï¼‰ï¼š** ä»ä¸€ä¸ªå˜é‡åˆ°å¦ä¸€ä¸ªå˜é‡çš„ç›´çº¿ç®­å¤´ã€‚\n\n    -   è®ºæ–‡å‘ç°ï¼Œ **å¼ºè¿«æ€§è¡Œä¸ºå¯¹ä¸»è§‚å¹¸ç¦æ„Ÿï¼ˆSWBï¼‰çš„ç›´æ¥è´Ÿé¢å½±å“æœ€ä¸ºå¼ºçƒˆ** ï¼ˆè§ç²—çº¢è‰²ç®­å¤´ï¼Œç³»æ•°ä¸º-0.59ï¼‰ã€‚è¿™æ˜¯è®ºæ–‡æœ€é‡è¦çš„å‘ç°ï¼šé«˜å¼ºè¿«æ€§è¡Œä¸ºä¼šç›´æ¥æ‘§æ¯æ‚£è€…çš„å¹¸ç¦æ„Ÿã€‚\n\n-   **é—´æ¥æ•ˆåº”ï¼š** è‡³å°‘ç»è¿‡ä¸€ä¸ªå…¶ä»–å˜é‡çš„è·¯å¾„ã€‚\n\n    -   è®ºæ–‡è¯å®äº†æŠ‘éƒç—‡çš„â€œæ¡¥æ¢â€ä½œç”¨ã€‚ä¾‹å¦‚ï¼Œé˜´æ€§ç—‡çŠ¶æœ‰ä¸€ä¸ªç®­å¤´æŒ‡å‘æŠ‘éƒç—‡ï¼ŒæŠ‘éƒç—‡ä¹Ÿæœ‰ä¸€ä¸ªç®­å¤´æŒ‡å‘ä¸»è§‚å¹¸ç¦æ„Ÿã€‚è¿™æ˜¯ä¸€æ¡**é—´æ¥è·¯å¾„** ã€‚è¿™æ„å‘³ç€é˜´æ€§ç—‡çŠ¶éƒ¨åˆ†åœ°é€šè¿‡å¢åŠ æŠ‘éƒæ¥æ¶åŒ–ä¸»è§‚å¹¸ç¦æ„Ÿ ã€‚\n\n    -   OCS è¿˜é€šè¿‡æŠ‘éƒç—‡å¯¹ SWB äº§ç”Ÿé—´æ¥å½±å“ ã€‚\n\nSEM æ˜¯ä¸€ç§éªŒè¯æ€§å·¥å…·ï¼Œæ˜¯åˆ†æçš„æœ€ç»ˆæ­¥éª¤ï¼Œä¹Ÿæ˜¯æœ€æœ‰åŠ›çš„ä¸€æ­¥ã€‚å®ƒè¶…è¶Šäº†â€œä»€ä¹ˆæ˜¯é‡è¦çš„â€ï¼ˆMLï¼‰å’Œâ€œå®ƒä»¬å¦‚ä½•å…³è”â€ï¼ˆç½‘ç»œåˆ†æï¼‰çš„èŒƒç•´ï¼Œä»è€Œæ£€éªŒäº†å…³äºâ€œä»€ä¹ˆå¯¼è‡´ä»€ä¹ˆâ€çš„ç‰¹å®šç†è®ºã€‚SEM ç»“æœä¸ºæœ¬æ–‡çš„ä¸»è¦ç»“è®ºæä¾›äº†æœ€æœ‰åŠ›çš„è¯æ®ï¼šç®¡ç† OCS å¯¹äºæ”¹å–„ç²¾ç¥åˆ†è£‚ç—‡æ‚£è€…çš„ä¸»è§‚å¹¸ç¦æ„Ÿè‡³å…³é‡è¦ï¼Œè¿™æ—¢æ˜¯å› ä¸ºå®ƒå¼ºå¤§çš„ç›´æ¥å½±å“ï¼Œä¹Ÿæ˜¯å› ä¸ºå®ƒé€šè¿‡æŠ‘éƒç—‡äº§ç”Ÿçš„é—´æ¥å½±å“ã€‚\n\n# æˆ‘æ»´ä»»åŠ¡å®Œæˆäº†ğŸ›«"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"jupyter"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","output-file":"index.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.8.24","manuscript":{"article":"index.qmd"},"jupyter":"python3","comments":{"hypothesis":true},"title":"SEM + ML å®é™…é¡¹ç›®è®ºæ–‡å¤ç°","authors":[{"name":"JAYZJAYZ","affiliation":"GAN NAN medical university","roles":"writing","corresponding":true}],"bibliography":["references.bib"]},"extensions":{"book":{"multiFile":true}}},"docx":{"identifier":{"display-name":"MS Word","target-format":"docx","base-format":"docx"},"execute":{"fig-width":5,"fig-height":4,"fig-format":"png","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"jupyter"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"docx","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"page-width":6.5},"pandoc":{"default-image-extension":"png","to":"docx","output-file":"index.docx"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"manuscript":{"article":"index.qmd"},"jupyter":"python3","title":"SEM + ML å®é™…é¡¹ç›®è®ºæ–‡å¤ç°","authors":[{"name":"JAYZJAYZ","affiliation":"GAN NAN medical university","roles":"writing","corresponding":true}],"bibliography":["references.bib"]},"extensions":{"book":{"selfContainedOutput":true}}},"jats":{"identifier":{"display-name":"JATS","target-format":"jats","base-format":"jats"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"png","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"jupyter"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"xml","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"variant":"+element_citations"},"pandoc":{"standalone":true,"default-image-extension":"png","to":"jats","output-file":"index.xml"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"manuscript":{"article":"index.qmd"},"jupyter":"python3","title":"SEM + ML å®é™…é¡¹ç›®è®ºæ–‡å¤ç°","authors":[{"name":"JAYZJAYZ","affiliation":"GAN NAN medical university","roles":"writing","corresponding":true}],"bibliography":["references.bib"]}}},"projectFormats":["html","docx","jats"]}